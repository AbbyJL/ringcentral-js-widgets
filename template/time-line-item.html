<div class='rc-panel rc-timeline-item' data-event='click:enter'>
    <div class='rc-timeline-item__content'>
    <div class='rc-timeline-item__line'>
        <span class='rc-timeline-item__icon' data-info='icon'></span>
        <span class='rc-timeline-item__contact' data-info='contact'></span>
    </div>
        <div class='rc-timeline-item__time' data-info='time'></div>
        <div class='rc-timeline-item__subject' data-info='subject'></div>
        <div class='rc-timeline-item__count display-none' data-info='count-wrapper'>
            <span data-info='count'></span>
            <span class='icon-uni2466' data-event='click:collapse'></span>
        </div>
    </div>
    <div data-info='collapse' class='rc-timeline-item__collapse'>
    </div>
</div>
<script>
w.register(function(){
    this.actions= {
        init: {
            after: function() {
                this.props.content = this.data
                var time = new Date(this.data.time)
                if (this.data.type === 'SMS')
                    this.props.dom.icon.classList.add('icon-uni2487')
                else if (this.data.type === 'Voice')
                    this.props.dom.icon.classList.add('icon-uniAE')
                else if (this.data.type === 'Pager')
                    this.props.dom.icon.classList.add('icon-uniCB')
                this.props.dom.subject.textContent = this.data.subject
                this.data.contact && (this.props.dom.contact.textContent = this.data.contact.displayName)
                this.props.dom.time.textContent = 
                `${time.getMonth()}/${time.getDate()}, ${time.getMinutes()}:${time.getSeconds()}`
                if (this.data.others && this.data.others.length > 0) {
                    this.props.dom['count-wrapper'].classList.remove('display-none')
                    this.props.dom.count.textContent = this.data.others.length
                    this.data.others.forEach(content => {
                        var time = new Date(content.time)
                        var div = document.createElement('div')
                        div.innerHTML = 
                        `<div class='timeline-extra .clearfix'>
                            <div class='timeline-extra__content'>${content.subject}</div>
                            <div class='rc-timeline-item__time'>
                                ${time.getMonth()}/${time.getDate()}, ${time.getMinutes()}:${time.getSeconds()}
                            </div>
                        </div>`
                        this.props.dom.collapse.appendChild(div.firstChild)
                    })
                }
            }
        },
        mount: {
            after: function() {
            }
        },
        collapse: {
            after: function(event) {
                event.stopPropagation()

                var element = this.props.dom.collapse
                if (!element.classList.contains('--active')) {
                    var prevWidth = element.style.height
                    element.style.height = 'auto'
                    var endWidth = getComputedStyle(element).height
                    element.style.height = prevWidth
                    element.offsetWidth // force repaint
                    element.style.height = endWidth
                    element.addEventListener('transitionend', function transitionEnd(event) {
                        if (event.propertyName == 'height') {
                            element.style.transition = ''
                            element.style.height = 'auto'
                            element.removeEventListener('transitionend', transitionEnd, false)
                        }
                    }, false)
                    element.classList.add('--active')
                } else {
                    element.style.height = getComputedStyle(element).height
                    element.offsetWidth // force repaint
                    element.style.height = '0px'
                    element.classList.remove('--active')
                }
            }
        },
        enter: {
            after: function() {}
        }
    }
});
//# sourceURL=time-line-item.html
</script>
