<template>
    <div class='rc-dropdown'>
        <button class='rc-dropdown__trigger rc-button'
                data-info='dropdown'>From: </button>
        <div    class='rc-dropdown__list rc-list' 
                data-info='list'>
        </div>
    </div>
</template>
<script>
w.register(function() {
    var enlarge = w.transition('enlarge')
    this.actions = {
        init: {
            after: function() {
                if (this.data.defaultValue)
                    this.switchTitle(this.data.defaultValue)
            }
        },
        mount: {
            after: function() {
                enlarge.init(this.dom['list'])
                document.addEventListener('click', e => {
                    var currentNode = e.target
                    while(currentNode.parentNode) {
                        currentNode = currentNode.parentNode
                        if (currentNode.isEqualNode(this.root))
                            return
                    }
                    this.hide()
                })
            }
        },
        collapse: {
            after: function() {
                enlarge.toggle(this.dom['list'])
            }
        },
        hide: {
            after: function() {
                enlarge.out(this.dom['list'])
            }
        },
        getData: {
            method: function(finish) {
                return finish();
            }
        },
        addItem: {
            after: function(text) {
                var item = document.createElement('div')
                // FIXME
                item.classList.add('rc-list__item', 'rc-dropdown__item')
                item.textContent = text;
                item.addEventListener('click', e => {
                    this.switchTitle(text);
                });
                this.dom['list'].appendChild(item);
            }
        },
        getSelected: {
            method: function() {
                return this.dom['dropdown'].textContent;
            }
        },
        removeItem: {},
        disable: {
            method: function() {
                this.dom.dropdown.disabled = true;
            }
        },
        switchTitle: {
            method: function(finish, text) {
                finish(text);
            },
            after: function(text) {
                this.dom['dropdown'].textContent = text;
                this.hide();
            }
        },
        click: {
            method: function(finish, event) {
                if (event.target === this.dom.dropdown)
                    this.collapse()
            }
        }
    }
})
//# sourceURL=dropdown.html
</script>
