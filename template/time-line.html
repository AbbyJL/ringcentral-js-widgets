<div class='rc-panel rc-timeline'>
    <div class='rc-panel__header --flat'>
        <div class='rc-contacts__searchBox'>
            <input 
                class='__input' 
                type='text' 
                data-info='searchText' 
                data-event='input:search|focus:focusSearchBox|blur:blurSearchBox'
            >
        </div>
    </div>
    <div class='rc-panel__content' data-info='content'>
        <div class='rc-timeline__list' data-info='timeline'>
            <time-line-item dynamic></time-line-item>
        </div>
        <div class='rc-timeline__mask display-none' data-info='mask'></div>
    </div>
</div>
<script>
w.register(function() {
    this.data = {}
    this.actions= {
        mount: {
            after: function() {
                this.fetchData()
            }
        },
        fetchData: {
            method: function(finish) {
                return finish()
            },
            after: function(contents) {
                contents.forEach(content => this.addLine(content))
            }
        },
        updateTimeline: {
            after: function(contents) {
                contents.forEach(content => this.addLine(content, true))
            }
        },
        addLine: {
            after: function(content, prepend) {
                var parent = this
                var item = w('time-line-item', {
                    data: content,
                    actions: {
                        enter: {
                            after: function() {
                                parent.props.selectedContent = this.props.content
                                parent.enterItem()
                            }
                        }
                    }
                })
                // FIXME: widget cannot prepend, it's a workaround
                // TODO: make a notification
                if (prepend) {
                    var div = document.createElement('div')
                    item.mount(div)
                    this.props.dom.timeline.insertBefore(div, this.props.dom.timeline.firstChild)
                }
                else
                    item.mount(this.props.dom.timeline)
            }
        },
        search: {
            method: function(finish) {
                return finish()
            }
        },
        focusSearchBox: {
            method: function(finish) {
                return finish()
            },
            after: function() {

            }
        },
        blurSearchBox: {
            method: function(finish) {
                return finish()
            },
            after: function() {

            }
        },
        switchContent: {
            method: function() {
            },
            after: function() {
            }
        },
        enterItem: {
            method: function() {},
            after: function() {}
        }
    }
});
//# sourceURL=time-line.html
</script>
