{"version":3,"sources":["containers/CallMonitorPage/index.js"],"names":["mapToProps","_","locale","callMonitor","regionSettings","connectivityMonitor","dateTimeFormat","callLogger","composeText","rolesAndPermissions","active","title","getString","currentLocale","calls","areaCode","countryCode","disableLinks","connectivity","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","loggingMap","showSpinner","ready","mapToFunctions","onViewContact","onCreateContact","dateTimeFormatter","formatDateTime","utcTimestamp","contactMatcher","onLogCall","isLoggedContact","router","composeTextRoute","phoneNumber","name","entityType","hasMatchNumber","ignoreCache","forceMatchNumber","undefined","call","contact","redirect","logCall","onClickToSms","history","push","addToNumber","typingToNumber","cleanTypingToNumber","CallMonitorPage"],"mappings":"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","file":"index.js","sourcesContent":["import { connect } from 'react-redux';\nimport CallsPanel from '../../components/CallsPanel';\nimport i18n from './i18n';\n\nfunction mapToProps(_, {\n  locale,\n  callMonitor,\n  regionSettings,\n  connectivityMonitor,\n  dateTimeFormat,\n  callLogger,\n  composeText,\n  rolesAndPermissions,\n}) {\n  return {\n    active: true,\n    title: i18n.getString('title', locale.currentLocale),\n    currentLocale: locale.currentLocale,\n    calls: callMonitor.calls,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    disableLinks: !connectivityMonitor.connectivity,\n    outboundSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.OutboundSMS\n    ),\n    internalSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.InternalSMS\n    ),\n    loggingMap: (callLogger && callLogger.loggingMap),\n    showSpinner: !(\n      locale.ready &&\n      callMonitor.ready &&\n      regionSettings.ready &&\n      connectivityMonitor.ready &&\n      dateTimeFormat.ready &&\n      (!callLogger || callLogger.ready) &&\n      (!rolesAndPermissions || rolesAndPermissions.ready) &&\n      (!composeText || composeText.ready)\n    ),\n  };\n}\nfunction mapToFunctions(_, {\n  dateTimeFormat,\n  onViewContact,\n  onCreateContact,\n  dateTimeFormatter = utcTimestamp => dateTimeFormat.formatDateTime({\n    utcTimestamp,\n  }),\n  callLogger,\n  contactMatcher,\n  onLogCall,\n  isLoggedContact,\n  router,\n  composeTextRoute = '/composeText',\n  composeText,\n}) {\n  return {\n    dateTimeFormatter,\n    onViewContact,\n    onCreateContact: onCreateContact ?\n      async ({ phoneNumber, name, entityType }) => {\n        const hasMatchNumber = await contactMatcher.hasMatchNumber({\n          phoneNumber,\n          ignoreCache: true\n        });\n        if (!hasMatchNumber) {\n          await onCreateContact({ phoneNumber, name, entityType });\n          await contactMatcher.forceMatchNumber({ phoneNumber });\n        }\n      } :\n      undefined,\n    isLoggedContact,\n    onLogCall: onLogCall ||\n    (callLogger && (async ({ call, contact, redirect = true }) => {\n      await callLogger.logCall({\n        call,\n        contact,\n        redirect,\n      });\n    })),\n    onClickToSms: composeText ?\n      async (contact) => {\n        if (router) {\n          router.history.push(composeTextRoute);\n        }\n        composeText.addToNumber(contact);\n        if (composeText.typingToNumber === contact.phoneNumber) {\n          composeText.cleanTypingToNumber();\n        }\n      } :\n      undefined,\n  };\n}\n\nconst CallMonitorPage = connect(mapToProps, mapToFunctions)(CallsPanel);\n\nexport default CallMonitorPage;\n"]}