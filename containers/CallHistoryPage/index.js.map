{"version":3,"sources":["containers/CallHistoryPage/index.js"],"names":["mapToProps","_","locale","callHistory","regionSettings","connectivityMonitor","dateTimeFormat","callLogger","call","composeText","rolesAndPermissions","title","getString","currentLocale","calls","areaCode","countryCode","disableLinks","connectivity","disableClickToDial","isIdle","outboundSmsPermission","permissions","OutboundSMS","internalSmsPermission","InternalSMS","loggingMap","showSpinner","ready","status","mapToFunctions","onViewContact","onCreateContact","dateTimeFormatter","formatDateTime","utcTimestamp","contactMatcher","onLogCall","isLoggedContact","router","dialerRoute","composeTextRoute","phoneNumber","name","entityType","hasMatchNumber","ignoreCache","forceMatchNumber","undefined","onClickToDial","history","push","onToNumberChange","onCall","onClickToSms","contact","addToNumber","typingToNumber","cleanTypingToNumber","redirect","logCall","CallsPage"],"mappings":"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","file":"index.js","sourcesContent":["import { connect } from 'react-redux';\nimport moduleStatuses from 'ringcentral-integration/enums/moduleStatuses';\nimport CallsPanel from '../../components/CallsPanel';\nimport i18n from './i18n';\n\nfunction mapToProps(_, {\n  locale,\n  callHistory,\n  regionSettings,\n  connectivityMonitor,\n  dateTimeFormat,\n  callLogger,\n  call,\n  composeText,\n  rolesAndPermissions,\n}) {\n  return {\n    title: i18n.getString('title', locale.currentLocale),\n    currentLocale: locale.currentLocale,\n    calls: callHistory.calls,\n    areaCode: regionSettings.areaCode,\n    countryCode: regionSettings.countryCode,\n    disableLinks: !connectivityMonitor.connectivity,\n    disableClickToDial: !(call && call.isIdle),\n    outboundSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.OutboundSMS\n    ),\n    internalSmsPermission: !!(\n      rolesAndPermissions.permissions &&\n      rolesAndPermissions.permissions.InternalSMS\n    ),\n    loggingMap: (callLogger && callLogger.loggingMap),\n    showSpinner: !(\n      callHistory.ready &&\n      locale.ready &&\n      regionSettings.ready &&\n      dateTimeFormat.ready &&\n      connectivityMonitor.ready &&\n      (!rolesAndPermissions || rolesAndPermissions.ready) &&\n      (!call || call.status === moduleStatuses.ready) &&\n      (!composeText || composeText.ready) &&\n      (!callLogger || callLogger.ready)\n    ),\n  };\n}\nfunction mapToFunctions(_, {\n  dateTimeFormat,\n  onViewContact,\n  onCreateContact,\n  dateTimeFormatter = utcTimestamp => dateTimeFormat.formatDateTime({\n    utcTimestamp,\n  }),\n  callLogger,\n  contactMatcher,\n  onLogCall,\n  isLoggedContact,\n  call,\n  composeText,\n  router,\n  dialerRoute = '/',\n  composeTextRoute = '/composeText',\n}) {\n  return {\n    dateTimeFormatter,\n    onViewContact,\n    onCreateContact: onCreateContact ?\n      async ({ phoneNumber, name, entityType }) => {\n        const hasMatchNumber = await contactMatcher.hasMatchNumber({\n          phoneNumber,\n          ignoreCache: true\n        });\n        // console.debug('confirm hasMatchNumber:', hasMatchNumber);\n        if (!hasMatchNumber) {\n          await onCreateContact({ phoneNumber, name, entityType });\n          await contactMatcher.forceMatchNumber({ phoneNumber });\n        }\n      } :\n      undefined,\n    onClickToDial: call ?\n      (phoneNumber) => {\n        if (call.isIdle) {\n          router.history.push(dialerRoute);\n          call.onToNumberChange(phoneNumber);\n          call.onCall();\n        }\n      } :\n      undefined,\n    onClickToSms: composeText ?\n      async (contact) => {\n        if (router) {\n          router.history.push(composeTextRoute);\n        }\n        composeText.addToNumber(contact);\n        if (composeText.typingToNumber === contact.phoneNumber) {\n          composeText.cleanTypingToNumber();\n        }\n      } :\n      undefined,\n    isLoggedContact,\n    onLogCall: onLogCall ||\n    (callLogger && (async ({ call, contact, redirect = true }) => {\n      await callLogger.logCall({\n        call,\n        contact,\n        redirect,\n      });\n    })),\n  };\n}\n\nconst CallsPage = connect(mapToProps, mapToFunctions)(CallsPanel);\n\nexport default CallsPage;\n"]}