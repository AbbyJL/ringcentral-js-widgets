{"version":3,"sources":["components/AnimationAlert/index.js"],"names":["ANIMATION_DURATION","ENTRANCE_ANIMATION","EXIT_ANIMATION","AnimationMessage","animation","duration","props","second","animationDuration","propTypes","string","number","AnimationAlert","state","messages","nextProps","entranceAnimation","exitAnimation","currentMessagesIDs","map","message","id","nextMessagesIDs","addedMessagesIDs","filter","includes","removedMessagesIDs","allMessagesIDs","concat","allMessages","isAddedMessage","isRemovedMessage","stateWithAnimation","setState","isCurrentEmpty","length","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;;;AAEA;;;;AACA;;;;;;AAEA,IAAMA,qBAAqB,GAA3B;AACA,IAAMC,qBAAqB,YAA3B;AACA,IAAMC,iBAAiB,WAAvB;;AAEA,SAASC,gBAAT,OAAkF;AAAA,MAAtDC,SAAsD,QAAtDA,SAAsD;AAAA,2BAA3CC,QAA2C;AAAA,MAA3CA,QAA2C,iCAAhCL,kBAAgC;AAAA,MAATM,KAAS;;AAChF,MAAMC,SAASF,WAAW,IAA1B;AACA,SACE;AAAA;AAAA;AACE,iBAAcD,SAAd,cADF;AAEE,aAAO;AACLI,2BAAsBD,MAAtB;AADK,OAFT;AAKE,qDAAaD,KAAb;AALF,GADF;AASD;;AAEDH,iBAAiBM,SAAjB,8BACK,kBAAQA,SADb;AAEEL,aAAW,oBAAUM,MAFvB;AAGEL,YAAU,oBAAUM;AAHtB;;IAMMC,c;;;AACJ,0BAAYN,KAAZ,EAAmB;AAAA;;AAAA,sJACXA,KADW;;AAEjB,UAAKO,KAAL,GAAa;AACXC,gBAAU,MAAKR,KAAL,CAAWQ;AADV,KAAb;AAFiB;AAKlB;;;;8CACyBC,S,EAAW;AAAA;;AACnC,iEAAC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,yBAKK,OAAKT,KALV,2BAEGD,QAFH,EAEGA,QAFH,mCAEcL,kBAFd,mDAGGgB,iBAHH,EAGGA,iBAHH,yCAGuBf,kBAHvB,wDAIGgB,aAJH,EAIGA,aAJH,wCAImBf,cAJnB;AAMOgB,kCANP,GAM4B,OAAKZ,KAAL,CAAWQ,QAAX,CAAoBK,GAApB,CAAwB;AAAA,yBAAWC,QAAQC,EAAnB;AAAA,iBAAxB,CAN5B;AAOOC,+BAPP,GAOyBP,UAAUD,QAAV,CAAmBK,GAAnB,CAAuB;AAAA,yBAAWC,QAAQC,EAAnB;AAAA,iBAAvB,CAPzB;AAQOE,gCARP,GAQ0BD,gBAAgBE,MAAhB,CAAuB;AAAA,yBAAM,CAACN,mBAAmBO,QAAnB,CAA4BJ,EAA5B,CAAP;AAAA,iBAAvB,CAR1B;AASOK,kCATP,GAS4BR,mBAAmBM,MAAnB,CAA0B;AAAA,yBAAM,CAACF,gBAAgBG,QAAhB,CAAyBJ,EAAzB,CAAP;AAAA,iBAA1B,CAT5B;AAUOM,8BAVP,8CAU4B,kBAAQT,mBAAmBU,MAAnB,CAA0BN,eAA1B,CAAR,CAV5B;AAWOO,2BAXP,GAWqB,EAXrB;;AAYC,uBAAKvB,KAAL,CAAWQ,QAAX,CAAoBc,MAApB,CAA2Bb,UAAUD,QAArC,EAA+CK,GAA/C,CAAmD,UAACC,OAAD,EAAa;AAC9DS,8BAAYT,QAAQC,EAApB,IAA0BD,OAA1B;AACA,yBAAOA,OAAP;AACD,iBAHD;AAIMN,wBAhBP,GAgBkBa,eACdR,GADc,CACV,UAACE,EAAD,EAAQ;AACX,sBAAMD,UAAUS,YAAYR,EAAZ,CAAhB;AACA,sBAAMS,iBAAiBP,iBAAiBE,QAAjB,CAA0BJ,EAA1B,CAAvB;AACA,sBAAMU,mBAAmBL,mBAAmBD,QAAnB,CAA4BJ,EAA5B,CAAzB;AACA,sBAAIjB,kBAAJ;AACA,sBAAI0B,cAAJ,EAAoB;AAClB1B,gCAAYY,iBAAZ;AACD,mBAFD,MAEO,IAAIe,gBAAJ,EAAsB;AAC3B3B,gCAAYa,aAAZ;AACD;AACD,oDACKG,OADL,EAEKhB,YAAY,EAAEA,oBAAF,EAAZ,GAA4B,EAFjC;AAGEC;AAHF;AAKD,iBAhBc,CAhBlB;AAiCO2B,kCAjCP,GAiC4B;AACzBlB;AADyB,iBAjC5B;;AAoCC,uBAAKmB,QAAL,CAAcD,kBAAd;AApCD;AAAA,uBAqCO,qBAAM3B,QAAN,CArCP;;AAAA;AAsCO6B,8BAtCP,GAsCwBhB,mBAAmBiB,MAAnB,KAA8B,CAtCtD;;AAuCC,uBAAKF,QAAL,CAAc;AACZnB,4BAAUoB,iBAAiBpB,QAAjB,GAA4BC,UAAUD;AADpC,iBAAd;;AAvCD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAD;AA2CD;;;6BACQ;AACP,aACE,iFAAkB,KAAKR,KAAvB,IAA8B,WAAWH,gBAAzC,EAA2D,UAAU,KAAKU,KAAL,CAAWC,QAAhF,IADF;AAGD;;;;;AAGHF,eAAeH,SAAf,8BACK,uBAAaA,SADlB;AAEEO,qBAAmB,oBAAUN,MAF/B;AAGEO,iBAAe,oBAAUP,MAH3B;AAIEL,YAAU,oBAAUM;AAJtB;;AAOAC,eAAewB,YAAf,8BACK,uBAAaA,YADlB;;kBAIexB,c","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport 'animate.css/animate.min.css';\nimport sleep from 'ringcentral-integration/lib/sleep';\n\nimport Message from '../Message';\nimport AlertDisplay from '../AlertDisplay';\n\nconst ANIMATION_DURATION = 500;\nconst ENTRANCE_ANIMATION = 'fadeInDown';\nconst EXIT_ANIMATION = 'fadeOutUp';\n\nfunction AnimationMessage({ animation, duration = ANIMATION_DURATION, ...props }) {\n  const second = duration / 1000;\n  return (\n    <div\n      className={`${animation} animated`}\n      style={{\n        animationDuration: `${second}s`\n      }}>\n      <Message {...props} />\n    </div>\n  );\n}\n\nAnimationMessage.propTypes = {\n  ...Message.propTypes,\n  animation: PropTypes.string,\n  duration: PropTypes.number,\n};\n\nclass AnimationAlert extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      messages: this.props.messages,\n    };\n  }\n  componentWillReceiveProps(nextProps) {\n    (async () => {\n      const {\n        duration = ANIMATION_DURATION,\n        entranceAnimation = ENTRANCE_ANIMATION,\n        exitAnimation = EXIT_ANIMATION,\n      } = this.props;\n      const currentMessagesIDs = this.props.messages.map(message => message.id);\n      const nextMessagesIDs = nextProps.messages.map(message => message.id);\n      const addedMessagesIDs = nextMessagesIDs.filter(id => !currentMessagesIDs.includes(id));\n      const removedMessagesIDs = currentMessagesIDs.filter(id => !nextMessagesIDs.includes(id));\n      const allMessagesIDs = [...new Set(currentMessagesIDs.concat(nextMessagesIDs))];\n      const allMessages = {};\n      this.props.messages.concat(nextProps.messages).map((message) => {\n        allMessages[message.id] = message;\n        return message;\n      });\n      const messages = allMessagesIDs\n        .map((id) => {\n          const message = allMessages[id];\n          const isAddedMessage = addedMessagesIDs.includes(id);\n          const isRemovedMessage = removedMessagesIDs.includes(id);\n          let animation;\n          if (isAddedMessage) {\n            animation = entranceAnimation;\n          } else if (isRemovedMessage) {\n            animation = exitAnimation;\n          }\n          return {\n            ...message,\n            ...animation ? { animation } : {},\n            duration,\n          };\n        });\n      const stateWithAnimation = {\n        messages,\n      };\n      this.setState(stateWithAnimation);\n      await sleep(duration);\n      const isCurrentEmpty = currentMessagesIDs.length === 0;\n      this.setState({\n        messages: isCurrentEmpty ? messages : nextProps.messages,\n      });\n    })();\n  }\n  render() {\n    return (\n      <AlertDisplay {...this.props} component={AnimationMessage} messages={this.state.messages} />\n    );\n  }\n}\n\nAnimationAlert.propTypes = {\n  ...AlertDisplay.propTypes,\n  entranceAnimation: PropTypes.string,\n  exitAnimation: PropTypes.string,\n  duration: PropTypes.number,\n};\n\nAnimationAlert.defaultProps = {\n  ...AlertDisplay.defaultProps\n};\n\nexport default AnimationAlert;\n"]}