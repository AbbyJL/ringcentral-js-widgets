{"version":3,"sources":["components/AnimationAlert/index.js"],"names":["ANIMATION_DURATION","ENTRANCE_ANIMATION","EXIT_ANIMATION","AnimationMessage","animation","duration","props","second","animationDuration","propTypes","Message","PropTypes","string","number","defaultProps","undefined","AnimationAlert","state","messages","mounted","nextProps","entranceAnimation","exitAnimation","currentMessagesIDs","map","message","id","nextMessagesIDs","addedMessagesIDs","filter","includes","removedMessagesIDs","allMessagesIDs","concat","allMessages","isAddedMessage","isRemovedMessage","stateWithAnimation","setState","isCurrentEmpty","length","Component","AlertDisplay"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport 'animate.css/animate.min.css';\nimport sleep from 'ringcentral-integration/lib/sleep';\n\nimport Message from '../Message';\nimport AlertDisplay from '../AlertDisplay';\n\nconst ANIMATION_DURATION = 500;\nconst ENTRANCE_ANIMATION = 'fadeInDown';\nconst EXIT_ANIMATION = 'fadeOutUp';\n\nfunction AnimationMessage({ animation, duration, ...props }) {\n  const second = duration / 1000;\n  return (\n    <div\n      className={classnames([animation, 'animated'])}\n      style={{\n        animationDuration: `${second}s`\n      }}>\n      <Message {...props} />\n    </div>\n  );\n}\n\nAnimationMessage.propTypes = {\n  ...Message.propTypes,\n  animation: PropTypes.string,\n  duration: PropTypes.number,\n};\nAnimationMessage.defaultProps = {\n  animation: undefined,\n  duration: ANIMATION_DURATION,\n};\n\nclass AnimationAlert extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      messages: this.props.messages,\n    };\n  }\n  componentDidMount() {\n    this.mounted = true;\n  }\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n  componentWillReceiveProps(nextProps) {\n    (async () => {\n      const {\n        duration,\n        entranceAnimation,\n        exitAnimation,\n      } = this.props;\n      const currentMessagesIDs = this.props.messages.map(message => message.id);\n      const nextMessagesIDs = nextProps.messages.map(message => message.id);\n      const addedMessagesIDs = nextMessagesIDs.filter(id => !currentMessagesIDs.includes(id));\n      const removedMessagesIDs = currentMessagesIDs.filter(id => !nextMessagesIDs.includes(id));\n      const allMessagesIDs = [...new Set(currentMessagesIDs.concat(nextMessagesIDs))];\n      const allMessages = {};\n      this.props.messages.concat(nextProps.messages).map((message) => {\n        allMessages[message.id] = message;\n        return message;\n      });\n      const messages = allMessagesIDs\n        .map((id) => {\n          const message = allMessages[id];\n          const isAddedMessage = addedMessagesIDs.includes(id);\n          const isRemovedMessage = removedMessagesIDs.includes(id);\n          let animation;\n          if (isAddedMessage) {\n            animation = entranceAnimation;\n          } else if (isRemovedMessage) {\n            animation = exitAnimation;\n          }\n          return {\n            ...message,\n            ...animation ? { animation } : {},\n            duration,\n          };\n        });\n      const stateWithAnimation = {\n        messages,\n      };\n      this.setState(stateWithAnimation);\n      await sleep(duration);\n\n      if (!this.mounted) return;\n\n      const isCurrentEmpty = currentMessagesIDs.length === 0;\n      this.setState({\n        messages: isCurrentEmpty ? messages : nextProps.messages,\n      });\n    })();\n  }\n  render() {\n    return (\n      <AlertDisplay {...this.props} component={AnimationMessage} messages={this.state.messages} />\n    );\n  }\n}\n\nAnimationAlert.propTypes = {\n  ...AlertDisplay.propTypes,\n  entranceAnimation: PropTypes.string,\n  exitAnimation: PropTypes.string,\n  duration: PropTypes.number,\n};\n\nAnimationAlert.defaultProps = {\n  ...AlertDisplay.defaultProps,\n  entranceAnimation: ENTRANCE_ANIMATION,\n  exitAnimation: EXIT_ANIMATION,\n  duration: ANIMATION_DURATION,\n};\n\nexport default AnimationAlert;\n"]}