{"version":3,"sources":["components/MessageItem/index.js"],"names":["ConversationIcon","group","conversationTitle","groupConversationTitle","title","conversationIcon","groupConversation","composeText","propTypes","bool","string","defaultProps","undefined","MessageItem","props","onSelectContact","value","idx","selected","showContactDisplayPlaceholder","parseInt","_userSelection","setState","conversation","conversationMatches","length","autoLog","logConversation","redirect","prefill","getSelectedContact","state","contactMatches","correspondentMatches","viewSelectedContact","onViewContact","contact","createSelectedContact","bind","clickToDial","onClickToDial","getPhoneNumber","showConversationDetail","e","contactDisplay","contains","target","conversationId","getInitialContactIndex","isLogging","isCreating","_mounted","nextProps","lastMatchedCorrespondentEntity","index","findIndex","id","correspondents","phoneNumber","extensionNumber","groupNumbers","map","correspondent","name","entityType","onCreateContact","enableContactFallback","getFallbackContactName","onLogConversation","correspondentEntity","areaCode","brand","countryCode","currentLocale","unreadCounts","creationTime","subject","disableLinks","disableClickToDial","dateTimeFormatter","sourceIcons","getGroupPhoneNumbers","fallbackName","root","wrapper","unread","getString","ref","dropdownSelect","details","utcTimestamp","extendIcon","shape","isRequired","arrayOf","func","object"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport ContactDisplay from '../ContactDisplay';\nimport ActionMenu from '../ActionMenu';\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nfunction ConversationIcon({\n  group,\n  conversationTitle,\n  groupConversationTitle,\n}) {\n  const title = group ? groupConversationTitle : conversationTitle;\n  return (\n    <div className={styles.conversationIcon}>\n      <span\n        className={classnames(\n          group ? dynamicsFont.groupConversation : dynamicsFont.composeText\n        )}\n        title={title}\n      />\n    </div>\n  );\n}\nConversationIcon.propTypes = {\n  group: PropTypes.bool,\n  conversationTitle: PropTypes.string,\n  groupConversationTitle: PropTypes.string,\n};\nConversationIcon.defaultProps = {\n  group: false,\n  conversationTitle: undefined,\n  groupConversationTitle: undefined,\n};\n\nexport default class MessageItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      isLogging: false,\n      isCreating: false,\n    };\n    this._userSelection = false;\n    /* [RCINT-4301] onSelection would trigger some state changes that would push new\n     * properties before the state has been changed. Which would reset the selected value.\n     */\n  }\n  componentDidMount() {\n    this._mounted = true;\n  }\n  componentWillReceiveProps(nextProps) {\n    if (\n      !this._userSelection &&\n      (\n        nextProps.conversation.conversationMatches !==\n        this.props.conversation.conversationMatches ||\n        nextProps.conversation.correspondentMatches !==\n        this.props.conversation.correspondentMatches\n      )\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n  }\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n  onSelectContact = (value, idx) => {\n    const selected = this.props.showContactDisplayPlaceholder\n      ? parseInt(idx, 10) - 1 : parseInt(idx, 10);\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (\n      this.props.conversation.conversationMatches.length > 0 &&\n      this.props.autoLog\n    ) {\n      this.logConversation({ redirect: false, selected, prefill: false });\n    }\n  }\n  getInitialContactIndex(nextProps = this.props) {\n    const {\n      correspondentMatches,\n      lastMatchedCorrespondentEntity,\n    } = nextProps.conversation;\n    if (lastMatchedCorrespondentEntity) {\n      const index = correspondentMatches.findIndex(contact => (\n        contact.id === lastMatchedCorrespondentEntity.id\n      ));\n      if (index > -1) return index;\n    }\n    return this.props.showContactDisplayPlaceholder ? -1 : 0;\n  }\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.props.conversation.correspondentMatches;\n    return (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null;\n  }\n\n  getPhoneNumber() {\n    const correspondents = this.props.conversation.correspondents;\n    return (correspondents.length === 1 &&\n      (correspondents[0].phoneNumber || correspondents[0].extensionNumber)) || undefined;\n  }\n  getGroupPhoneNumbers() {\n    const correspondents = this.props.conversation.correspondents;\n    const groupNumbers = correspondents.length > 1 ?\n      correspondents.map(correspondent =>\n        correspondent.extensionNumber || correspondent.phoneNumber || undefined\n      )\n      : null;\n    return groupNumbers;\n  }\n  getFallbackContactName() {\n    const correspondents = this.props.conversation.correspondents;\n    return (correspondents.length === 1 &&\n      (correspondents[0].name)) || undefined;\n  }\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        contact: this.getSelectedContact(),\n      });\n    }\n  }\n  async createSelectedContact(entityType) {\n    // console.log('click createSelectedContact!!', entityType);\n    if (typeof this.props.onCreateContact === 'function' &&\n      this._mounted &&\n      !this.state.isCreating) {\n      this.setState({\n        isCreating: true,\n      });\n      // console.log('start to create: isCreating...', this.state.isCreating);\n      const phoneNumber = this.getPhoneNumber();\n      await this.props.onCreateContact({\n        phoneNumber,\n        name: this.props.enableContactFallback ? this.getFallbackContactName() : '',\n        entityType,\n      });\n\n      if (this._mounted) {\n        this.setState({\n          isCreating: false,\n        });\n        // console.log('created: isCreating...', this.state.isCreating);\n      }\n    }\n  }\n  createSelectedContact = this.createSelectedContact.bind(this);\n\n  async logConversation({ redirect = true, selected, prefill = true }) {\n    if (typeof this.props.onLogConversation === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogConversation({\n        correspondentEntity: this.getSelectedContact(selected),\n        conversationId: this.props.conversation.conversationId,\n        redirect,\n        prefill,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n  logConversation = this.logConversation.bind(this)\n\n  clickToDial = () => {\n    if (this.props.onClickToDial) {\n      this.props.onClickToDial(this.getPhoneNumber());\n    }\n  }\n  showConversationDetail = (e) => {\n    if ((\n      this.contactDisplay &&\n      this.contactDisplay.contains(e.target))\n    ) {\n      return;\n    }\n    this.props.showConversationDetail(this.props.conversation.conversationId);\n  }\n\n  render() {\n    const {\n      areaCode,\n      brand,\n      countryCode,\n      currentLocale,\n      conversation: {\n        unreadCounts,\n        correspondents,\n        correspondentMatches,\n        creationTime,\n        subject,\n        isLogging,\n        conversationMatches,\n      },\n      disableLinks,\n      disableClickToDial,\n      onClickToDial,\n      onLogConversation,\n      onViewContact,\n      onCreateContact,\n      dateTimeFormatter,\n      enableContactFallback,\n      showContactDisplayPlaceholder,\n      sourceIcons,\n    } = this.props;\n\n    const groupNumbers = this.getGroupPhoneNumbers();\n    const phoneNumber = this.getPhoneNumber();\n    const fallbackName = this.getFallbackContactName();\n\n    return (\n      <div className={styles.root} onClick={this.showConversationDetail}>\n        <div\n          className={classnames(\n            styles.wrapper,\n            unreadCounts && styles.unread\n          )}\n        >\n          <ConversationIcon\n            group={correspondents.length > 1}\n            conversationTitle={i18n.getString('conversation', currentLocale)}\n            groupConversationTitle={i18n.getString('groupConversation', currentLocale)}\n          />\n          <ContactDisplay\n            reference={(ref) => { this.contactDisplay = ref; }}\n            className={classnames(\n              styles.contactDisplay,\n              unreadCounts && styles.unread\n            )}\n            selectClassName={styles.dropdownSelect}\n            brand={brand}\n            contactMatches={correspondentMatches}\n            selected={this.state.selected}\n            onSelectContact={this.onSelectContact}\n            disabled={disableLinks}\n            isLogging={isLogging || this.state.isLogging}\n            fallBackName={fallbackName}\n            areaCode={areaCode}\n            countryCode={countryCode}\n            phoneNumber={phoneNumber}\n            groupNumbers={groupNumbers}\n            currentLocale={currentLocale}\n            enableContactFallback={enableContactFallback}\n            stopPropagation={false}\n            showType={false}\n            showPlaceholder={showContactDisplayPlaceholder}\n            sourceIcons={sourceIcons}\n          />\n          <div className={styles.details}>\n            {dateTimeFormatter({ utcTimestamp: creationTime })} | {subject}\n          </div>\n        </div>\n        <ActionMenu\n          extendIconClassName={styles.extendIcon}\n          currentLocale={currentLocale}\n          onLog={onLogConversation && this.logConversation}\n          onViewEntity={onViewContact && this.viewSelectedContact}\n          onCreateEntity={onCreateContact && this.createSelectedContact}\n          hasEntity={correspondents.length === 1 && !!correspondentMatches.length}\n          onClickToDial={onClickToDial && this.clickToDial}\n          phoneNumber={phoneNumber}\n          disableLinks={disableLinks}\n          disableClickToDial={disableClickToDial}\n          isLogging={isLogging || this.state.isLogging}\n          isLogged={conversationMatches.length > 0}\n          isCreating={this.state.isCreating}\n          addLogTitle={i18n.getString('addLog', currentLocale)}\n          editLogTitle={i18n.getString('editLog', currentLocale)}\n          callTitle={i18n.getString('call', currentLocale)}\n          createEntityTitle={i18n.getString('addEntity', currentLocale)}\n          viewEntityTitle={i18n.getString('viewDetails', currentLocale)}\n          stopPropagation={false}\n        />\n      </div>\n    );\n  }\n}\n\nMessageItem.propTypes = {\n  conversation: PropTypes.shape({\n    conversationId: PropTypes.string.isRequired,\n    isLogging: PropTypes.bool,\n    correspondents: PropTypes.arrayOf(PropTypes.shape({\n      name: PropTypes.string,\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n    })),\n    correspondentMatches: PropTypes.arrayOf(PropTypes.shape({\n      name: PropTypes.string,\n      entityType: PropTypes.string,\n    })),\n    conversationMatches: PropTypes.arrayOf(PropTypes.shape({\n      id: PropTypes.string,\n    })),\n  }).isRequired,\n  areaCode: PropTypes.string.isRequired,\n  brand: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onLogConversation: PropTypes.func,\n  onViewContact: PropTypes.func,\n  onCreateContact: PropTypes.func,\n  onClickToDial: PropTypes.func,\n  disableLinks: PropTypes.bool,\n  disableClickToDial: PropTypes.bool,\n  dateTimeFormatter: PropTypes.func.isRequired,\n  showConversationDetail: PropTypes.func.isRequired,\n  autoLog: PropTypes.bool,\n  enableContactFallback: PropTypes.bool,\n  showContactDisplayPlaceholder: PropTypes.bool,\n  sourceIcons: PropTypes.object,\n};\n\nMessageItem.defaultProps = {\n  onLogConversation: undefined,\n  onClickToDial: undefined,\n  onViewContact: undefined,\n  onCreateContact: undefined,\n  disableClickToDial: false,\n  disableLinks: false,\n  autoLog: false,\n  enableContactFallback: undefined,\n  showContactDisplayPlaceholder: true,\n  sourceIcons: undefined,\n};\n"]}