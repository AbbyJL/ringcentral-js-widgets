{"version":3,"sources":["components/MessageItem/index.js"],"names":["ConversationIcon","group","type","currentLocale","title","icon","voiceMail","getString","groupConversation","conversation","conversationIcon","propTypes","bool","string","defaultProps","undefined","MessageItem","props","preventEventPropogation","e","target","currentTarget","stopPropagation","onSelectContact","value","idx","selected","showContactDisplayPlaceholder","parseInt","_userSelection","setState","conversationMatches","length","autoLog","logConversation","redirect","prefill","getSelectedContact","state","contactMatches","correspondentMatches","viewSelectedContact","onViewContact","contact","createSelectedContact","bind","clickToDial","onClickToDial","phoneNumber","getPhoneNumber","onClickToSms","onClickItem","contactDisplay","contains","showConversationDetail","conversationId","toggleExtended","onPlayVoicemail","unreadCounts","readVoicemail","onMarkVoicemail","markVoicemail","onDeleteMessage","deleteMessage","getInitialContactIndex","isLogging","isCreating","extended","preState","_mounted","nextProps","lastMatchedCorrespondentEntity","index","findIndex","id","correspondents","extensionNumber","groupNumbers","map","correspondent","name","entityType","onCreateContact","enableContactFallback","getFallbackContactName","onLogConversation","correspondentEntity","subject","voicemailAttachment","duration","areaCode","brand","countryCode","creationTime","disableLinks","disableClickToDial","dateTimeFormatter","sourceIcons","showGroupNumberName","getGroupPhoneNumbers","fallbackName","detail","getDetail","player","slideMenuHeight","isVoicemail","uri","root","wrapper","unread","ref","dropdownSelect","details","utcTimestamp","extendIcon","slideMenu","playContainer","actionMenuList","shape","isRequired","arrayOf","number","func","object"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport messageTypes from 'ringcentral-integration/enums/messageTypes';\nimport {\n  messageIsTextMessage,\n} from 'ringcentral-integration/lib/messageHelper';\n\nimport formatDuration from '../../lib/formatDuration';\n\nimport ContactDisplay from '../ContactDisplay';\nimport ActionMenuList from '../ActionMenuList';\nimport VoicemailPlayer from '../VoicemailPlayer';\nimport SlideMenu from '../SlideMenu';\n\nimport VoicemailIcon from '../../assets/images/VoicemailIcon.svg';\nimport ComposeTextIcon from '../../assets/images/ComposeText.svg';\nimport GroupConversationIcon from '../../assets/images/GroupConversation.svg';\n\nimport styles from './styles.scss';\nimport i18n from './i18n';\n\nfunction ConversationIcon({\n  group,\n  type,\n  currentLocale,\n}) {\n  let title;\n  let icon;\n  switch (type) {\n    case messageTypes.voiceMail:\n      title = i18n.getString(messageTypes.voiceMail, currentLocale);\n      icon = <VoicemailIcon width={23} className={styles.icon} />;\n      break;\n    default:\n      title = group ?\n        i18n.getString(messageTypes.groupConversation, currentLocale) :\n        i18n.getString(messageTypes.conversation, currentLocale);\n      icon = group ?\n        <GroupConversationIcon width={19} className={styles.icon} /> :\n        <ComposeTextIcon width={18} className={styles.icon} />;\n  }\n  return (\n    <div className={styles.conversationIcon}>\n      <span title={title}>\n        {icon}\n      </span>\n    </div>\n  );\n}\nConversationIcon.propTypes = {\n  group: PropTypes.bool,\n  type: PropTypes.string,\n  currentLocale: PropTypes.string,\n};\nConversationIcon.defaultProps = {\n  group: false,\n  type: undefined,\n  currentLocale: undefined,\n};\n\nexport default class MessageItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      isLogging: false,\n      isCreating: false,\n      extended: false,\n    };\n\n    this.toggleExtended = () => {\n      this.setState(preState => ({\n        extended: !preState.extended,\n      }));\n    };\n    this._userSelection = false;\n    /* [RCINT-4301] onSelection would trigger some state changes that would push new\n     * properties before the state has been changed. Which would reset the selected value.\n     */\n  }\n  componentDidMount() {\n    this._mounted = true;\n  }\n  componentWillReceiveProps(nextProps) {\n    if (\n      !this._userSelection &&\n      (\n        nextProps.conversation.conversationMatches !==\n        this.props.conversation.conversationMatches ||\n        nextProps.conversation.correspondentMatches !==\n        this.props.conversation.correspondentMatches\n      )\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n  }\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n\n  preventEventPropogation = (e) => {\n    if (e.target !== e.currentTarget) {\n      e.stopPropagation();\n    }\n  }\n\n  onSelectContact = (value, idx) => {\n    const selected = this.props.showContactDisplayPlaceholder\n      ? parseInt(idx, 10) - 1 : parseInt(idx, 10);\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (\n      this.props.conversation.conversationMatches.length > 0 &&\n      this.props.autoLog\n    ) {\n      this.logConversation({ redirect: false, selected, prefill: false });\n    }\n  }\n  getInitialContactIndex(nextProps = this.props) {\n    const {\n      correspondentMatches,\n      lastMatchedCorrespondentEntity,\n    } = nextProps.conversation;\n    if (lastMatchedCorrespondentEntity) {\n      const index = correspondentMatches.findIndex(contact => (\n        contact.id === lastMatchedCorrespondentEntity.id\n      ));\n      if (index > -1) return index;\n    }\n    return this.props.showContactDisplayPlaceholder ? -1 : 0;\n  }\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.props.conversation.correspondentMatches;\n    return (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null;\n  }\n\n  getPhoneNumber() {\n    const { correspondents } = this.props.conversation;\n    return (correspondents.length === 1 &&\n      (correspondents[0].phoneNumber || correspondents[0].extensionNumber)) || undefined;\n  }\n  getGroupPhoneNumbers() {\n    const { correspondents } = this.props.conversation;\n    const groupNumbers = correspondents.length > 1 ?\n      correspondents.map(correspondent =>\n        correspondent.extensionNumber || correspondent.phoneNumber || undefined\n      )\n      : null;\n    return groupNumbers;\n  }\n  getFallbackContactName() {\n    const { correspondents } = this.props.conversation;\n    return (correspondents.length === 1 &&\n      (correspondents[0].name)) || undefined;\n  }\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        contact: this.getSelectedContact(),\n      });\n    }\n  }\n  async createSelectedContact(entityType) {\n    // console.log('click createSelectedContact!!', entityType);\n    if (typeof this.props.onCreateContact === 'function' &&\n      this._mounted &&\n      !this.state.isCreating) {\n      this.setState({\n        isCreating: true,\n      });\n      // console.log('start to create: isCreating...', this.state.isCreating);\n      const phoneNumber = this.getPhoneNumber();\n      await this.props.onCreateContact({\n        phoneNumber,\n        name: this.props.enableContactFallback ? this.getFallbackContactName() : '',\n        entityType,\n      });\n\n      if (this._mounted) {\n        this.setState({\n          isCreating: false,\n        });\n        // console.log('created: isCreating...', this.state.isCreating);\n      }\n    }\n  }\n  createSelectedContact = this.createSelectedContact.bind(this);\n\n  async logConversation({ redirect = true, selected, prefill = true }) {\n    if (typeof this.props.onLogConversation === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogConversation({\n        correspondentEntity: this.getSelectedContact(selected),\n        conversationId: this.props.conversation.conversationId,\n        redirect,\n        prefill,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n  logConversation = this.logConversation.bind(this)\n\n  clickToDial = () => {\n    if (this.props.onClickToDial) {\n      const contact = this.getSelectedContact() || {};\n      const phoneNumber = this.getPhoneNumber();\n\n      if (phoneNumber) {\n        this.props.onClickToDial({\n          ...contact,\n          phoneNumber,\n        });\n      }\n    }\n  }\n  onClickToSms = () => {\n    if (this.props.onClickToSms) {\n      const contact = this.getSelectedContact() || {};\n      const phoneNumber = this.getPhoneNumber();\n\n      if (phoneNumber) {\n        this.props.onClickToSms({\n          ...contact,\n          phoneNumber,\n        });\n      }\n    }\n  }\n  onClickItem = (e) => {\n    if ((\n      this.contactDisplay &&\n      this.contactDisplay.contains(e.target))\n    ) {\n      return;\n    }\n    if (messageIsTextMessage(this.props.conversation)) {\n      this.props.showConversationDetail(this.props.conversation.conversationId);\n      return;\n    }\n\n    this.toggleExtended();\n  }\n\n  onPlayVoicemail = () => {\n    if (\n      this.props.conversation.unreadCounts > 0\n    ) {\n      this.props.readVoicemail(this.props.conversation.conversationId);\n    }\n  }\n\n  onMarkVoicemail = () => {\n    if (\n      this.props.conversation.unreadCounts === 0\n    ) {\n      this.props.markVoicemail(this.props.conversation.conversationId);\n    }\n  }\n\n  getDetail() {\n    const {\n      conversation,\n      currentLocale,\n    } = this.props;\n    if (messageIsTextMessage(conversation)) {\n      return conversation.subject;\n    }\n    if (conversation.voicemailAttachment) {\n      const { duration } = conversation.voicemailAttachment;\n      return `${i18n.getString('voiceMessage', currentLocale)} (${formatDuration(duration)})`;\n    }\n    return '';\n  }\n\n  onDeleteMessage = () => {\n    this.props.deleteMessage(this.props.conversation.conversationId);\n  }\n\n  render() {\n    const {\n      areaCode,\n      brand,\n      countryCode,\n      currentLocale,\n      conversation: {\n        unreadCounts,\n        correspondents,\n        correspondentMatches,\n        creationTime,\n        isLogging,\n        conversationMatches,\n        type,\n        voicemailAttachment,\n      },\n      disableLinks,\n      disableClickToDial,\n      onClickToDial,\n      onClickToSms,\n      onLogConversation,\n      onViewContact,\n      onCreateContact,\n      dateTimeFormatter,\n      enableContactFallback,\n      showContactDisplayPlaceholder,\n      sourceIcons,\n      showGroupNumberName,\n    } = this.props;\n\n    const groupNumbers = this.getGroupPhoneNumbers();\n    const phoneNumber = this.getPhoneNumber();\n    const fallbackName = this.getFallbackContactName();\n    const detail = this.getDetail();\n    let player;\n    let slideMenuHeight = 60;\n    const isVoicemail = !!voicemailAttachment;\n    if (isVoicemail) {\n      player = (\n        <VoicemailPlayer\n          className={styles.player}\n          uri={voicemailAttachment.uri}\n          duration={voicemailAttachment.duration}\n          onPlay={this.onPlayVoicemail}\n          disabled={disableLinks}\n          currentLocale={currentLocale}\n        />\n      );\n      slideMenuHeight = 88;\n    }\n\n    return (\n      <div className={styles.root} onClick={this.onClickItem}>\n        <div\n          className={classnames(\n            styles.wrapper,\n            unreadCounts && styles.unread\n          )}\n        >\n          <ConversationIcon\n            group={correspondents.length > 1}\n            type={type}\n            currentLocale={currentLocale}\n          />\n          <ContactDisplay\n            reference={(ref) => { this.contactDisplay = ref; }}\n            className={classnames(\n              styles.contactDisplay,\n              unreadCounts && styles.unread\n            )}\n            selectClassName={styles.dropdownSelect}\n            brand={brand}\n            contactMatches={correspondentMatches}\n            selected={this.state.selected}\n            onSelectContact={this.onSelectContact}\n            disabled={disableLinks}\n            isLogging={isLogging || this.state.isLogging}\n            fallBackName={fallbackName}\n            areaCode={areaCode}\n            countryCode={countryCode}\n            phoneNumber={phoneNumber}\n            groupNumbers={groupNumbers}\n            showGroupNumberName={showGroupNumberName}\n            currentLocale={currentLocale}\n            enableContactFallback={enableContactFallback}\n            stopPropagation={false}\n            showType={false}\n            showPlaceholder={showContactDisplayPlaceholder}\n            sourceIcons={sourceIcons}\n          />\n          <div className={styles.details}>\n            {detail}\n          </div>\n          <div className={styles.creationTime}>\n            {dateTimeFormatter({ utcTimestamp: creationTime })}\n          </div>\n        </div>\n        <SlideMenu\n          extended={this.state.extended}\n          onToggle={this.toggleExtended}\n          extendIconClassName={styles.extendIcon}\n          className={styles.slideMenu}\n          minHeight={0}\n          maxHeight={slideMenuHeight}\n        >\n          <div className={styles.playContainer} onClick={this.preventEventPropogation}>\n            {player}\n          </div>\n          <ActionMenuList\n            className={styles.actionMenuList}\n            currentLocale={currentLocale}\n            onLog={isVoicemail ? undefined : (onLogConversation && this.logConversation)}\n            onViewEntity={onViewContact && this.viewSelectedContact}\n            onCreateEntity={onCreateContact && this.createSelectedContact}\n            hasEntity={correspondents.length === 1 && !!correspondentMatches.length}\n            onClickToDial={onClickToDial && this.clickToDial}\n            onClickToSms={isVoicemail ? (onClickToSms && this.onClickToSms) : undefined}\n            phoneNumber={phoneNumber}\n            disableLinks={disableLinks}\n            disableClickToDial={disableClickToDial}\n            isLogging={isLogging || this.state.isLogging}\n            isLogged={conversationMatches.length > 0}\n            isCreating={this.state.isCreating}\n            addLogTitle={i18n.getString('addLog', currentLocale)}\n            editLogTitle={i18n.getString('editLog', currentLocale)}\n            callTitle={i18n.getString('call', currentLocale)}\n            textTitle={i18n.getString('text', currentLocale)}\n            createEntityTitle={i18n.getString('addEntity', currentLocale)}\n            viewEntityTitle={i18n.getString('viewDetails', currentLocale)}\n            stopPropagation={false}\n            onDelete={isVoicemail ? this.onDeleteMessage : undefined}\n            deleteTitle={i18n.getString('delete', currentLocale)}\n            marked={unreadCounts > 0}\n            onMark={isVoicemail ? this.onMarkVoicemail : undefined}\n            onUnmark={isVoicemail ? this.onPlayVoicemail : undefined}\n            markTitle={i18n.getString('mark', currentLocale)}\n            unmarkTitle={i18n.getString('unmark', currentLocale)}\n          />\n        </SlideMenu>\n      </div>\n    );\n  }\n}\n\nMessageItem.propTypes = {\n  conversation: PropTypes.shape({\n    conversationId: PropTypes.string.isRequired,\n    isLogging: PropTypes.bool,\n    correspondents: PropTypes.arrayOf(PropTypes.shape({\n      name: PropTypes.string,\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n    })),\n    correspondentMatches: PropTypes.arrayOf(PropTypes.shape({\n      name: PropTypes.string,\n      entityType: PropTypes.string,\n    })),\n    conversationMatches: PropTypes.arrayOf(PropTypes.shape({\n      id: PropTypes.string,\n    })),\n    unreadCounts: PropTypes.number.isRequired,\n  }).isRequired,\n  areaCode: PropTypes.string.isRequired,\n  brand: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onLogConversation: PropTypes.func,\n  onViewContact: PropTypes.func,\n  onCreateContact: PropTypes.func,\n  onClickToDial: PropTypes.func,\n  onClickToSms: PropTypes.func,\n  disableLinks: PropTypes.bool,\n  disableClickToDial: PropTypes.bool,\n  dateTimeFormatter: PropTypes.func.isRequired,\n  showConversationDetail: PropTypes.func.isRequired,\n  readVoicemail: PropTypes.func.isRequired,\n  markVoicemail: PropTypes.func.isRequired,\n  autoLog: PropTypes.bool,\n  enableContactFallback: PropTypes.bool,\n  showContactDisplayPlaceholder: PropTypes.bool,\n  sourceIcons: PropTypes.object,\n  showGroupNumberName: PropTypes.bool,\n  deleteMessage: PropTypes.func,\n};\n\nMessageItem.defaultProps = {\n  onLogConversation: undefined,\n  onClickToDial: undefined,\n  onViewContact: undefined,\n  onCreateContact: undefined,\n  disableClickToDial: false,\n  onClickToSms: undefined,\n  disableLinks: false,\n  autoLog: false,\n  enableContactFallback: undefined,\n  showContactDisplayPlaceholder: true,\n  sourceIcons: undefined,\n  showGroupNumberName: false,\n  deleteMessage: () => {},\n};\n"]}