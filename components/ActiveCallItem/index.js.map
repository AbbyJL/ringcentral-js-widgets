{"version":3,"sources":["components/ActiveCallItem/index.js"],"names":["callIconMap","inbound","outbound","CallIcon","direction","ringing","inboundTitle","outboundTitle","title","callIcon","activeCall","propTypes","string","isRequired","bool","defaultProps","undefined","WebphoneButtons","session","webphoneAnswer","webphoneReject","webphoneHangup","webphoneResume","hangupFunc","resumeFunc","endIcon","rejectTitle","getString","acceptTitle","callStatus","connecting","webphoneButtons","rejectButton","e","stopPropagation","id","answerButton","object","func","ActiveCallItem","props","onSelectContact","value","nameMatches","getContactMatches","selected","findIndex","match","_userSelection","setState","call","activityMatches","length","autoLog","logCall","redirect","getSelectedContact","state","contactMatches","clickToSms","onClickToSms","phoneNumber","getPhoneNumber","contact","formatted","formatPhone","name","enableContactFallback","getFallbackContactName","createSelectedContact","entityType","onCreateContact","_mounted","isCreating","viewSelectedContact","onViewContact","bind","isLogging","extended","toggleExtended","contactDisplay","contains","target","preState","webphoneToVoicemail","sessionId","toVoicemailTimeout","setTimeout","clearTimeout","from","to","nextProps","fromMatches","toMatches","extensionNumber","telephonyStatus","startTime","webphoneSession","offset","disableLinks","currentLocale","myPhoneNumber","getMyPhoneNumber","callDetail","label","split","onLogCall","areaCode","countryCode","outboundSmsPermission","internalSmsPermission","brand","showContactDisplayPlaceholder","sourceIcons","parsedInfo","isExtension","hasPlus","number","showClickToSms","fallbackContactName","getCallInfo","root","callInfo","shape","array"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;;;AAEA,IAAMA,8EACH,yBAAeC,OADZ,EACsB,uBAAaA,OADnC,+CAEH,yBAAeC,QAFZ,EAEuB,uBAAaA,QAFpC,gBAAN;;AAKA,SAASC,QAAT,OAKG;AAAA,MAJDC,SAIC,QAJDA,SAIC;AAAA,MAHDC,OAGC,QAHDA,OAGC;AAAA,MAFDC,YAEC,QAFDA,YAEC;AAAA,MADDC,aACC,QADDA,aACC;;AACD,MAAMC,QAASJ,cAAc,yBAAeH,OAA9B,GAAyCK,YAAzC,GAAwDC,aAAtE;AACA,SACE;AAAA;AAAA,MAAK,WAAW,iBAAOE,QAAvB;AACE;AACE,iBAAW,0BACTT,YAAYI,SAAZ,CADS,EAET,iBAAOM,UAFE,EAGTL,WAAW,iBAAOA,OAHT,CADb;AAME,aAAOG;AANT;AADF,GADF;AAYD;;AAEDL,SAASQ,SAAT,GAAqB;AACnBP,aAAW,oBAAUQ,MAAV,CAAiBC,UADT;AAEnBR,WAAS,oBAAUS,IAFA;AAGnBR,gBAAc,oBAAUM,MAHL;AAInBL,iBAAe,oBAAUK;AAJN,CAArB;;AAOAT,SAASY,YAAT,GAAwB;AACtBV,WAAS,KADa;AAEtBC,gBAAcU,SAFQ;AAGtBT,iBAAeS;AAHO,CAAxB;;AAMA,SAASC,eAAT,QAMG;AAAA,MALDC,OAKC,SALDA,OAKC;AAAA,MAJDC,cAIC,SAJDA,cAIC;AAAA,MAHDC,cAGC,SAHDA,cAGC;AAAA,MAFDC,cAEC,SAFDA,cAEC;AAAA,MADDC,cACC,SADDA,cACC;;AACD,MAAI,CAACJ,OAAD,IAAY,CAACC,cAAb,IAA+B,CAACE,cAApC,EAAoD;AAClD,WAAO,IAAP;AACD;AACD,MAAIE,aAAaF,cAAjB;AACA,MAAIG,aAAaF,cAAjB;AACA,MAAIG,uBAAJ;AACA,MAAIC,cAAc,eAAKC,SAAL,CAAe,QAAf,CAAlB;AACA,MAAMC,cAAc,eAAKD,SAAL,CAAe,QAAf,CAApB;AACA,MACET,QAAQd,SAAR,KAAsB,yBAAeH,OAArC,IACAiB,QAAQW,UAAR,KAAuB,wBAAcC,UAFvC,EAGE;AACAP,iBAAaH,cAAb;AACAI,iBAAaL,cAAb;AACAM;AACAC,kBAAc,eAAKC,SAAL,CAAe,aAAf,CAAd;AACD;AACD,SACE;AAAA;AAAA,MAAK,WAAW,iBAAOI,eAAvB;AACE;AAAA;AAAA,QAAM,OAAOL,WAAb;AACE;AACE,mBAAW,iBAAOM,YADpB;AAEE,iBAAS,iBAACC,CAAD,EAAO;AACdA,YAAEC,eAAF;AACAX,qBAAWL,QAAQiB,EAAnB;AACD,SALH;AAME,mBAAW,GANb;AAOE,eAAO,GAPT;AAQE,cAAMV,OARR;AASE,oBAAY;AATd;AADF,KADF;AAcE;AAAA;AAAA,QAAM,OAAOG,WAAb;AACE;AACE,mBAAW,iBAAOQ,YADpB;AAEE,iBAAS,iBAACH,CAAD,EAAO;AACdA,YAAEC,eAAF;AACAV,qBAAWN,QAAQiB,EAAnB;AACD,SALH;AAME,8BANF;AAOE,oBAAY;AAPd;AADF;AAdF,GADF;AA4BD;;AAEDlB,gBAAgBN,SAAhB,GAA4B;AAC1BO,WAAS,oBAAUmB,MADO;AAE1BlB,kBAAgB,oBAAUmB,IAFA;AAG1BlB,kBAAgB,oBAAUkB,IAHA;AAI1BjB,kBAAgB,oBAAUiB,IAJA;AAK1BhB,kBAAgB,oBAAUgB;AALA,CAA5B;;AAQArB,gBAAgBF,YAAhB,GAA+B;AAC7BG,WAASF,SADoB;AAE7BG,kBAAgBH,SAFa;AAG7BI,kBAAgBJ,SAHa;AAI7BK,kBAAgBL,SAJa;AAK7BM,kBAAgBN;AALa,CAA/B;;IAQqBuB,c;;;AACnB,0BAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AAAA,sJACXA,KADW;;AAAA,UA6CnBC,eA7CmB,GA6CD,UAACC,KAAD,EAAW;AAC3B,UAAMC,cAAc,MAAKC,iBAAL,EAApB;AACA,UAAMC,WAAWF,YAAYG,SAAZ,CACf;AAAA,eAASC,MAAMZ,EAAN,KAAaO,MAAMP,EAA5B;AAAA,OADe,CAAjB;AAGA,YAAKa,cAAL,GAAsB,IAAtB;AACA,YAAKC,QAAL,CAAc;AACZJ;AADY,OAAd;AAGA,UACE,MAAKL,KAAL,CAAWU,IAAX,CAAgBC,eAAhB,CAAgCC,MAAhC,GAAyC,CAAzC,IACA,MAAKZ,KAAL,CAAWa,OAFb,EAGE;AACA,cAAKC,OAAL,CAAa,EAAEC,UAAU,KAAZ,EAAmBV,kBAAnB,EAAb;AACD;AACF,KA5DkB;;AAAA,UAoEnBW,kBApEmB,GAoEE,YAAoC;AAAA,UAAnCX,QAAmC,uEAAxB,MAAKY,KAAL,CAAWZ,QAAa;;AACvD,UAAMa,iBAAiB,MAAKd,iBAAL,EAAvB;AACA,aAAQC,WAAW,CAAC,CAAZ,IAAiBa,eAAeb,QAAf,CAAlB,IACJa,eAAeN,MAAf,KAA0B,CAA1B,IAA+BM,eAAe,CAAf,CAD3B,IAEL,IAFF;AAGD,KAzEkB;;AAAA,UAqInBC,UArImB,GAqIN,YAAM;AACjB,UAAI,MAAKnB,KAAL,CAAWoB,YAAf,EAA6B;AAC3B,YAAMC,cAAc,MAAKC,cAAL,EAApB;AACA,YAAMC,UAAU,MAAKP,kBAAL,EAAhB;AACA,YAAIO,OAAJ,EAAa;AACX,gBAAKvB,KAAL,CAAWoB,YAAX,4BACKG,OADL;AAEEF;AAFF;AAID,SALD,MAKO;AACL,cAAMG,YAAY,MAAKxB,KAAL,CAAWyB,WAAX,CAAuBJ,WAAvB,CAAlB;AACA,gBAAKrB,KAAL,CAAWoB,YAAX,CAAwB;AACtBM,kBAAM,MAAK1B,KAAL,CAAW2B,qBAAX,GAAmC,MAAKC,sBAAL,EAAnC,GAAmEJ,SADnD;AAEtBH;AAFsB,WAAxB,EAGG,IAHH;AAID;AACF;AACF,KAtJkB;;AAAA,UAwJnBQ,qBAxJmB;AAAA,2FAwJK,iBAAOC,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAElB,OAAO,MAAK9B,KAAL,CAAW+B,eAAlB,KAAsC,UAAtC,IACF,MAAKC,QADH,IAEF,CAAC,MAAKf,KAAL,CAAWgB,UAJQ;AAAA;AAAA;AAAA;;AAKpB,sBAAKxB,QAAL,CAAc;AACZwB,8BAAY;AADA,iBAAd;AAGA;AACMZ,2BATc,GASA,MAAKC,cAAL,EATA;AAAA;AAAA,uBAUd,MAAKtB,KAAL,CAAW+B,eAAX,CAA2B;AAC/BV,0CAD+B;AAE/BK,wBAAM,MAAK1B,KAAL,CAAW2B,qBAAX,GAAmC,MAAKC,sBAAL,EAAnC,GAAmE,EAF1C;AAG/BE;AAH+B,iBAA3B,CAVc;;AAAA;;AAgBpB,oBAAI,MAAKE,QAAT,EAAmB;AACjB,wBAAKvB,QAAL,CAAc;AACZwB,gCAAY;AADA,mBAAd;AAGA;AACD;;AArBmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAxJL;;AAAA;AAAA;AAAA;AAAA;;AAAA,UAiLnBC,mBAjLmB,GAiLG,YAAM;AAC1B,UAAI,OAAO,MAAKlC,KAAL,CAAWmC,aAAlB,KAAoC,UAAxC,EAAoD;AAClD,cAAKnC,KAAL,CAAWmC,aAAX,CAAyB;AACvBZ,mBAAS,MAAKP,kBAAL;AADc,SAAzB;AAGD;AACF,KAvLkB;;AAAA,UA8MnBF,OA9MmB,GA8MT,MAAKA,OAAL,CAAasB,IAAb,OA9MS;;AAEjB,UAAKnB,KAAL,GAAa;AACXZ,gBAAU,CADC;AAEXgC,iBAAW,KAFA;AAGXC,gBAAU,KAHC;AAIXL,kBAAY;AAJD,KAAb;AAMA,UAAKzB,cAAL,GAAsB,KAAtB;;AAEA,UAAK+B,cAAL,GAAsB,UAAC9C,CAAD,EAAO;AAC3B,UACE,MAAK+C,cAAL,IACA,MAAKA,cAAL,CAAoBC,QAApB,CAA6BhD,EAAEiD,MAA/B,CAFF,EAGE;AACA;AACD;AACD,YAAKjC,QAAL,CAAc;AAAA,eAAa;AACzB6B,oBAAU,CAACK,SAASL;AADK,SAAb;AAAA,OAAd;AAGD,KAVD;;AAYA,UAAKM,mBAAL,GAA2B,UAACC,SAAD,EAAe;AACxC,UAAI,OAAO,MAAK7C,KAAL,CAAW4C,mBAAlB,KAA0C,UAA9C,EAA0D;AACxD;AACD;AACD,YAAK5C,KAAL,CAAW4C,mBAAX,CAA+BC,SAA/B;AACA,YAAKC,kBAAL,GAA0BC,WAAW,YAAM;AACzC,cAAK/C,KAAL,CAAWpB,cAAX,CAA0BiE,SAA1B;AACD,OAFyB,EAEvB,IAFuB,CAA1B;AAGD,KARD;AAtBiB;AA+BlB;;;;wCAEmB;AAClB,WAAKb,QAAL,GAAgB,IAAhB;AACD;;;2CAEsB;AACrB,WAAKA,QAAL,GAAgB,KAAhB;AACA,UAAI,KAAKc,kBAAT,EAA6B;AAC3BE,qBAAa,KAAKF,kBAAlB;AACA,aAAKA,kBAAL,GAA0B,IAA1B;AACD;AACF;;;6CAmBwB;AACvB,aAAO,+BAAU,KAAK9C,KAAL,CAAWU,IAArB,IACJ,KAAKV,KAAL,CAAWU,IAAX,CAAgBuC,IAAhB,CAAqBvB,IADjB,GAEJ,KAAK1B,KAAL,CAAWU,IAAX,CAAgBwC,EAAhB,CAAmBxB,IAFtB;AAGD;;;wCASyC;AAAA,UAAxByB,SAAwB,uEAAZ,KAAKnD,KAAO;;AACxC,aAAO,+BAAUmD,UAAUzC,IAApB,IACLyC,UAAUzC,IAAV,CAAe0C,WADV,GAELD,UAAUzC,IAAV,CAAe2C,SAFjB;AAGD;;;qCAEgB;AACf,aAAO,+BAAU,KAAKrD,KAAL,CAAWU,IAArB,IACJ,KAAKV,KAAL,CAAWU,IAAX,CAAgBuC,IAAhB,CAAqB5B,WAArB,IAAoC,KAAKrB,KAAL,CAAWU,IAAX,CAAgBuC,IAAhB,CAAqBK,eADrD,GAEJ,KAAKtD,KAAL,CAAWU,IAAX,CAAgBwC,EAAhB,CAAmB7B,WAAnB,IAAkC,KAAKrB,KAAL,CAAWU,IAAX,CAAgBwC,EAAhB,CAAmBI,eAFxD;AAGD;;;uCAEkB;AACjB,aAAO,+BAAU,KAAKtD,KAAL,CAAWU,IAArB,IACJ,KAAKV,KAAL,CAAWU,IAAX,CAAgBwC,EAAhB,CAAmB7B,WAAnB,IAAkC,KAAKrB,KAAL,CAAWU,IAAX,CAAgBwC,EAAhB,CAAmBI,eADjD,GAEJ,KAAKtD,KAAL,CAAWU,IAAX,CAAgBuC,IAAhB,CAAqB5B,WAArB,IAAoC,KAAKrB,KAAL,CAAWU,IAAX,CAAgBuC,IAAhB,CAAqBK,eAF5D;AAGD;;;kCAEa;AAAA,mBAWR,KAAKtD,KAXG;AAAA,+BAEVU,IAFU;AAAA,UAGR6C,eAHQ,eAGRA,eAHQ;AAAA,UAIRC,SAJQ,eAIRA,SAJQ;AAAA,UAKRC,eALQ,eAKRA,eALQ;AAAA,UAMRC,MANQ,eAMRA,MANQ;AAAA,UAQVC,YARU,UAQVA,YARU;AAAA,UASVC,aATU,UASVA,aATU;AAAA,UAUVnC,WAVU,UAUVA,WAVU;;AAYZ,UAAMoC,gBAAgB,KAAKC,gBAAL,EAAtB;AACA,UAAIL,eAAJ,EAAqB;AACnB,eACE;AAAA;AAAA,YAAK,WAAW,iBAAOM,UAAvB;AACE;AAAA;AAAA,cAAM,WAAW,iBAAOC,KAAxB;AAEI,2CAAU,KAAKhE,KAAL,CAAWU,IAArB,IACE,eAAKvB,SAAL,CAAe,IAAf,EAAqByE,aAArB,CADF,GAEE,eAAKzE,SAAL,CAAe,MAAf,EAAuByE,aAAvB,CAJN;AAAA;AAAA,WADF;AAQGnC,sBAAYoC,aAAZ;AARH,SADF;AAYD;AACD,aACE;AAAA;AAAA,UAAK,WAAW,iBAAOE,UAAvB;AAEIJ,uBACE,eAAKxE,SAAL,CAAe,aAAf,EAA8ByE,aAA9B,CADF,GAEE,2DAAiB,WAAWJ,SAA5B,EAAuC,QAAQE,MAA/C,GAJN;AAME;AAAA;AAAA,YAAM,WAAW,iBAAOO,KAAxB;AAAA;AAAA,SANF;AAOI,uBAAK9E,SAAL,CAAeoE,eAAf,EAAgCK,aAAhC;AAPJ,OADF;AAWD;;;;;mCAsDe7C,Q;YAAAA,Q,kCAAW,I;YAAMV,Q,SAAAA,Q;;;;;sBAE7B,OAAO,KAAKL,KAAL,CAAWkE,SAAlB,KAAgC,UAAhC,IACA,KAAKlC,QADL,IAEA,CAAC,KAAKf,KAAL,CAAWoB,S;;;;;AAEZ,qBAAK5B,QAAL,CAAc;AACZ4B,6BAAW;AADC,iBAAd;;uBAGM,KAAKrC,KAAL,CAAWkE,SAAX,CAAqB;AACzB3C,2BAAS,KAAKP,kBAAL,CAAwBX,QAAxB,CADgB;AAEzBK,wBAAM,KAAKV,KAAL,CAAWU,IAFQ;AAGzBK;AAHyB,iBAArB,C;;;AAKN,oBAAI,KAAKiB,QAAT,EAAmB;AACjB,uBAAKvB,QAAL,CAAc;AACZ4B,+BAAW;AADC,mBAAd;AAGD;;;;;;;;;;;;;;;;;;6BAKI;AAAA;;AAAA,oBAyBH,KAAKrC,KAzBF;AAAA,iCAELU,IAFK;AAAA,UAGH9C,SAHG,gBAGHA,SAHG;AAAA,UAIH+C,eAJG,gBAIHA,eAJG;AAAA,UAKH8C,eALG,gBAKHA,eALG;AAAA,UAOLE,YAPK,WAOLA,YAPK;AAAA,UAQLC,aARK,WAQLA,aARK;AAAA,UASLO,QATK,WASLA,QATK;AAAA,UAULC,WAVK,WAULA,WAVK;AAAA,UAWLC,qBAXK,WAWLA,qBAXK;AAAA,UAYLC,qBAZK,WAYLA,qBAZK;AAAA,UAaL3C,qBAbK,WAaLA,qBAbK;AAAA,UAcLU,SAdK,WAcLA,SAdK;AAAA,UAeLkC,KAfK,WAeLA,KAfK;AAAA,UAgBLC,6BAhBK,WAgBLA,6BAhBK;AAAA,UAiBLpD,YAjBK,WAiBLA,YAjBK;AAAA,UAkBLe,aAlBK,WAkBLA,aAlBK;AAAA,UAmBLJ,eAnBK,WAmBLA,eAnBK;AAAA,UAoBLmC,SApBK,WAoBLA,SApBK;AAAA,UAqBLvF,cArBK,WAqBLA,cArBK;AAAA,UAsBLE,cAtBK,WAsBLA,cAtBK;AAAA,UAuBLC,cAvBK,WAuBLA,cAvBK;AAAA,UAwBL2F,WAxBK,WAwBLA,WAxBK;;AA0BP,UAAMpD,cAAc,KAAKC,cAAL,EAApB;AACA,UAAMoD,aAAa,2BAAYrD,WAAZ,CAAnB;AACA,UAAMsD,cAAc,CAACD,WAAWE,OAAZ,IAClBF,WAAWG,MAAX,CAAkBjE,MAAlB,IAA4B,CAD9B;AAEA,UAAMkE,iBAAiB,CAAC,EACtB1D,iBAEEuD,cACEL,qBADF,GAEED,qBAJJ,CADsB,CAAxB;AAQA,UAAMnD,iBAAiB,KAAKd,iBAAL,EAAvB;AACA,UAAM2E,sBAAsB,KAAKnD,sBAAL,EAA5B;AACA,UAAM/D,UAAU,+BAAU,KAAKmC,KAAL,CAAWU,IAArB,CAAhB;AACA,UAAMqD,aAAa,KAAKiB,WAAL,EAAnB;;AAEA,aACE;AAAA;AAAA,UAAK,WAAW,iBAAOC,IAAvB,EAA6B,SAAS,KAAK1C,cAA3C;AACE;AAAA;AAAA,YAAK,WAAW,iBAAO2C,QAAvB;AACE,wCAAC,QAAD;AACE,uBAAWtH,SADb;AAEE,qBAASC,OAFX;AAGE,wBAHF;AAIE,oBAAQ,KAJV;AAKE,0BAAc,eAAKsB,SAAL,CAAe,aAAf,EAA8ByE,aAA9B,CALhB;AAME,2BAAe,eAAKzE,SAAL,CAAe,cAAf,EAA+ByE,aAA/B,CANjB;AAOE,yBAAa,eAAKzE,SAAL,CAAe,YAAf,EAA6ByE,aAA7B;AAPf,YADF;AAUE;AACE,uBAAW,iBAAOpB,cADpB;AAEE,4BAAgBtB,cAFlB;AAGE,sBAAU,KAAKD,KAAL,CAAWZ,QAHvB;AAIE,6BAAiB,KAAKJ,eAJxB;AAKE,sBAAU0D,YALZ;AAME,uBAAWtB,aAAa,KAAKpB,KAAL,CAAWoB,SANrC;AAOE,0BAAc0C,mBAPhB;AAQE,mCAAuBpD,qBARzB;AASE,sBAAUwC,QATZ;AAUE,yBAAaC,WAVf;AAWE,yBAAa/C,WAXf;AAYE,2BAAeuC,aAZjB;AAaE,mBAAOW,KAbT;AAcE,6BAAiBC,6BAdnB;AAeE,sBAAU,KAfZ;AAgBE,yBAAaC,WAhBf;AAiBE;AAjBF,YAVF;AA6BGV,oBA7BH;AA8BE,wCAAC,eAAD;AACE,qBAASN,eADX;AAEE,4BAAgB9E,cAFlB;AAGE,4BAAgB,KAAKiE,mBAHvB;AAIE,4BAAgB/D,cAJlB;AAKE,4BAAgBC;AALlB;AA9BF,SADF;AAuCE;AACE,oBAAU,KAAKmC,KAAL,CAAWqB,QADvB;AAEE,oBAAU,KAAKC,cAFjB;AAGE,yBAAeqB,aAHjB;AAIE,wBAAcD,YAJhB;AAKE,uBAAatC,WALf;AAME,wBACEyD,iBACE;AAAA,mBAAM,OAAK3D,UAAL,CAAgB,EAAEiD,wBAAF,EAAeD,kBAAf,EAAhB,CAAN;AAAA,WADF,GAEI3F,SATR;AAWE,qBAAW,CAAC,CAAC0C,eAAeN,MAX9B;AAYE,wBAAcuB,iBAAiB,KAAKD,mBAZtC;AAaE,0BAAgBH,mBAAmB,KAAKF,qBAb1C;AAcE,qBAAW,eAAK1C,SAAL,CAAe,MAAf,EAAuByE,aAAvB,CAdb;AAeE,iBAAOM,SAfT;AAgBE,qBAAW7B,aAAa,KAAKpB,KAAL,CAAWoB,SAhBrC;AAiBE,oBAAU1B,gBAAgBC,MAAhB,GAAyB,CAjBrC;AAkBE,sBAAY,KAAKK,KAAL,CAAWgB,UAlBzB;AAmBE,uBAAa,eAAK9C,SAAL,CAAe,QAAf,EAAyByE,aAAzB,CAnBf;AAoBE,wBAAc,eAAKzE,SAAL,CAAe,SAAf,EAA0ByE,aAA1B,CApBhB;AAqBE,6BAAmB,eAAKzE,SAAL,CAAe,WAAf,EAA4ByE,aAA5B,CArBrB;AAsBE,2BAAiB,eAAKzE,SAAL,CAAe,aAAf,EAA8ByE,aAA9B;AAtBnB;AAvCF,OADF;AAkED;;;;;kBA9TkB7D,c;;;AAiUrBA,eAAe5B,SAAf,GAA2B;AACzBuC,QAAM,oBAAUyE,KAAV,CAAgB;AACpBvH,eAAW,oBAAUQ,MAAV,CAAiBC,UADR;AAEpBkF,qBAAiB,oBAAUnF,MAFP;AAGpBoF,eAAW,oBAAUqB,MAAV,CAAiBxG,UAHR;AAIpBsC,qBAAiB,oBAAUyE,KAAV,CAAgB/G,UAJb;AAKpB+E,iBAAa,oBAAUgC,KAAV,CAAgB/G,UALT;AAMpBgF,eAAW,oBAAU+B,KAAV,CAAgB/G,UANP;AAOpB4E,UAAM,oBAAUkC,KAAV,CAAgB;AACpB9D,mBAAa,oBAAUjD,MADH;AAEpBkF,uBAAiB,oBAAUlF,MAFP;AAGpBsD,YAAM,oBAAUtD;AAHI,KAAhB,EAIHC,UAXiB;AAYpB6E,QAAI,oBAAUiC,KAAV,CAAgB;AAClB9D,mBAAa,oBAAUjD,MADL;AAElBkF,uBAAiB,oBAAUlF,MAFT;AAGlBsD,YAAM,oBAAUtD;AAHE,KAAhB,CAZgB;AAiBpBqF,qBAAiB,oBAAU5D;AAjBP,GAAhB,EAkBHxB,UAnBsB;AAoBzB8F,YAAU,oBAAU/F,MAAV,CAAiBC,UApBF;AAqBzB+F,eAAa,oBAAUhG,MAAV,CAAiBC,UArBL;AAsBzBuF,iBAAe,oBAAUxF,MAAV,CAAiBC,UAtBP;AAuBzBsF,gBAAc,oBAAUrF,IAvBC;AAwBzB+F,yBAAuB,oBAAU/F,IAxBR;AAyBzBgG,yBAAuB,oBAAUhG,IAzBR;AA0BzB+D,aAAW,oBAAU/D,IA1BI;AA2BzBK,kBAAgB,oBAAUmB,IA3BD;AA4BzBlB,kBAAgB,oBAAUkB,IA5BD;AA6BzBjB,kBAAgB,oBAAUiB,IA7BD;AA8BzBhB,kBAAgB,oBAAUgB,IA9BD;AA+BzB8C,uBAAqB,oBAAU9C,IA/BN;AAgCzB6B,yBAAuB,oBAAUrD,IAhCR;AAiCzBuC,WAAS,oBAAUvC,IAjCM;AAkCzBiG,SAAO,oBAAUnG,MAlCQ;AAmCzBoG,iCAA+B,oBAAUlG,IAnChB;AAoCzBmD,eAAa,oBAAU3B,IAAV,CAAezB,UApCH;AAqCzB+C,gBAAc,oBAAUtB,IArCC;AAsCzBiC,mBAAiB,oBAAUjC,IAtCF;AAuCzBoE,aAAW,oBAAUpE,IAvCI;AAwCzBqC,iBAAe,oBAAUrC,IAxCA;AAyCzB2E,eAAa,oBAAU5E;AAzCE,CAA3B;;AA4CAE,eAAexB,YAAf,GAA8B;AAC5B2F,aAAW1F,SADiB;AAE5B4C,gBAAc5C,SAFc;AAG5B2D,iBAAe3D,SAHa;AAI5BuD,mBAAiBvD,SAJW;AAK5B6D,aAAW,KALiB;AAM5BgC,yBAAuB,KANK;AAO5BC,yBAAuB,KAPK;AAQ5BX,gBAAc,KARc;AAS5BhF,kBAAgBH,SATY;AAU5BI,kBAAgBJ,SAVY;AAW5BK,kBAAgBL,SAXY;AAY5BM,kBAAgBN,SAZY;AAa5BoE,uBAAqBpE,SAbO;AAc5BmD,yBAAuBnD,SAdK;AAe5BqC,WAAS,KAfmB;AAgB5B0D,SAAO,aAhBqB;AAiB5BC,iCAA+B,IAjBH;AAkB5BC,eAAajG;AAlBe,CAA9B","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport sessionStatus from 'ringcentral-integration/modules/Webphone/sessionStatus';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\nimport { isInbound, isRinging } from 'ringcentral-integration/lib/callLogHelpers';\nimport parseNumber from 'ringcentral-integration/lib/parseNumber';\n\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport DurationCounter from '../DurationCounter';\nimport ContactDisplay from '../ContactDisplay';\nimport ActionMenu from '../ActionMenu';\nimport CircleButton from '../CircleButton';\nimport EndIcon from '../../assets/images/End.svg';\nimport AnswerIcon from '../../assets/images/Answer.svg';\nimport VoicemailIcon from '../../assets/images/Voicemail.svg';\n\nimport styles from './styles.scss';\n\nimport i18n from './i18n';\n\nconst callIconMap = {\n  [callDirections.inbound]: dynamicsFont.inbound,\n  [callDirections.outbound]: dynamicsFont.outbound,\n};\n\nfunction CallIcon({\n  direction,\n  ringing,\n  inboundTitle,\n  outboundTitle,\n}) {\n  const title = (direction === callDirections.inbound) ? inboundTitle : outboundTitle;\n  return (\n    <div className={styles.callIcon}>\n      <span\n        className={classnames(\n          callIconMap[direction],\n          styles.activeCall,\n          ringing && styles.ringing,\n        )}\n        title={title}\n      />\n    </div>\n  );\n}\n\nCallIcon.propTypes = {\n  direction: PropTypes.string.isRequired,\n  ringing: PropTypes.bool,\n  inboundTitle: PropTypes.string,\n  outboundTitle: PropTypes.string,\n};\n\nCallIcon.defaultProps = {\n  ringing: false,\n  inboundTitle: undefined,\n  outboundTitle: undefined,\n};\n\nfunction WebphoneButtons({\n  session,\n  webphoneAnswer,\n  webphoneReject,\n  webphoneHangup,\n  webphoneResume,\n}) {\n  if (!session || !webphoneAnswer || !webphoneHangup) {\n    return null;\n  }\n  let hangupFunc = webphoneHangup;\n  let resumeFunc = webphoneResume;\n  let endIcon = EndIcon;\n  let rejectTitle = i18n.getString('hangup');\n  const acceptTitle = i18n.getString('accept');\n  if (\n    session.direction === callDirections.inbound &&\n    session.callStatus === sessionStatus.connecting\n  ) {\n    hangupFunc = webphoneReject;\n    resumeFunc = webphoneAnswer;\n    endIcon = VoicemailIcon;\n    rejectTitle = i18n.getString('toVoicemail');\n  }\n  return (\n    <div className={styles.webphoneButtons}>\n      <span title={rejectTitle}>\n        <CircleButton\n          className={styles.rejectButton}\n          onClick={(e) => {\n            e.stopPropagation();\n            hangupFunc(session.id);\n          }}\n          iconWidth={260}\n          iconX={120}\n          icon={endIcon}\n          showBorder={false}\n        />\n      </span>\n      <span title={acceptTitle}>\n        <CircleButton\n          className={styles.answerButton}\n          onClick={(e) => {\n            e.stopPropagation();\n            resumeFunc(session.id);\n          }}\n          icon={AnswerIcon}\n          showBorder={false}\n      />\n      </span>\n    </div>\n  );\n}\n\nWebphoneButtons.propTypes = {\n  session: PropTypes.object,\n  webphoneAnswer: PropTypes.func,\n  webphoneReject: PropTypes.func,\n  webphoneHangup: PropTypes.func,\n  webphoneResume: PropTypes.func,\n};\n\nWebphoneButtons.defaultProps = {\n  session: undefined,\n  webphoneAnswer: undefined,\n  webphoneReject: undefined,\n  webphoneHangup: undefined,\n  webphoneResume: undefined,\n};\n\nexport default class ActiveCallItem extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      selected: 0,\n      isLogging: false,\n      extended: false,\n      isCreating: false,\n    };\n    this._userSelection = false;\n\n    this.toggleExtended = (e) => {\n      if ((\n        this.contactDisplay &&\n        this.contactDisplay.contains(e.target))\n      ) {\n        return;\n      }\n      this.setState(preState => ({\n        extended: !preState.extended,\n      }));\n    };\n\n    this.webphoneToVoicemail = (sessionId) => {\n      if (typeof this.props.webphoneToVoicemail !== 'function') {\n        return;\n      }\n      this.props.webphoneToVoicemail(sessionId);\n      this.toVoicemailTimeout = setTimeout(() => {\n        this.props.webphoneReject(sessionId);\n      }, 3000);\n    };\n  }\n\n  componentDidMount() {\n    this._mounted = true;\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n    if (this.toVoicemailTimeout) {\n      clearTimeout(this.toVoicemailTimeout);\n      this.toVoicemailTimeout = null;\n    }\n  }\n\n  onSelectContact = (value) => {\n    const nameMatches = this.getContactMatches();\n    const selected = nameMatches.findIndex(\n      match => match.id === value.id\n    );\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (\n      this.props.call.activityMatches.length > 0 &&\n      this.props.autoLog\n    ) {\n      this.logCall({ redirect: false, selected });\n    }\n  }\n\n  getFallbackContactName() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.name) :\n      (this.props.call.to.name);\n  }\n\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.getContactMatches();\n    return (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null;\n  }\n\n  getContactMatches(nextProps = this.props) {\n    return isInbound(nextProps.call) ?\n      nextProps.call.fromMatches :\n      nextProps.call.toMatches;\n  }\n\n  getPhoneNumber() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.phoneNumber || this.props.call.from.extensionNumber) :\n      (this.props.call.to.phoneNumber || this.props.call.to.extensionNumber);\n  }\n\n  getMyPhoneNumber() {\n    return isInbound(this.props.call) ?\n      (this.props.call.to.phoneNumber || this.props.call.to.extensionNumber) :\n      (this.props.call.from.phoneNumber || this.props.call.from.extensionNumber);\n  }\n\n  getCallInfo() {\n    const {\n      call: {\n        telephonyStatus,\n        startTime,\n        webphoneSession,\n        offset,\n      },\n      disableLinks,\n      currentLocale,\n      formatPhone,\n    } = this.props;\n    const myPhoneNumber = this.getMyPhoneNumber();\n    if (webphoneSession) {\n      return (\n        <div className={styles.callDetail}>\n          <span className={styles.label}>\n            {\n              isInbound(this.props.call) ?\n                i18n.getString('to', currentLocale) :\n                i18n.getString('from', currentLocale)\n            }:\n          </span>\n          {formatPhone(myPhoneNumber)}\n        </div>\n      );\n    }\n    return (\n      <div className={styles.callDetail}>\n        {\n          disableLinks ?\n            i18n.getString('unavailable', currentLocale) :\n            <DurationCounter startTime={startTime} offset={offset} />\n        }\n        <span className={styles.split}>|</span>\n        { i18n.getString(telephonyStatus, currentLocale) }\n      </div>\n    );\n  }\n\n  clickToSms = () => {\n    if (this.props.onClickToSms) {\n      const phoneNumber = this.getPhoneNumber();\n      const contact = this.getSelectedContact();\n      if (contact) {\n        this.props.onClickToSms({\n          ...contact,\n          phoneNumber,\n        });\n      } else {\n        const formatted = this.props.formatPhone(phoneNumber);\n        this.props.onClickToSms({\n          name: this.props.enableContactFallback ? this.getFallbackContactName() : formatted,\n          phoneNumber,\n        }, true);\n      }\n    }\n  }\n\n  createSelectedContact = async (entityType) => {\n    // console.log('click createSelectedContact!!', entityType);\n    if (typeof this.props.onCreateContact === 'function' &&\n      this._mounted &&\n      !this.state.isCreating) {\n      this.setState({\n        isCreating: true,\n      });\n      // console.log('start to create: isCreating...', this.state.isCreating);\n      const phoneNumber = this.getPhoneNumber();\n      await this.props.onCreateContact({\n        phoneNumber,\n        name: this.props.enableContactFallback ? this.getFallbackContactName() : '',\n        entityType,\n      });\n\n      if (this._mounted) {\n        this.setState({\n          isCreating: false,\n        });\n        // console.log('created: isCreating...', this.state.isCreating);\n      }\n    }\n  }\n\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        contact: this.getSelectedContact(),\n      });\n    }\n  }\n\n  async logCall({ redirect = true, selected }) {\n    if (\n      typeof this.props.onLogCall === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogCall({\n        contact: this.getSelectedContact(selected),\n        call: this.props.call,\n        redirect,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n  logCall = this.logCall.bind(this)\n\n  render() {\n    const {\n      call: {\n        direction,\n        activityMatches,\n        webphoneSession,\n      },\n      disableLinks,\n      currentLocale,\n      areaCode,\n      countryCode,\n      outboundSmsPermission,\n      internalSmsPermission,\n      enableContactFallback,\n      isLogging,\n      brand,\n      showContactDisplayPlaceholder,\n      onClickToSms,\n      onViewContact,\n      onCreateContact,\n      onLogCall,\n      webphoneAnswer,\n      webphoneHangup,\n      webphoneResume,\n      sourceIcons,\n    } = this.props;\n    const phoneNumber = this.getPhoneNumber();\n    const parsedInfo = parseNumber(phoneNumber);\n    const isExtension = !parsedInfo.hasPlus &&\n      parsedInfo.number.length <= 6;\n    const showClickToSms = !!(\n      onClickToSms &&\n      (\n        isExtension ?\n          internalSmsPermission :\n          outboundSmsPermission\n      )\n    );\n    const contactMatches = this.getContactMatches();\n    const fallbackContactName = this.getFallbackContactName();\n    const ringing = isRinging(this.props.call);\n    const callDetail = this.getCallInfo();\n\n    return (\n      <div className={styles.root} onClick={this.toggleExtended}>\n        <div className={styles.callInfo}>\n          <CallIcon\n            direction={direction}\n            ringing={ringing}\n            active\n            missed={false}\n            inboundTitle={i18n.getString('inboundCall', currentLocale)}\n            outboundTitle={i18n.getString('outboundCall', currentLocale)}\n            missedTitle={i18n.getString('missedCall', currentLocale)}\n          />\n          <ContactDisplay\n            className={styles.contactDisplay}\n            contactMatches={contactMatches}\n            selected={this.state.selected}\n            onSelectContact={this.onSelectContact}\n            disabled={disableLinks}\n            isLogging={isLogging || this.state.isLogging}\n            fallBackName={fallbackContactName}\n            enableContactFallback={enableContactFallback}\n            areaCode={areaCode}\n            countryCode={countryCode}\n            phoneNumber={phoneNumber}\n            currentLocale={currentLocale}\n            brand={brand}\n            showPlaceholder={showContactDisplayPlaceholder}\n            showType={false}\n            sourceIcons={sourceIcons}\n            stopPropagation\n          />\n          {callDetail}\n          <WebphoneButtons\n            session={webphoneSession}\n            webphoneAnswer={webphoneAnswer}\n            webphoneReject={this.webphoneToVoicemail}\n            webphoneHangup={webphoneHangup}\n            webphoneResume={webphoneResume}\n          />\n        </div>\n        <ActionMenu\n          extended={this.state.extended}\n          onToggle={this.toggleExtended}\n          currentLocale={currentLocale}\n          disableLinks={disableLinks}\n          phoneNumber={phoneNumber}\n          onClickToSms={\n            showClickToSms ?\n              () => this.clickToSms({ countryCode, areaCode })\n              : undefined\n          }\n          hasEntity={!!contactMatches.length}\n          onViewEntity={onViewContact && this.viewSelectedContact}\n          onCreateEntity={onCreateContact && this.createSelectedContact}\n          textTitle={i18n.getString('text', currentLocale)}\n          onLog={onLogCall}\n          isLogging={isLogging || this.state.isLogging}\n          isLogged={activityMatches.length > 0}\n          isCreating={this.state.isCreating}\n          addLogTitle={i18n.getString('addLog', currentLocale)}\n          editLogTitle={i18n.getString('editLog', currentLocale)}\n          createEntityTitle={i18n.getString('addEntity', currentLocale)}\n          viewEntityTitle={i18n.getString('viewDetails', currentLocale)}\n        />\n      </div>\n    );\n  }\n}\n\nActiveCallItem.propTypes = {\n  call: PropTypes.shape({\n    direction: PropTypes.string.isRequired,\n    telephonyStatus: PropTypes.string,\n    startTime: PropTypes.number.isRequired,\n    activityMatches: PropTypes.array.isRequired,\n    fromMatches: PropTypes.array.isRequired,\n    toMatches: PropTypes.array.isRequired,\n    from: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }).isRequired,\n    to: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }),\n    webphoneSession: PropTypes.object,\n  }).isRequired,\n  areaCode: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  disableLinks: PropTypes.bool,\n  outboundSmsPermission: PropTypes.bool,\n  internalSmsPermission: PropTypes.bool,\n  isLogging: PropTypes.bool,\n  webphoneAnswer: PropTypes.func,\n  webphoneReject: PropTypes.func,\n  webphoneHangup: PropTypes.func,\n  webphoneResume: PropTypes.func,\n  webphoneToVoicemail: PropTypes.func,\n  enableContactFallback: PropTypes.bool,\n  autoLog: PropTypes.bool,\n  brand: PropTypes.string,\n  showContactDisplayPlaceholder: PropTypes.bool,\n  formatPhone: PropTypes.func.isRequired,\n  onClickToSms: PropTypes.func,\n  onCreateContact: PropTypes.func,\n  onLogCall: PropTypes.func,\n  onViewContact: PropTypes.func,\n  sourceIcons: PropTypes.object,\n};\n\nActiveCallItem.defaultProps = {\n  onLogCall: undefined,\n  onClickToSms: undefined,\n  onViewContact: undefined,\n  onCreateContact: undefined,\n  isLogging: false,\n  outboundSmsPermission: false,\n  internalSmsPermission: false,\n  disableLinks: false,\n  webphoneAnswer: undefined,\n  webphoneReject: undefined,\n  webphoneHangup: undefined,\n  webphoneResume: undefined,\n  webphoneToVoicemail: undefined,\n  enableContactFallback: undefined,\n  autoLog: false,\n  brand: 'RingCentral',\n  showContactDisplayPlaceholder: true,\n  sourceIcons: undefined,\n};\n"]}