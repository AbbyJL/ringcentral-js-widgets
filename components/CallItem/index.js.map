{"version":3,"sources":["components/CallItem/index.js"],"names":["callIconMap","inbound","outbound","missed","CallIcon","direction","active","ringing","inboundTitle","outboundTitle","missedTitle","title","callIcon","activeCall","propTypes","string","isRequired","bool","defaultProps","CallItem","props","onSelectContact","value","idx","selected","showContactDisplayPlaceholder","parseInt","_userSelection","setState","call","activityMatches","length","autoLog","logCall","redirect","getSelectedContact","state","contactMatches","getContactMatches","bind","viewSelectedContact","onViewContact","phoneNumber","getPhoneNumber","contact","createSelectedContact","entityType","onCreateContact","_mounted","isCreating","name","enableContactFallback","getFallbackContactName","clickToSms","countryCode","areaCode","onClickToSms","formatted","clickToDial","onClickToDial","getInitialContactIndex","isLogging","loading","setTimeout","nextProps","fromMatches","toMatches","activity","index","findIndex","isLoggedContact","toNumberEntity","id","from","extensionNumber","to","onLogCall","root","telephonyStatus","result","startTime","duration","offset","brand","currentLocale","disableLinks","disableClickToDial","outboundSmsPermission","internalSmsPermission","dateTimeFormatter","fallbackContactName","parsedInfo","isExtension","hasPlus","number","showClickToSms","durationEl","getString","dateEl","utcTimestamp","statusEl","contactDisplay","dropdownSelect","details","undefined","shape","array","webphoneSession","object","func"],"mappings":"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","file":"index.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport classnames from 'classnames';\nimport 'core-js/fn/array/find';\nimport callDirections from 'ringcentral-integration/enums/callDirections';\n// import sessionStatus from 'ringcentral-integration/modules/Webphone/sessionStatus';\nimport {\n  isInbound,\n  isRinging,\n  isMissed,\n} from 'ringcentral-integration/lib/callLogHelpers';\nimport parseNumber from 'ringcentral-integration/lib/parseNumber';\nimport formatNumber from 'ringcentral-integration/lib/formatNumber';\nimport dynamicsFont from '../../assets/DynamicsFont/DynamicsFont.scss';\nimport DurationCounter from '../DurationCounter';\nimport ContactDisplay from '../ContactDisplay';\nimport formatDuration from '../../lib/formatDuration';\nimport ActionMenu from '../ActionMenu';\n// import Button from '../Button';\nimport styles from './styles.scss';\n\nimport i18n from './i18n';\n\nconst callIconMap = {\n  [callDirections.inbound]: dynamicsFont.inbound,\n  [callDirections.outbound]: dynamicsFont.outbound,\n  missed: dynamicsFont.missed,\n};\n\nfunction CallIcon({\n  direction,\n  missed,\n  active,\n  ringing,\n  inboundTitle,\n  outboundTitle,\n  missedTitle,\n}) {\n  const title = missed ? missedTitle :\n    (direction === callDirections.inbound) ? inboundTitle : outboundTitle;\n  return (\n    <div className={styles.callIcon}>\n      <span\n        className={classnames(\n          missed ? callIconMap.missed : callIconMap[direction],\n          active && styles.activeCall,\n          ringing && styles.ringing,\n          missed && styles.missed,\n        )}\n        title={title}\n      />\n    </div>\n  );\n}\nCallIcon.propTypes = {\n  direction: PropTypes.string.isRequired,\n  missed: PropTypes.bool,\n  active: PropTypes.bool,\n  ringing: PropTypes.bool,\n};\nCallIcon.defaultProps = {\n  missed: false,\n  active: false,\n  ringing: false,\n};\n\nexport default class CallItem extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      selected: this.getInitialContactIndex(),\n      isLogging: false,\n      isCreating: false,\n      loading: true,\n    };\n    this._userSelection = false;\n  }\n  componentDidMount() {\n    this._mounted = true;\n    setTimeout(() => {\n      // clear timeout is probably not necessary\n      if (this._mounted) {\n        this.setState({\n          loading: false,\n        });\n      }\n    }, 10);\n  }\n  componentWillReceiveProps(nextProps) {\n    if (\n      !this._userSelection &&\n      (\n        nextProps.call.activityMatches !== this.props.call.activityMatches ||\n        nextProps.call.fromMatches !== this.props.call.fromMatches ||\n        nextProps.call.toMatches !== this.props.call.toMatches\n      )\n    ) {\n      this.setState({\n        selected: this.getInitialContactIndex(nextProps),\n      });\n    }\n  }\n  componentWillUnmount() {\n    this._mounted = false;\n  }\n  onSelectContact = (value, idx) => {\n    const selected = this.props.showContactDisplayPlaceholder\n      ? parseInt(idx, 10) - 1 : parseInt(idx, 10);\n    this._userSelection = true;\n    this.setState({\n      selected,\n    });\n    if (\n      this.props.call.activityMatches.length > 0 &&\n      this.props.autoLog\n    ) {\n      this.logCall({ redirect: false, selected });\n    }\n  }\n  getInitialContactIndex(nextProps = this.props) {\n    const contactMatches = this.getContactMatches(nextProps);\n    const activityMatches = nextProps.call.activityMatches;\n    // console.log('getInitialContactIndex:', nextProps.call.toNumberEntity);\n    for (const activity of activityMatches) {\n      const index = contactMatches.findIndex(contact => (\n        // TODO find a better name or mechanism...\n        this.props.isLoggedContact(nextProps.call, activity, contact)\n      ));\n      if (index > -1) return index;\n    }\n    if (nextProps.call.toNumberEntity) {\n      const index = contactMatches.findIndex(contact => (\n        contact.id === nextProps.call.toNumberEntity\n      ));\n      return index;\n    }\n    return -1;\n  }\n  getSelectedContact = (selected = this.state.selected) => {\n    const contactMatches = this.getContactMatches();\n    return (selected > -1 && contactMatches[selected]) ||\n      (contactMatches.length === 1 && contactMatches[0]) ||\n      null;\n  }\n  getPhoneNumber() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.phoneNumber || this.props.call.from.extensionNumber) :\n      (this.props.call.to.phoneNumber || this.props.call.to.extensionNumber);\n  }\n  getContactMatches(nextProps = this.props) {\n    return isInbound(nextProps.call) ?\n      nextProps.call.fromMatches :\n      nextProps.call.toMatches;\n  }\n  getFallbackContactName() {\n    return isInbound(this.props.call) ?\n      (this.props.call.from.name) :\n      (this.props.call.to.name);\n  }\n  async logCall({ redirect = true, selected }) {\n    if (\n      typeof this.props.onLogCall === 'function' &&\n      this._mounted &&\n      !this.state.isLogging\n    ) {\n      this.setState({\n        isLogging: true,\n      });\n      await this.props.onLogCall({\n        contact: this.getSelectedContact(selected),\n        call: this.props.call,\n        redirect,\n      });\n      if (this._mounted) {\n        this.setState({\n          isLogging: false,\n        });\n      }\n    }\n  }\n  logCall = this.logCall.bind(this)\n\n  viewSelectedContact = () => {\n    if (typeof this.props.onViewContact === 'function') {\n      this.props.onViewContact({\n        phoneNumber: this.getPhoneNumber(),\n        contact: this.getSelectedContact(),\n      });\n    }\n  }\n\n  createSelectedContact = async (entityType) => {\n    // console.log('click createSelectedContact!!', entityType);\n    if (typeof this.props.onCreateContact === 'function' &&\n      this._mounted &&\n      !this.state.isCreating) {\n      this.setState({\n        isCreating: true,\n      });\n      // console.log('start to create: isCreating...', this.state.isCreating);\n      const phoneNumber = this.getPhoneNumber();\n      await this.props.onCreateContact({\n        phoneNumber,\n        name: this.props.enableContactFallback ? this.getFallbackContactName() : '',\n        entityType,\n      });\n\n      if (this._mounted) {\n        this.setState({\n          isCreating: false,\n        });\n        // console.log('created: isCreating...', this.state.isCreating);\n      }\n    }\n  }\n  clickToSms = ({ countryCode, areaCode }) => {\n    if (this.props.onClickToSms) {\n      const phoneNumber = this.getPhoneNumber();\n      const contact = this.getSelectedContact();\n      if (contact) {\n        this.props.onClickToSms({\n          ...contact,\n          phoneNumber,\n        });\n      } else {\n        const formatted = formatNumber({\n          phoneNumber,\n          countryCode,\n          areaCode,\n        });\n        this.props.onClickToSms({\n          name: this.props.enableContactFallback ? this.getFallbackContactName() : formatted,\n          phoneNumber,\n        }, true);\n      }\n    }\n  }\n  clickToDial = () => {\n    if (this.props.onClickToDial) {\n      this.props.onClickToDial(this.getPhoneNumber());\n    }\n  }\n  render() {\n    if (this.state.loading) {\n      return (\n        <div className={styles.root} />\n      );\n    }\n    const {\n      call: {\n        direction,\n        telephonyStatus,\n        result,\n        startTime,\n        duration,\n        activityMatches,\n        offset,\n      // webphoneSession,\n    },\n      brand,\n      currentLocale,\n      areaCode,\n      countryCode,\n      disableLinks,\n      disableClickToDial,\n      outboundSmsPermission,\n      internalSmsPermission,\n      active,\n      onViewContact,\n      onCreateContact,\n      onLogCall,\n      onClickToDial,\n      onClickToSms,\n      dateTimeFormatter,\n      isLogging,\n      // webphoneAnswer,\n      // webphoneReject,\n      // webphoneHangup,\n      // webphoneResume,\n      enableContactFallback,\n      showContactDisplayPlaceholder,\n    } = this.props;\n    const phoneNumber = this.getPhoneNumber();\n    const contactMatches = this.getContactMatches();\n    const fallbackContactName = this.getFallbackContactName();\n    const ringing = isRinging(this.props.call);\n    const missed = isInbound(this.props.call) && isMissed(this.props.call);\n    const parsedInfo = parseNumber(phoneNumber);\n    const isExtension = !parsedInfo.hasPlus &&\n      parsedInfo.number.length <= 6;\n    const showClickToSms = !!(\n      onClickToSms &&\n      (\n        isExtension ?\n          internalSmsPermission :\n          outboundSmsPermission\n      )\n    );\n\n    let durationEl;\n    if (typeof duration === 'undefined') {\n      durationEl = disableLinks ?\n        i18n.getString('unavailable', currentLocale) :\n        <DurationCounter startTime={startTime} offset={offset} />;\n    } else {\n      durationEl = formatDuration(duration);\n    }\n    let dateEl;\n    if (!active) {\n      dateEl = dateTimeFormatter({ utcTimestamp: startTime });\n    }\n    let statusEl;\n    if (active) {\n      statusEl = i18n.getString(result || telephonyStatus, currentLocale);\n    }\n    // let webphoneEl;\n    // if (webphoneSession) {\n    //   let hangupFunc = webphoneHangup;\n    //   let resumeFunc = webphoneResume;\n    //   if (\n    //     webphoneSession.direction === callDirections.inbound &&\n    //     webphoneSession.callStatus === sessionStatus.connecting\n    //   ) {\n    //     hangupFunc = webphoneReject;\n    //     resumeFunc = webphoneAnswer;\n    //   }\n    //   webphoneEl = (\n    //     <div className={styles.webphoneButtons}>\n    //       <Button\n    //         className={classnames(styles.webphoneButton, styles.rejectWebphoneButton)}\n    //         onClick={() => hangupFunc(webphoneSession.id)}\n    //       >\n    //         <i className={dynamicsFont.missed} />\n    //       </Button>\n    //       <Button\n    //         className={styles.webphoneButton}\n    //         onClick={() => resumeFunc(webphoneSession.id)}\n    //       >\n    //         <i className={dynamicsFont.call} />\n    //       </Button>\n    //     </div>\n    //   );\n    // }\n    return (\n      <div className={styles.root}>\n        <CallIcon\n          direction={direction}\n          ringing={ringing}\n          active={active}\n          missed={missed}\n          inboundTitle={i18n.getString('inboundCall', currentLocale)}\n          outboundTitle={i18n.getString('outboundCall', currentLocale)}\n          missedTitle={i18n.getString('missedCall', currentLocale)}\n        />\n        <ContactDisplay\n          className={classnames(\n            styles.contactDisplay,\n            missed && styles.missed,\n            active && styles.active,\n          )}\n          selectClassName={styles.dropdownSelect}\n          brand={brand}\n          contactMatches={contactMatches}\n          selected={this.state.selected}\n          onSelectContact={this.onSelectContact}\n          disabled={disableLinks}\n          isLogging={isLogging || this.state.isLogging}\n          fallBackName={fallbackContactName}\n          enableContactFallback={enableContactFallback}\n          areaCode={areaCode}\n          countryCode={countryCode}\n          phoneNumber={phoneNumber}\n          currentLocale={currentLocale}\n          stopPropagation={false}\n          showType={false}\n          showPlaceholder={showContactDisplayPlaceholder}\n        />\n        <div className={styles.details} >\n          {durationEl} | {dateEl}{statusEl}\n        </div>\n        <ActionMenu\n          currentLocale={currentLocale}\n          onLog={onLogCall && this.logCall}\n          onViewEntity={onViewContact && this.viewSelectedContact}\n          onCreateEntity={onCreateContact && this.createSelectedContact}\n          hasEntity={!!contactMatches.length}\n          onClickToDial={onClickToDial && this.clickToDial}\n          onClickToSms={\n            showClickToSms ?\n              () => this.clickToSms({ countryCode, areaCode })\n              : undefined\n          }\n          phoneNumber={phoneNumber}\n          disableLinks={disableLinks}\n          disableClickToDial={disableClickToDial}\n          isLogging={isLogging || this.state.isLogging}\n          isLogged={activityMatches.length > 0}\n          isCreating={this.state.isCreating}\n          addLogTitle={i18n.getString('addLog', currentLocale)}\n          editLogTitle={i18n.getString('editLog', currentLocale)}\n          textTitle={i18n.getString('text', currentLocale)}\n          callTitle={i18n.getString('call', currentLocale)}\n          createEntityTitle={i18n.getString('addEntity', currentLocale)}\n          viewEntityTitle={i18n.getString('viewDetails', currentLocale)}\n        />\n      </div>\n    );\n  }\n}\n\nCallItem.propTypes = {\n  call: PropTypes.shape({\n    direction: PropTypes.string.isRequired,\n    telephonyStatus: PropTypes.string,\n    startTime: PropTypes.number.isRequired,\n    activityMatches: PropTypes.array.isRequired,\n    fromMatches: PropTypes.array.isRequired,\n    toMatches: PropTypes.array.isRequired,\n    from: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }).isRequired,\n    to: PropTypes.shape({\n      phoneNumber: PropTypes.string,\n      extensionNumber: PropTypes.string,\n      name: PropTypes.string,\n    }),\n    webphoneSession: PropTypes.object,\n  }).isRequired,\n  areaCode: PropTypes.string.isRequired,\n  brand: PropTypes.string.isRequired,\n  countryCode: PropTypes.string.isRequired,\n  currentLocale: PropTypes.string.isRequired,\n  onLogCall: PropTypes.func,\n  onViewContact: PropTypes.func,\n  onCreateContact: PropTypes.func,\n  onClickToDial: PropTypes.func,\n  onClickToSms: PropTypes.func,\n  isLoggedContact: PropTypes.func,\n  disableLinks: PropTypes.bool,\n  disableClickToDial: PropTypes.bool,\n  outboundSmsPermission: PropTypes.bool,\n  internalSmsPermission: PropTypes.bool,\n  active: PropTypes.bool.isRequired,\n  dateTimeFormatter: PropTypes.func.isRequired,\n  isLogging: PropTypes.bool,\n  // webphoneAnswer: PropTypes.func,\n  // webphoneReject: PropTypes.func,\n  // webphoneHangup: PropTypes.func,\n  // webphoneResume: PropTypes.func,\n  enableContactFallback: PropTypes.bool,\n  autoLog: PropTypes.bool,\n  showContactDisplayPlaceholder: PropTypes.bool,\n};\n\nCallItem.defaultProps = {\n  onLogCall: undefined,\n  onClickToDial: undefined,\n  onClickToSms: undefined,\n  onViewContact: undefined,\n  onCreateContact: undefined,\n  isLoggedContact: () => false,\n  isLogging: false,\n  disableClickToDial: false,\n  outboundSmsPermission: false,\n  internalSmsPermission: false,\n  disableLinks: false,\n  // webphoneAnswer: () => null,\n  // webphoneReject: () => null,\n  // webphoneHangup: () => null,\n  // webphoneResume: () => null,\n  enableContactFallback: undefined,\n  showContactDisplayPlaceholder: true,\n  autoLog: false,\n};\n"]}