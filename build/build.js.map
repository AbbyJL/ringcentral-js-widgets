{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/scripts/component.js","src/scripts/helpers/call-log-service.js","src/scripts/helpers/login-service.js","src/scripts/helpers/phone-service.js","src/scripts/helpers/rc-sdk.js","src/scripts/helpers/rc-webphone.js","src/scripts/index.js","src/scripts/w.js"],"names":[],"mappings":"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","file":"build.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","function register(globalSettings) {\n    /*\n     *\n     * [register process]\n     *\n     * generate actions _____\n     *                       |----> generate document --> [before, init, after] ----> generate handlers\n     * fetch template   _____|                                                  ----> maybe [before, render, after]\n     *\n     */\n    globalSettings = Object.assign({\n        actions: {},\n        handlers: {}\n    }, globalSettings);\n    ['init', 'render', 'remove', 'error'].forEach(action => {\n        globalSettings.actions[action] = Object.assign({\n            before: function() {},\n            method: function() {},\n            after: function() {},\n            error: function() {}\n        }, globalSettings.actions[action])\n    })\n\n\n    var Widget = function(options) {\n        console.warn(options.actions);\n        var options = Object.assign({\n            actions: {},\n            handlers: {}\n        }, options);\n        var settings = {\n            // For deep copy\n            actions: Object.assign({}, globalSettings.actions),\n            handlers: Object.assign({}, globalSettings.handlers)\n        }\n        if (!options.template) {\n            throw new Error('need a template');\n        }\n        this.props = {};\n        this.custom = {};\n        Object.keys(settings.actions).forEach(index => {\n            settings.actions[index] = bindScope(this, settings.actions[index]);\n        })\n        Object.keys(settings.handlers).forEach(index => {\n            settings.handlers[index] = bindScope(this, settings.handlers[index]);\n        })\n        Object.keys(options.actions).forEach(index => {\n            options.actions[index] = bindScope(this, options.actions[index]);\n        })\n        Object.keys(options.handlers).forEach(index => {\n            options.handlers[index] = bindScope(this, options.handlers[index]);\n        })\n        Object.keys(settings.actions).forEach(index => {\n            this[index] =\n                generateActions(settings.actions[index], options.actions[index], index);\n        })\n        this.props.dom = generateDocument(this, options.template);\n        this.props.template = options.template;\n        this.render =\n            generateActions({\n                before: settings.actions.render.before,\n                method: render.bind(this, settings.actions.render.method, this.props.template),\n                after: settings.actions.render.after\n            }, options.actions.render, 'render');\n        this.remove =\n            generateActions({\n                before: settings.actions.remove.before,\n                method: remove.bind(this, settings.actions.remove.method),\n                after: settings.actions.remove.after\n            }, options.actions.remove, 'remove');\n\n        function remove(widgetRemove) {\n            while (this.props.target.firstChild)\n                this.props.target.removeChild(this.props.target.firstChild)\n        }\n\n        function render(widgetRender, template, finish, target, callback) {\n            if (typeof target === 'string') {\n                target = document.querySelector(target);\n            } else if (target instanceof HTMLElement) {\n                target = target;\n            } else {\n                console.warn('first argument of render method should be selector string or dom');\n            }\n            target.appendChild(template);\n            this.props.target = target;\n            callback && typeof callback === 'function' && callback();\n            if (widgetRender && typeof widgetRender === 'function')\n                return widgetRender.call(this, finish);\n        }\n        this.init();\n        Object.keys(settings.handlers).forEach(index => {\n            if (options.handlers[index]) {\n                options.handlers[index].method.call(\n                    this,\n                    generateHandlers(settings.handlers[index], index)\n                );\n            }\n        })\n    };\n    return Widget;\n}\n\nfunction bindScope(scope, action) {\n    return {\n        before: action.before ? action.before.bind(scope) : function() {}.bind(scope),\n        method: action.method ? action.method.bind(scope) : function() {}.bind(scope),\n        after: action.after ? action.after.bind(scope) : function() {}.bind(scope),\n        error: action.error ? action.error.bind(scope) : function() {}.bind(scope)\n    }\n}\n\nfunction generateDocument(widget, template) {\n    var dom = {};\n    [].forEach.call(template.querySelectorAll('[data-info]'), doc => {\n        var info = doc.getAttribute('data-info');\n        dom[info] = doc;\n    });\n    [].forEach.call(template.querySelectorAll('[data-event]'), doc => {\n        var events = doc.getAttribute('data-event');\n        // TODO: proper error messages\n        events.split('|').forEach(event => {\n            var eventName;\n            var action;\n            event.split(':').forEach((token, index) => {\n                if (index === 0)\n                    eventName = token;\n                else if (index === 1)\n                    action = token;\n            })\n            if (!widget[action]) {\n                console.warn('No such method:' + action + ' in ' + events + ', check data-event and widget methods definition');\n                return;\n            }\n            doc.addEventListener(eventName, widget[action].bind(widget));\n        })\n    })\n    return dom;\n}\n\nfunction generateActions(widgetAction, userAction, name) {\n    if (!userAction) {\n        userAction = {\n            before: function() {},\n            method: function() {},\n            after: function() {},\n            error: function() {}\n        };\n        console.warn('Widget action [%s] is not defined by users', name);\n    }\n    return function(...args) {\n        var before = function(...args) {\n            console.info('[%s][before](' + [].concat(...args) + ')', name);\n            return wrapUserEvent(widgetAction.before, userAction.before, ...args);\n        }\n        var method = function(arg) {\n            console.info('[%s][method](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n            if (typeof arg === 'function') {\n                return widgetAction.method(userAction.method, ...arg()) || arg;\n            }\n            return widgetAction.method(userAction.method, arg) || arg;\n        };\n        var after = function(arg) {\n            console.info('[%s][after](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n            if (typeof arg === 'function') {\n                return wrapUserEvent(widgetAction.after, userAction.after, ...arg()) || arg;\n            }\n            return wrapUserEvent(widgetAction.after, userAction.after, arg) || arg;\n        }\n        var error = function(e) {\n            return wrapUserEvent(widgetAction.error, userAction.error, e);\n        }\n        var finish = function(arg) {\n            if (typeof arg === 'function') {\n                // flatten one level\n                return [].concat.apply([], arg());\n            }\n            return arg;\n        }\n        try {\n            before = before(...args);\n            if (isThennable(before)) {\n                return before.then(function(...args) {\n                    return method(arg);\n                }).then(function(arg) {\n                    return after(arg);\n                }).then(function(arg) {\n                    return finish(arg);\n                }).catch(error)\n            } else {\n                method = method(before);\n                if (isThennable(method)) {\n                    return method.then(function(arg) {\n                        return after(arg);\n                    }).then(function(arg) {\n                        return finish(arg);\n                    }).catch(error)\n                } else {\n                    after = after(method);\n                    if (isThennable(after)) {\n                        return after.then(function(arg) {\n                            return finish(arg);\n                        }).catch(error)\n                    } else {\n                        return finish(after);\n                    }\n                }\n            }\n        } catch (e) {\n            error(e);\n        }\n\n\n\n        // return Promise.resolve(wrapUserEvent(widgetAction.before, userAction.before, ...args))\n        //     .then(function(arg) {\n        //         console.info('[%s][method](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n        //         if (typeof arg === 'function') {\n        //             return widgetAction.method(userAction.method, ...arg()) || arg;\n        //         }\n        //         return widgetAction.method(userAction.method, arg) || arg;\n        //     })\n        //     .then(function(arg) {\n        //         console.info('[%s][after](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n        //         if (typeof arg === 'function') {\n        //             return wrapUserEvent(widgetAction.after, userAction.after, ...arg()) || arg;\n        //         }\n        //         return wrapUserEvent(widgetAction.after, userAction.after, arg) || arg;\n        //     })\n        //     .then(function(arg) {\n        //         if (typeof arg === 'function') {\n        //             // flatten one level\n        //             return [].concat.apply([], arg());\n        //         }\n        //         return arg;\n        //     })\n        //     .catch(err => console.error(err.stack));\n    }\n}\n\nfunction generateHandlers(widgetHandler, name) {\n    return function(...args) {\n        console.info('[%s][before](' + [].concat(...args) + ')', name);\n        return Promise.resolve(wrapUserEvent(widgetHandler.before, widgetHandler.before, ...args))\n            .then(function(arg) {\n                console.info('[%s][method](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n                if (typeof arg === 'function') {\n                    return widgetHandler.method(...arg()) || arg;\n                }\n                return widgetAction.method(arg) || arg;\n            })\n            .then(function(arg) {\n                console.info('[%s][after](' + (typeof arg === 'function' ? arg() : arg) + ')', name);\n                if (typeof arg === 'function') {\n                    return widgetHandler.after(...arg()) || arg;\n                }\n                return widgetHandler.after(arg) || arg;\n            })\n            .then(function(arg) {\n                if (typeof arg === 'function') {\n                    // flatten one level\n                    return [].concat.apply([], arg());\n                }\n                return arg;\n            })\n            .catch(err => console.error(err.stack));\n    }\n}\n\nfunction wrapUserEvent(widget, user, ...args) {\n    var continueDefault = !user || user(...args) || true;\n    if (continueDefault ||\n        typeof continueDefault === 'undefined' ||\n        continueDefault) {\n        if (widget) {\n            return widget(...args) || (() => args);\n        }\n        return null;\n    }\n    return [].concat(...args);\n}\n\nfunction isThennable(result) {\n    if (result.then && typeof result.then === 'function')\n        return true;\n    return false;\n}\n\nexport default register;\n","import sdk from './rc-sdk'\n\nvar CallLogService = (function(sdk){\n    return {\n        \n        getCallLogs:function(){\n            \n            return sdk.platform()\n                .get('/account/~/extension/~/call-log', { dateFrom:'2016-2-28' })\n                .then(response => {\n                    return response.json().records;\n                })\n                .catch(function(e) {\n                    console.error('Recent Calls Error: ' + e.message);\n                });\n            \n        } \n    };\n    \n})(sdk);\n\nexport default CallLogService;","import sdk from './rc-sdk'\n\nvar LoginService = function(sdk) {\n\n    var onLoginHandler = [];\n\n    return {\n        login: function(username, extension, password) {\n            console.log('LoginService -> start login');\n            return sdk.platform()\n                .login({\n                    'username': username,\n                    'extension': extension,\n                    'password': password\n                }).then(\n                    function() {\n                        onLoginHandler.forEach(handler => handler());\n                    }\n                )\n        },\n        checkLoginStatus: function() {\n            return sdk.platform().loggedIn().then(\n                function(isLoggedIn) {\n                    if (isLoggedIn) {\n                        onLoginHandler.forEach(handler => handler());\n                    }\n                    return isLoggedIn;\n                }\n            );\n        },\n        registerLoginHandler: function(handler) {\n            onLoginHandler.push(handler);\n        }\n\n    }\n\n}(sdk);\n\nexport default LoginService\n","import sdk from './rc-sdk'\nimport webPhone from './rc-webphone'\nimport LoginService from './login-service'\n\n\nvar PhoneService = function() {\n    var line;\n    var handlers = {\n        called: [],\n        callStarted: [],\n        callRejected: [],\n        callEnded: [],\n        callFailed: []\n    };\n\n    return {\n\n        registerSIP: function() {\n            return sdk.platform()\n                .post('/client-info/sip-provision', {\n                    sipInfo: [{\n                        transport: 'WSS'\n                    }]\n                })\n                .then(res => {\n                    var data = res.json();\n                    console.log(\"Sip Provisioning Data from RC API: \" + JSON.stringify(data));\n                    console.log(data.sipFlags.outboundCallsEnabled);\n                    var checkFlags = false;\n                    return webPhone.register(data, checkFlags)\n                        .then(function() {\n                            console.log('Registered');\n                        })\n                        .catch(function(e) {\n                            return Promise.reject(err);\n                        });\n\n                }).catch(e => console.error(e));\n        },\n\n        callout: function(fromNumber, toNumber) {\n            console.log('user callout');\n\n            // TODO: validate toNumber and fromNumber\n            if (!sdk || !webPhone) {\n                throw Error('Need to set up SDK and webPhone first.');\n                return;\n            }\n            return sdk.platform()\n                .get('/restapi/v1.0/account/~/extension/~')\n                .then(res => {\n                    console.log(res);\n                    var info = res.json();\n                    if (info && info.regionalSettings && info.regionalSettings.homeCountry) {\n                        return info.regionalSettings.homeCountry.id;\n                    }\n                    return null;\n                })\n                .then(countryId => {\n                    webPhone.call(toNumber, fromNumber, countryId);\n                })\n                .catch(e => console.error(e));\n        },\n        answer: function(props) {\n            return webPhone\n                .answer(line)\n                .catch(function(e) { console.error(e) });\n        },\n        ignore: function(props) {},\n        cancel: function(props) {\n            return line\n                .cancel()\n                .catch(function(e) { console.error(e) });\n        },\n        hangup: function(props) {\n            return webPhone\n                .hangup(line)\n                .catch(err => console.error(err));\n        },\n        called: function(handler) {\n            handlers.called.push(handler);\n        },\n        callStarted: function(handler) {\n            handlers.callStarted.push(handler);\n        },\n        callRejected: function(handler) {\n            handlers.callRejected.push(handler);\n        },\n        callEnded: function(handler) {\n            handlers.callEnded.push(handler);\n        },\n        callFailed: function(handler) {\n            handlers.callFailed.push(handler);\n        },\n        initPhoneListener: function(props) {\n            webPhone.ua.on('incomingCall', e => {\n                console.log(handlers);\n                line = e;\n                handlers.called.forEach(h => h(e));\n            });\n            webPhone.ua.on('callStarted', e => {\n                console.log(handlers);\n                console.log(this);\n                handlers.callStarted.forEach(h => h(e));\n            });\n            webPhone.ua.on('callRejected', e => {\n                console.log(handlers);\n                handlers.callRejected.forEach(h => h(e));\n            });\n            webPhone.ua.on('callEnded', e => {\n                console.log(handlers);\n                handlers.callEnded.forEach(h => h(e));\n            });\n            webPhone.ua.on('callFailed', e => {\n                console.log(handlers);\n                handlers.callFailed.forEach(h => h(e));\n            });\n        },\n\n    };\n\n\n}();\n\nexport default PhoneService\n","var sdk = new RingCentral.SDK({\n    appKey: '8mOtYiilT5OUPwwdeGgvpw',\n    appSecret: 'cqNn89RmR2SR76Kpp8xJaAdNzNOqR8Qfmjb0B-gDOHTw',\n    server: RingCentral.SDK.server.production\n});\n\nexport default sdk;\n","var webPhone = new RingCentral.WebPhone({\n    audioHelper: {\n        \n    }\n});\n\nexport default webPhone;","import sdk from './helpers/rc-sdk'\nimport webPhone from './helpers/rc-webphone'\nimport LoginService from './helpers/login-service'\nimport CallLogService from './helpers/call-log-service'\nimport PhoneService from './helpers/phone-service'\nimport w from './w'\n\nwindow.sdk = sdk;\nwindow.webPhone = webPhone;\nwindow.LoginService = LoginService;\nwindow.CallLogService = CallLogService;\nwindow.PhoneService = PhoneService;\nwindow.w = w;\nexport {\n    sdk,\n    webPhone,\n    LoginService,\n    CallLogService,\n    PhoneService\n}\n","import register from './component'\n\nfunction fetchWidget(name) {\n    return fetch(w.options.path + name + '.html')\n        .then(response => response.text())\n        .then(body => {\n            var template = document.createElement('template');\n            template.innerHTML = body;\n            var clone = document.importNode(template.content, true);\n            return clone;\n        })\n}\n\nfunction parseDocument(template) {\n    var docs = template.querySelectorAll('*');\n    return Promise.all(Array.from(docs).reduce(\n        (result, doc) => {\n            if (doc.localName.indexOf('-') > -1 || doc instanceof HTMLUnknownElement)\n                return result.concat(w.preload([doc.localName]));\n            return result;\n        }, []));\n}\n\nfunction initNestedWidget(widget) {\n    var template = widget.props.template;\n    var docs = template.querySelectorAll('*');\n    Array.from(docs).forEach(doc => {\n        if (doc.localName.indexOf('-') > -1 || doc instanceof HTMLUnknownElement) {\n            var child = w(doc.localName, widget.custom[doc.localName]);\n            child.render(doc);\n            // FIXME: When multiple child element, has problems\n            widget.props[doc.localName] = child;\n        }\n    })\n}\n\nfunction w(name, options) {\n    options = options || {};\n    var baseWidget;\n    if (!w.templates[name].widget) {\n        throw Error('you need to preload widget:' + name + ' before init it');\n    }\n    baseWidget = new w.templates[name].widget({\n        template: w.templates[name].template.cloneNode(true),\n        actions: options.actions || {},\n        handlers: options.handlers || {},\n    })\n    initNestedWidget(baseWidget);\n    // initWidget(baseWidget).forEach(child => {\n    //     baseWidget.props[child.name] = child.widget;\n    // });\n    return baseWidget;\n}\nw.templates = {};\nw.options = {\n    path: '/template/',\n    preload: [],\n}\nw.register = function(constructor) {\n    var settings = new constructor();\n    Object.keys(w.templates).forEach(index => {\n        var template = w.templates[index];\n        if (template.template && !template.widget)\n            template.widget = register(settings);\n    })\n};\nw.config = function(options) {\n    w.options = Object.assign(w.options, options);\n\n};\nw.preload = function(widgets, callback) {\n    return Promise.all(\n        widgets.reduce(\n            (result, name) => {\n                if (!w.templates[name]) {\n                    w.templates[name] = {};\n                }\n                if (!w.templates[name].fetch) {\n                    w.templates[name].fetch = fetchWidget(name);\n                }\n                return result.concat(\n                    w.templates[name].fetch\n                    .then(template => {\n                        if (!w.templates[name].template) {\n                            w.templates[name].template = template;\n                            // FIXME: script position\n                            var script = template.querySelector('script');\n                            document.body.appendChild(script);\n                            return template;\n                        }\n                    })\n                    .then(parseDocument)\n                    .catch(err => console.error(err)))\n            }, [])\n    ).then(callback)\n}\n\n// setting custom elements when registering widgets\nw.customize = function(context, target, options) {\n    context.custom[target] = options;\n}\n\nexport default w;\n"]}