{"version":3,"sources":["index.js","../services/rc-sdk.js","../services/rc-webphone.js","../services/phone-service.js","../services/login-service.js","../services/rc-subscription-service.js","../services/call-log-service.js","../services/account-service.js","../node_modules/lz-string/libs/lz-string.js","../services/rc-contact-service.js","../services/contact-search-service.js","../services/rc-contact-search-provider.js","../services/rc-message-service.js","../services/rc-message-provider.js","../services/rc-conference-service.js","../services/rc-conversation-service.js","rc-services.js","factory.js"],"names":["callLogService","phoneService","loginService"],"mappings":";;;;;;;;AAAA,SAAS,UAAT,CAAoB,EAApB,EAAwB,MAAxB,EAAgC;AAAE,WAAO,SAAS,EAAE,SAAS,EAAX,EAAT,EAA0B,GAAG,MAAH,EAAW,OAAO,OAAlB,CAA1B,EAAsD,OAAO,OAApE;AAA8E;;ACAhH,IAAI,MAAM,IAAI,YAAY,GAAhB,CAAoB;AAC1B,YAAQ,wBADkB;AAE1B,eAAW,8CAFe;AAG1B,YAAQ,YAAY,GAAZ,CAAgB,MAAhB,CAAuB;AAHL,CAApB,CAAV;;ACAA,IAAI,WAAW,IAAI,YAAY,QAAhB,CAAyB;AACpC,iBAAa;AADuB,CAAzB,CAAf;;ACGA,IAAI,eAAe,YAAW;AAC1B,QAAI,IAAJ;AACA,QAAI,WAAW;AACX,gBAAQ,EADG;AAEX,qBAAa,EAFF;AAGX,sBAAc,EAHH;AAIX,mBAAW,EAJA;AAKX,oBAAY;AALD,KAAf;AAOA,WAAO;AACH,qBAAa,uBAAW;AACpB,mBAAO,IAAI,QAAJ,GACF,IADE,CACG,4BADH,EACiC;AAChC,yBAAS,CAAC;AACN,+BAAW;AADL,iBAAD;AADuB,aADjC,EAMF,IANE,CAMG,eAAO;AACT,uBAAO,SAAS,QAAT,CAAkB,IAAI,IAAJ,EAAlB,EAA8B,KAA9B,EACF,KADE,CACI,UAAS,CAAT,EAAY;AACf,2BAAO,QAAQ,MAAR,CAAe,GAAf,CAAP;AACH,iBAHE,CAAP;AAIH,aAXE,CAAP;AAYH,SAdE;AAeH,iBAAS,iBAAS,UAAT,EAAqB,QAArB,EAA+B;;AAEpC,gBAAI,CAAC,GAAD,IAAQ,CAAC,QAAb,EAAuB;AACnB,sBAAM,MAAM,wCAAN,CAAN;AACA;AACH;AACD,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,qCADF,EAEF,IAFE,CAEG,eAAO;AACT,oBAAI,OAAO,IAAI,IAAJ,EAAX;AACA,oBAAI,QAAQ,KAAK,gBAAb,IAAiC,KAAK,gBAAL,CAAsB,WAA3D,EAAwE;AACpE,2BAAO,KAAK,gBAAL,CAAsB,WAAtB,CAAkC,EAAzC;AACH;AACD,uBAAO,IAAP;AACH,aARE,EASF,IATE,CASG,qBAAa;AACf,yBAAS,IAAT,CAAc,QAAd,EAAwB,UAAxB,EAAoC,SAApC;AACH,aAXE,CAAP;AAYH,SAjCE;AAkCH,gBAAQ,kBAAW;AACf,mBAAO,SACF,MADE,CACK,IADL,CAAP;AAEH,SArCE;AAsCH,gBAAQ,kBAAW,CAAE,CAtClB;AAuCH,gBAAQ,kBAAW;AACf,mBAAO,KACF,MADE,EAAP;AAEH,SA1CE;AA2CH,gBAAQ,kBAAW;AACf,mBAAO,SACF,MADE,CACK,IADL,CAAP;AAEH,SA9CE;AA+CH,YAAI,YAAS,IAAT,EAAe,OAAf,EAAwB;AACxB,qBAAS,IAAT,EAAe,IAAf,CAAoB,OAApB;AACH,SAjDE;AAkDH,gBAAQ,kBAAW;AACf,qBAAS,EAAT,CAAY,EAAZ,CAAe,cAAf,EAA+B,aAAK;AAChC,uBAAO,CAAP;AACA,yBAAS,MAAT,CAAgB,OAAhB,CAAwB;AAAA,2BAAK,EAAE,CAAF,CAAL;AAAA,iBAAxB;AACH,aAHD;AAIA,qBAAS,EAAT,CAAY,EAAZ,CAAe,aAAf,EAA8B,aAAK;AAC/B,yBAAS,WAAT,CAAqB,OAArB,CAA6B;AAAA,2BAAK,EAAE,CAAF,CAAL;AAAA,iBAA7B;AACH,aAFD;AAGA,qBAAS,EAAT,CAAY,EAAZ,CAAe,cAAf,EAA+B,aAAK;AAChC,yBAAS,YAAT,CAAsB,OAAtB,CAA8B;AAAA,2BAAK,EAAE,CAAF,CAAL;AAAA,iBAA9B;AACH,aAFD;AAGA,qBAAS,EAAT,CAAY,EAAZ,CAAe,WAAf,EAA4B,aAAK;AAC7B,yBAAS,SAAT,CAAmB,OAAnB,CAA2B;AAAA,2BAAK,EAAE,CAAF,CAAL;AAAA,iBAA3B;AACH,aAFD;AAGA,qBAAS,EAAT,CAAY,EAAZ,CAAe,YAAf,EAA6B,aAAK;AAC9B,yBAAS,UAAT,CAAoB,OAApB,CAA4B;AAAA,2BAAK,EAAE,CAAF,CAAL;AAAA,iBAA5B;AACH,aAFD;AAGH;AAnEE,KAAP;AAqEH,CA9EkB,EAAnB;;ACFA,IAAI,eAAe,UAAS,GAAT,EAAc;AAC7B,QAAI,iBAAiB,EAArB;AACA,WAAO;AACH,eAAO,eAAS,QAAT,EAAmB,SAAnB,EAA8B,QAA9B,EAAwC;AAC3C,mBAAO,IAAI,QAAJ,GACF,KADE,CACI;AACH,4BAAY,QADT;AAEH,6BAAa,SAFV;AAGH,4BAAY;AAHT,aADJ,CAAP;AAMH,SARE;AASH,gBAAQ,kBAAW;AACf,mBAAO,IAAI,QAAJ,GAAe,MAAf,EAAP;AACH,SAXE;AAYH,0BAAkB,4BAAW;AACzB,mBAAO,IAAI,QAAJ,GAAe,QAAf,GAA0B,IAA1B,CAA+B,UAAS,UAAT,EAAqB;AACvD,oBAAI,UAAJ,EAAgB;AACZ,mCAAe,OAAf,CAAuB;AAAA,+BAAW,SAAX;AAAA,qBAAvB;AACH;AACD,uBAAO,UAAP;AACH,aALM,CAAP;AAMH;;AAnBE,KAAP;AAsBH,CAxBkB,CAwBjB,GAxBiB,CAAnB;;ACCA,IAAI,iBAAiB,YAAW;;AAE5B,QAAI,WAAW,0BAAf;AACA,QAAI,eAAe,IAAI,wBAAJ,CAA6B,QAA7B,EAAuC,OAAvC,EAAnB;AACA,QAAI,WAAW,EAAf;AACA,iBAAa,EAAb,CAAgB,aAAa,MAAb,CAAoB,YAApC,EAAkD,UAAS,GAAT,EAAc;AAC5D,gBAAQ,GAAR,CAAY,oBAAZ;AACA,aAAK,IAAI,GAAT,IAAgB,QAAhB,EAA0B;AACtB,gBAAI,SAAS,cAAT,CAAwB,GAAxB,CAAJ,EAAkC;AAC9B,oBAAI,IAAI,KAAJ,CAAU,OAAV,CAAkB,GAAlB,IAAyB,CAAC,CAA9B,EAAiC;AAC7B,6BAAS,GAAT,EAAc,OAAd,CAAsB,aAAK;AACvB,4BAAI;AACA,8BAAE,GAAF;AACH,yBAFD,CAEE,OAAO,CAAP,EAAU;AACR,oCAAQ,KAAR,CAAc,uEAClB,IAAI,KADc,GACN,KADM,GACE,CADhB;AAEH;AACJ,qBAPD;AAQH;AACJ;AACJ;AACJ,KAhBD;;AAkBA,WAAO;AACH,mBAAW,mBAAS,MAAT,EAAiB,KAAjB,EAAwB,OAAxB,EAAiC;AACxC,gBAAI,SAAS,MAAb,EAAqB;AACjB,oBAAI,CAAC,SAAS,MAAT,CAAL,EAAuB;AACnB,6BAAS,MAAT,IAAmB,EAAnB;AACH;AACD,yBAAS,MAAT,EAAiB,IAAjB,CAAsB,OAAtB;AACA,6BAAa,eAAb,CAA6B,KAA7B,EAAoC,QAApC;AACH;AACJ;AATE,KAAP;AAWH,CAlCoB,EAArB;;ACCA,IAAI,iBAAkB,UAAS,GAAT,EAAc;AAChC,QAAI,SAAS,IAAI,EAAJ,GAAS,IAAT,GAAgB,IAA7B;AACA,QAAI,WAAW,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAc,MAAvB,CAAf;AACA,WAAO;AACH,qBAAa,uBAAW;AACpB,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,iCADF,EACqC,EAAC,UAAU,SAAS,WAAT,EAAX,EADrC,EAEF,IAFE,CAEG,oBAAY;AACd,uBAAO,SAAS,IAAT,GAAgB,OAAvB;AACH,aAJE,CAAP;AAKH,SAPE;AAQH,6BAAqB,6BAAS,WAAT,EAAsB,QAAtB,EAAgC,MAAhC,EAAwC;AACzD,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,iCADF,EACqC;AACpC,0BAAU,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,WAAW,IAAX,GAAkB,IAAxC,EAA8C,WAA9C,EAD0B;AAEpC,wBAAQ,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,CAAC,UAAU,CAAX,IAAgB,IAAhB,GAAuB,IAA7C,EAAmD,WAAnD,EAF4B;AAGpC;AAHoC,aADrC,EAMF,IANE,CAMG;AAAA,uBAAY,SAAS,IAAT,EAAZ;AAAA,aANH,EAOF,IAPE,CAOG;AAAA,uBAAQ,KAAK,OAAb;AAAA,aAPH,EAQF,IARE,CAQG;AAAA,uBAAW,QAAQ,OAAR,EAAX;AAAA,aARH,CAAP;AASH;AAlBE,KAAP;AAoBH,CAvBoB,CAuBlB,GAvBkB,CAArB;;ACFA,IAAI,iBAAkB,UAAS,GAAT,EAAc;AAChC,QAAI,IAAJ;AACA,QAAI,OAAJ;AACA,QAAI,eAAe,IAAnB;;AAEA,aAAS,gBAAT,CAA0B,OAA1B,EAAmC,IAAnC,EAAyC;AACrC,YAAI,CAAC,OAAL,EACQ,OAAO,MAAM,iEAAN,CAAP;AACR,eAAO,QACF,MADE,CACK;AAAA,mBAAU,OAAO,IAAP,KAAgB,IAA1B;AAAA,SADL,CAAP;AAEH;;AAED,aAAS,oBAAT,CAA8B,OAA9B,EAAuC,QAAvC,EAAiD;AAC7C,YAAI,CAAC,MAAM,OAAN,CAAc,QAAd,CAAL,EACI,WAAW,CAAC,QAAD,CAAX;;AAEJ,eAAO,QACF,MADE,CACK;AAAA,mBAAU,SAAS,MAAT,CAAgB;AAAA,uBAAK,OAAO,QAAP,CAAgB,OAAhB,CAAwB,CAAxB,IAA6B,CAAC,CAAnC;AAAA,aAAhB,EAAsD,MAAtD,GAA+D,CAAzE;AAAA,SADL,CAAP;AAEH;;AAED,WAAO;AACH,wBAAgB,0BAAW;AACvB,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,wBADF,EAEF,IAFE,CAEG,oBAAY;AACd,uBAAO,SAAS,IAAT,EAAP;AACA,uBAAO,IAAP;AACH,aALE,EAMF,KANE,CAMI;AAAA,uBAAK,QAAQ,KAAR,CAAc,yBAAyB,EAAE,OAAzC,CAAL;AAAA,aANJ,CAAP;AAOH,SATE;;AAWH,wBAAgB,0BAAW;AACvB,2BAAe,IAAI,QAAJ,GACV,GADU,CACN,qCADM,EAEV,IAFU,CAEL,oBAAY;AACd,oBAAI,OAAO,SAAS,IAAT,EAAX;AACA,0BAAU,KAAK,OAAf;AACA,+BAAe,IAAf;AACA,uBAAO,KAAK,OAAZ;AACH,aAPU,EAQV,KARU,CAQJ;AAAA,uBAAK,QAAQ,KAAR,CAAc,yBAAyB,EAAE,OAAzC,CAAL;AAAA,aARI,CAAf;AASA,mBAAO,YAAP;AACH,SAtBE;;AAwBH,2BAAmB,2BAAS,IAAT,EAAe;AAC9B,gBAAI,CAAC,IAAL,EACI,OAAO,MAAM,6DAAN,CAAP;AACJ,mBAAO,KAAK,eAAL,CACF,MADE,CACK;AAAA,uBAAW,QAAQ,WAAR,CAAoB,WAApB,OAAsC,KAAK,WAAL,EAAjD;AAAA,aADL,EAEF,MAFE,GAEO,CAFd;AAGH,SA9BE;;AAgCH,oBAAY,oBAAS,IAAT,EAA8B;AAAA,gBAAf,QAAe,yDAAJ,EAAI;;AACtC,gBAAI,YAAJ,EAAkB;AACd,uBAAO,aAAa,IAAb,CAAkB,YAAM;AAC3B,2BAAO,qBAAqB,iBAAiB,OAAjB,EAA0B,IAA1B,CAArB,EAAsD,QAAtD,EACF,GADE,CACE;AAAA,+BAAU,OAAO,WAAjB;AAAA,qBADF,CAAP;AAEH,iBAHM,CAAP;AAIH,aALD,MAKM;AACF,uBAAO,qBAAqB,iBAAiB,OAAjB,EAA0B,IAA1B,CAArB,EAAsD,QAAtD,EACF,GADE,CACE;AAAA,2BAAU,OAAO,WAAjB;AAAA,iBADF,CAAP;AAEH;AACJ;AA1CE,KAAP;AA4CH,CAhEoB,CAgElB,GAhEkB,CAArB;;APoPA,IAAI,WAAW,WAAW,UAAU,MAAV,EAAkB;;;;;;;;;;AQ5O5C,QAAI,WAAY,YAAW;;;AAG3B,YAAI,IAAI,OAAO,YAAf;AACA,YAAI,eAAe,mEAAnB;AACA,YAAI,gBAAgB,mEAApB;AACA,YAAI,iBAAiB,EAArB;;AAEA,iBAAS,YAAT,CAAsB,QAAtB,EAAgC,SAAhC,EAA2C;AACzC,gBAAI,CAAC,eAAe,QAAf,CAAL,EAA+B;AAC7B,+BAAe,QAAf,IAA2B,EAA3B;AACA,qBAAK,IAAI,IAAE,CAAX,EAAe,IAAE,SAAS,MAA1B,EAAmC,GAAnC,EAAwC;AACtC,mCAAe,QAAf,EAAyB,SAAS,MAAT,CAAgB,CAAhB,CAAzB,IAA+C,CAA/C;AACD;AACF;AACD,mBAAO,eAAe,QAAf,EAAyB,SAAzB,CAAP;AACD;;AAED,YAAI,WAAW;AACb,8BAAmB,0BAAU,KAAV,EAAiB;AAClC,oBAAI,SAAS,IAAb,EAAmB,OAAO,EAAP;AACnB,oBAAI,MAAM,SAAS,SAAT,CAAmB,KAAnB,EAA0B,CAA1B,EAA6B,UAAS,CAAT,EAAW;AAAC,2BAAO,aAAa,MAAb,CAAoB,CAApB,CAAP;AAA+B,iBAAxE,CAAV;AACA,wBAAQ,IAAI,MAAJ,GAAa,CAArB,G;AACA,4B;AACA,yBAAK,CAAL;AAAS,+BAAO,GAAP;AACT,yBAAK,CAAL;AAAS,+BAAO,MAAI,KAAX;AACT,yBAAK,CAAL;AAAS,+BAAO,MAAI,IAAX;AACT,yBAAK,CAAL;AAAS,+BAAO,MAAI,GAAX;AALT;AAOD,aAXY;;AAab,kCAAuB,8BAAU,KAAV,EAAiB;AACtC,oBAAI,SAAS,IAAb,EAAmB,OAAO,EAAP;AACnB,oBAAI,SAAS,EAAb,EAAiB,OAAO,IAAP;AACjB,uBAAO,SAAS,WAAT,CAAqB,MAAM,MAA3B,EAAmC,EAAnC,EAAuC,UAAS,KAAT,EAAgB;AAAE,2BAAO,aAAa,YAAb,EAA2B,MAAM,MAAN,CAAa,KAAb,CAA3B,CAAP;AAAyD,iBAAlH,CAAP;AACD,aAjBY;;AAmBb,6BAAkB,yBAAU,KAAV,EAAiB;AACjC,oBAAI,SAAS,IAAb,EAAmB,OAAO,EAAP;AACnB,uBAAO,SAAS,SAAT,CAAmB,KAAnB,EAA0B,EAA1B,EAA8B,UAAS,CAAT,EAAW;AAAC,2BAAO,EAAE,IAAE,EAAJ,CAAP;AAAgB,iBAA1D,IAA8D,GAArE;AACD,aAtBY;;AAwBb,iCAAqB,6BAAU,UAAV,EAAsB;AACzC,oBAAI,cAAc,IAAlB,EAAwB,OAAO,EAAP;AACxB,oBAAI,cAAc,EAAlB,EAAsB,OAAO,IAAP;AACtB,uBAAO,SAAS,WAAT,CAAqB,WAAW,MAAhC,EAAwC,KAAxC,EAA+C,UAAS,KAAT,EAAgB;AAAE,2BAAO,WAAW,UAAX,CAAsB,KAAtB,IAA+B,EAAtC;AAA2C,iBAA5G,CAAP;AACD,aA5BY;;;AA+Bb,kCAAsB,8BAAU,YAAV,EAAwB;AAC5C,oBAAI,aAAa,SAAS,QAAT,CAAkB,YAAlB,CAAjB;AACA,oBAAI,MAAI,IAAI,UAAJ,CAAe,WAAW,MAAX,GAAkB,CAAjC,CAAR,C;;AAEA,qBAAK,IAAI,IAAE,CAAN,EAAS,WAAS,WAAW,MAAlC,EAA0C,IAAE,QAA5C,EAAsD,GAAtD,EAA2D;AACzD,wBAAI,gBAAgB,WAAW,UAAX,CAAsB,CAAtB,CAApB;AACA,wBAAI,IAAE,CAAN,IAAW,kBAAkB,CAA7B;AACA,wBAAI,IAAE,CAAF,GAAI,CAAR,IAAa,gBAAgB,GAA7B;AACD;AACD,uBAAO,GAAP;AACD,aAzCY;;;AA4Cb,sCAAyB,kCAAU,UAAV,EAAsB;AAC7C,oBAAI,eAAa,IAAb,IAAqB,eAAa,SAAtC,EAAgD;AAC5C,2BAAO,SAAS,UAAT,CAAoB,UAApB,CAAP;AACH,iBAFD,MAEO;AACH,wBAAI,MAAI,IAAI,KAAJ,CAAU,WAAW,MAAX,GAAkB,CAA5B,CAAR,C;AACA,yBAAK,IAAI,IAAE,CAAN,EAAS,WAAS,IAAI,MAA3B,EAAmC,IAAE,QAArC,EAA+C,GAA/C,EAAoD;AAClD,4BAAI,CAAJ,IAAO,WAAW,IAAE,CAAb,IAAgB,GAAhB,GAAoB,WAAW,IAAE,CAAF,GAAI,CAAf,CAA3B;AACD;;AAED,wBAAI,SAAS,EAAb;AACA,wBAAI,OAAJ,CAAY,UAAU,CAAV,EAAa;AACvB,+BAAO,IAAP,CAAY,EAAE,CAAF,CAAZ;AACD,qBAFD;AAGA,2BAAO,SAAS,UAAT,CAAoB,OAAO,IAAP,CAAY,EAAZ,CAApB,CAAP;AAEH;AAEF,aA7DY;;;AAiEb,2CAA+B,uCAAU,KAAV,EAAiB;AAC9C,oBAAI,SAAS,IAAb,EAAmB,OAAO,EAAP;AACnB,uBAAO,SAAS,SAAT,CAAmB,KAAnB,EAA0B,CAA1B,EAA6B,UAAS,CAAT,EAAW;AAAC,2BAAO,cAAc,MAAd,CAAqB,CAArB,CAAP;AAAgC,iBAAzE,CAAP;AACD,aApEY;;;AAuEb,+CAAkC,2CAAU,KAAV,EAAiB;AACjD,oBAAI,SAAS,IAAb,EAAmB,OAAO,EAAP;AACnB,oBAAI,SAAS,EAAb,EAAiB,OAAO,IAAP;AACjB,wBAAQ,MAAM,OAAN,CAAc,IAAd,EAAoB,GAApB,CAAR;AACA,uBAAO,SAAS,WAAT,CAAqB,MAAM,MAA3B,EAAmC,EAAnC,EAAuC,UAAS,KAAT,EAAgB;AAAE,2BAAO,aAAa,aAAb,EAA4B,MAAM,MAAN,CAAa,KAAb,CAA5B,CAAP;AAA0D,iBAAnH,CAAP;AACD,aA5EY;;AA8Eb,sBAAU,kBAAU,YAAV,EAAwB;AAChC,uBAAO,SAAS,SAAT,CAAmB,YAAnB,EAAiC,EAAjC,EAAqC,UAAS,CAAT,EAAW;AAAC,2BAAO,EAAE,CAAF,CAAP;AAAa,iBAA9D,CAAP;AACD,aAhFY;AAiFb,uBAAW,mBAAU,YAAV,EAAwB,WAAxB,EAAqC,cAArC,EAAqD;AAC9D,oBAAI,gBAAgB,IAApB,EAA0B,OAAO,EAAP;AAC1B,oBAAI,CAAJ;oBAAO,KAAP;oBACI,qBAAoB,EADxB;oBAEI,6BAA4B,EAFhC;oBAGI,YAAU,EAHd;oBAII,aAAW,EAJf;oBAKI,YAAU,EALd;oBAMI,oBAAmB,CANvB;;AAOI,mCAAkB,CAPtB;oBAQI,kBAAiB,CARrB;oBASI,eAAa,EATjB;oBAUI,mBAAiB,CAVrB;oBAWI,wBAAsB,CAX1B;oBAYI,EAZJ;;AAcA,qBAAK,KAAK,CAAV,EAAa,KAAK,aAAa,MAA/B,EAAuC,MAAM,CAA7C,EAAgD;AAC9C,gCAAY,aAAa,MAAb,CAAoB,EAApB,CAAZ;AACA,wBAAI,CAAC,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,kBAArC,EAAwD,SAAxD,CAAL,EAAyE;AACvE,2CAAmB,SAAnB,IAAgC,kBAAhC;AACA,mDAA2B,SAA3B,IAAwC,IAAxC;AACD;;AAED,iCAAa,YAAY,SAAzB;AACA,wBAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,kBAArC,EAAwD,UAAxD,CAAJ,EAAyE;AACvE,oCAAY,UAAZ;AACD,qBAFD,MAEO;AACL,4BAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,0BAArC,EAAgE,SAAhE,CAAJ,EAAgF;AAC9E,gCAAI,UAAU,UAAV,CAAqB,CAArB,IAAwB,GAA5B,EAAiC;AAC/B,qCAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,uDAAoB,oBAAoB,CAAxC;AACA,wCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,gEAAwB,CAAxB;AACA,qDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,2DAAmB,CAAnB;AACD,qCAJD,MAIO;AACL;AACD;AACF;AACD,wCAAQ,UAAU,UAAV,CAAqB,CAArB,CAAR;AACA,qCAAK,IAAE,CAAP,EAAW,IAAE,CAAb,EAAiB,GAAjB,EAAsB;AACpB,uDAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,wCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,gEAAwB,CAAxB;AACA,qDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,2DAAmB,CAAnB;AACD,qCAJD,MAIO;AACL;AACD;AACD,4CAAQ,SAAS,CAAjB;AACD;AACF,6BAvBD,MAuBO;AACL,wCAAQ,CAAR;AACA,qCAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,uDAAoB,oBAAoB,CAArB,GAA0B,KAA7C;AACA,wCAAI,yBAAwB,cAAY,CAAxC,EAA2C;AACzC,gEAAwB,CAAxB;AACA,qDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,2DAAmB,CAAnB;AACD,qCAJD,MAIO;AACL;AACD;AACD,4CAAQ,CAAR;AACD;AACD,wCAAQ,UAAU,UAAV,CAAqB,CAArB,CAAR;AACA,qCAAK,IAAE,CAAP,EAAW,IAAE,EAAb,EAAkB,GAAlB,EAAuB;AACrB,uDAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,wCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,gEAAwB,CAAxB;AACA,qDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,2DAAmB,CAAnB;AACD,qCAJD,MAIO;AACL;AACD;AACD,4CAAQ,SAAS,CAAjB;AACD;AACF;AACD;AACA,gCAAI,qBAAqB,CAAzB,EAA4B;AAC1B,oDAAoB,KAAK,GAAL,CAAS,CAAT,EAAY,eAAZ,CAApB;AACA;AACD;AACD,mCAAO,2BAA2B,SAA3B,CAAP;AACD,yBAxDD,MAwDO;AACL,oCAAQ,mBAAmB,SAAnB,CAAR;AACA,iCAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,mDAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,oCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,4DAAwB,CAAxB;AACA,iDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,uDAAmB,CAAnB;AACD,iCAJD,MAIO;AACL;AACD;AACD,wCAAQ,SAAS,CAAjB;AACD;AAGF;AACD;AACA,4BAAI,qBAAqB,CAAzB,EAA4B;AAC1B,gDAAoB,KAAK,GAAL,CAAS,CAAT,EAAY,eAAZ,CAApB;AACA;AACD;;AAED,2CAAmB,UAAnB,IAAiC,kBAAjC;AACA,oCAAY,OAAO,SAAP,CAAZ;AACD;AACF;;;AAGD,oBAAI,cAAc,EAAlB,EAAsB;AACpB,wBAAI,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,0BAArC,EAAgE,SAAhE,CAAJ,EAAgF;AAC9E,4BAAI,UAAU,UAAV,CAAqB,CAArB,IAAwB,GAA5B,EAAiC;AAC/B,iCAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,mDAAoB,oBAAoB,CAAxC;AACA,oCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,4DAAwB,CAAxB;AACA,iDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,uDAAmB,CAAnB;AACD,iCAJD,MAIO;AACL;AACD;AACF;AACD,oCAAQ,UAAU,UAAV,CAAqB,CAArB,CAAR;AACA,iCAAK,IAAE,CAAP,EAAW,IAAE,CAAb,EAAiB,GAAjB,EAAsB;AACpB,mDAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,oCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,4DAAwB,CAAxB;AACA,iDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,uDAAmB,CAAnB;AACD,iCAJD,MAIO;AACL;AACD;AACD,wCAAQ,SAAS,CAAjB;AACD;AACF,yBAvBD,MAuBO;AACL,oCAAQ,CAAR;AACA,iCAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,mDAAoB,oBAAoB,CAArB,GAA0B,KAA7C;AACA,oCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,4DAAwB,CAAxB;AACA,iDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,uDAAmB,CAAnB;AACD,iCAJD,MAIO;AACL;AACD;AACD,wCAAQ,CAAR;AACD;AACD,oCAAQ,UAAU,UAAV,CAAqB,CAArB,CAAR;AACA,iCAAK,IAAE,CAAP,EAAW,IAAE,EAAb,EAAkB,GAAlB,EAAuB;AACrB,mDAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,oCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,4DAAwB,CAAxB;AACA,iDAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,uDAAmB,CAAnB;AACD,iCAJD,MAIO;AACL;AACD;AACD,wCAAQ,SAAS,CAAjB;AACD;AACF;AACD;AACA,4BAAI,qBAAqB,CAAzB,EAA4B;AAC1B,gDAAoB,KAAK,GAAL,CAAS,CAAT,EAAY,eAAZ,CAApB;AACA;AACD;AACD,+BAAO,2BAA2B,SAA3B,CAAP;AACD,qBAxDD,MAwDO;AACL,gCAAQ,mBAAmB,SAAnB,CAAR;AACA,6BAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,+CAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,gCAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,wDAAwB,CAAxB;AACA,6CAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,mDAAmB,CAAnB;AACD,6BAJD,MAIO;AACL;AACD;AACD,oCAAQ,SAAS,CAAjB;AACD;AAGF;AACD;AACA,wBAAI,qBAAqB,CAAzB,EAA4B;AAC1B,4CAAoB,KAAK,GAAL,CAAS,CAAT,EAAY,eAAZ,CAApB;AACA;AACD;AACF;;;AAGD,wBAAQ,CAAR;AACA,qBAAK,IAAE,CAAP,EAAW,IAAE,eAAb,EAA+B,GAA/B,EAAoC;AAClC,uCAAoB,oBAAoB,CAArB,GAA2B,QAAM,CAApD;AACA,wBAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,gDAAwB,CAAxB;AACA,qCAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA,2CAAmB,CAAnB;AACD,qBAJD,MAIO;AACL;AACD;AACD,4BAAQ,SAAS,CAAjB;AACD;;;AAGD,uBAAO,IAAP,EAAa;AACX,uCAAoB,oBAAoB,CAAxC;AACA,wBAAI,yBAAyB,cAAY,CAAzC,EAA4C;AAC1C,qCAAa,IAAb,CAAkB,eAAe,gBAAf,CAAlB;AACA;AACD,qBAHD,MAIK;AACN;AACD,uBAAO,aAAa,IAAb,CAAkB,EAAlB,CAAP;AACD,aAxSY;;AA0Sb,wBAAY,oBAAU,UAAV,EAAsB;AAChC,oBAAI,cAAc,IAAlB,EAAwB,OAAO,EAAP;AACxB,oBAAI,cAAc,EAAlB,EAAsB,OAAO,IAAP;AACtB,uBAAO,SAAS,WAAT,CAAqB,WAAW,MAAhC,EAAwC,KAAxC,EAA+C,UAAS,KAAT,EAAgB;AAAE,2BAAO,WAAW,UAAX,CAAsB,KAAtB,CAAP;AAAsC,iBAAvG,CAAP;AACD,aA9SY;;AAgTb,yBAAa,qBAAU,MAAV,EAAkB,UAAlB,EAA8B,YAA9B,EAA4C;AACvD,oBAAI,aAAa,EAAjB;oBACI,IADJ;oBAEI,YAAY,CAFhB;oBAGI,WAAW,CAHf;oBAII,UAAU,CAJd;oBAKI,QAAQ,EALZ;oBAMI,SAAS,EANb;oBAOI,CAPJ;oBAQI,CARJ;oBASI,IATJ;oBASU,IATV;oBASgB,QAThB;oBAS0B,KAT1B;oBAUI,CAVJ;oBAWI,OAAO,EAAC,KAAI,aAAa,CAAb,CAAL,EAAsB,UAAS,UAA/B,EAA2C,OAAM,CAAjD,EAXX;;AAaA,qBAAK,IAAI,CAAT,EAAY,IAAI,CAAhB,EAAmB,KAAK,CAAxB,EAA2B;AACzB,+BAAW,CAAX,IAAgB,CAAhB;AACD;;AAED,uBAAO,CAAP;AACA,2BAAW,KAAK,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACA,wBAAM,CAAN;AACA,uBAAO,SAAO,QAAd,EAAwB;AACtB,2BAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,yBAAK,QAAL,KAAkB,CAAlB;AACA,wBAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,6BAAK,QAAL,GAAgB,UAAhB;AACA,6BAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,4BAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,8BAAU,CAAV;AACD;;AAED,wBAAQ,OAAO,IAAf;AACE,yBAAK,CAAL;AACI,+BAAO,CAAP;AACA,mCAAW,KAAK,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACA,gCAAM,CAAN;AACA,+BAAO,SAAO,QAAd,EAAwB;AACtB,mCAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,iCAAK,QAAL,KAAkB,CAAlB;AACA,gCAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,qCAAK,QAAL,GAAgB,UAAhB;AACA,qCAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,oCAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,sCAAU,CAAV;AACD;AACH,4BAAI,EAAE,IAAF,CAAJ;AACA;AACF,yBAAK,CAAL;AACI,+BAAO,CAAP;AACA,mCAAW,KAAK,GAAL,CAAS,CAAT,EAAW,EAAX,CAAX;AACA,gCAAM,CAAN;AACA,+BAAO,SAAO,QAAd,EAAwB;AACtB,mCAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,iCAAK,QAAL,KAAkB,CAAlB;AACA,gCAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,qCAAK,QAAL,GAAgB,UAAhB;AACA,qCAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,oCAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,sCAAU,CAAV;AACD;AACH,4BAAI,EAAE,IAAF,CAAJ;AACA;AACF,yBAAK,CAAL;AACE,+BAAO,EAAP;AAlCJ;AAoCA,2BAAW,CAAX,IAAgB,CAAhB;AACA,oBAAI,CAAJ;AACA,uBAAO,IAAP,CAAY,CAAZ;AACA,uBAAO,IAAP,EAAa;AACX,wBAAI,KAAK,KAAL,GAAa,MAAjB,EAAyB;AACvB,+BAAO,EAAP;AACD;;AAED,2BAAO,CAAP;AACA,+BAAW,KAAK,GAAL,CAAS,CAAT,EAAW,OAAX,CAAX;AACA,4BAAM,CAAN;AACA,2BAAO,SAAO,QAAd,EAAwB;AACtB,+BAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,6BAAK,QAAL,KAAkB,CAAlB;AACA,4BAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,iCAAK,QAAL,GAAgB,UAAhB;AACA,iCAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,gCAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,kCAAU,CAAV;AACD;;AAED,4BAAQ,IAAI,IAAZ;AACE,6BAAK,CAAL;AACE,mCAAO,CAAP;AACA,uCAAW,KAAK,GAAL,CAAS,CAAT,EAAW,CAAX,CAAX;AACA,oCAAM,CAAN;AACA,mCAAO,SAAO,QAAd,EAAwB;AACtB,uCAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,qCAAK,QAAL,KAAkB,CAAlB;AACA,oCAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,yCAAK,QAAL,GAAgB,UAAhB;AACA,yCAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,wCAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,0CAAU,CAAV;AACD;;AAED,uCAAW,UAAX,IAAyB,EAAE,IAAF,CAAzB;AACA,gCAAI,WAAS,CAAb;AACA;AACA;AACF,6BAAK,CAAL;AACE,mCAAO,CAAP;AACA,uCAAW,KAAK,GAAL,CAAS,CAAT,EAAW,EAAX,CAAX;AACA,oCAAM,CAAN;AACA,mCAAO,SAAO,QAAd,EAAwB;AACtB,uCAAO,KAAK,GAAL,GAAW,KAAK,QAAvB;AACA,qCAAK,QAAL,KAAkB,CAAlB;AACA,oCAAI,KAAK,QAAL,IAAiB,CAArB,EAAwB;AACtB,yCAAK,QAAL,GAAgB,UAAhB;AACA,yCAAK,GAAL,GAAW,aAAa,KAAK,KAAL,EAAb,CAAX;AACD;AACD,wCAAQ,CAAC,OAAK,CAAL,GAAS,CAAT,GAAa,CAAd,IAAmB,KAA3B;AACA,0CAAU,CAAV;AACD;AACD,uCAAW,UAAX,IAAyB,EAAE,IAAF,CAAzB;AACA,gCAAI,WAAS,CAAb;AACA;AACA;AACF,6BAAK,CAAL;AACE,mCAAO,OAAO,IAAP,CAAY,EAAZ,CAAP;AAvCJ;;AA0CA,wBAAI,aAAa,CAAjB,EAAoB;AAClB,oCAAY,KAAK,GAAL,CAAS,CAAT,EAAY,OAAZ,CAAZ;AACA;AACD;;AAED,wBAAI,WAAW,CAAX,CAAJ,EAAmB;AACjB,gCAAQ,WAAW,CAAX,CAAR;AACD,qBAFD,MAEO;AACL,4BAAI,MAAM,QAAV,EAAoB;AAClB,oCAAQ,IAAI,EAAE,MAAF,CAAS,CAAT,CAAZ;AACD,yBAFD,MAEO;AACL,mCAAO,IAAP;AACD;AACF;AACD,2BAAO,IAAP,CAAY,KAAZ;;;AAGA,+BAAW,UAAX,IAAyB,IAAI,MAAM,MAAN,CAAa,CAAb,CAA7B;AACA;;AAEA,wBAAI,KAAJ;;AAEA,wBAAI,aAAa,CAAjB,EAAoB;AAClB,oCAAY,KAAK,GAAL,CAAS,CAAT,EAAY,OAAZ,CAAZ;AACA;AACD;AAEF;AACF;AAhdY,SAAf;AAkdE,eAAO,QAAP;AACD,KArec,EAAf;;AAueA,QAAI,OAAO,MAAP,KAAkB,UAAlB,IAAgC,OAAO,GAA3C,EAAgD;AAC9C,eAAO,YAAY;AAAE,mBAAO,QAAP;AAAkB,SAAvC;AACD,KAFD,MAEO,IAAI,OAAO,MAAP,KAAkB,WAAlB,IAAiC,UAAU,IAA/C,EAAsD;AAC3D,eAAO,OAAP,GAAiB,QAAjB;AACD;ARuPA,CAtfc,CAAf;;AAwfA,IAAI,WAAY,YAAY,QAAO,QAAP,yCAAO,QAAP,OAAoB,QAAhC,IAA4C,aAAa,QAAzD,GAAoE,SAAS,SAAT,CAApE,GAA0F,QAA1G;;AS1uBA,IAAI,mBAAmB,UAAS,GAAT,EAAc;AACjC,QAAI,kBAAkB,EAAtB;AACA,QAAI,0BAA0B,IAA9B;;AAEA,QAAI,0BAA0B,IAA9B;AACA,QAAI,kCAAkC,IAAtC;;AAEA,aAAS,OAAT,GAAmB;AACf,aAAK,SAAL,GAAiB,IAAjB;AACA,aAAK,QAAL,GAAgB,IAAhB;AACA,aAAK,WAAL,GAAmB,IAAnB;AACA,aAAK,SAAL,GAAiB,IAAjB;AACA,aAAK,KAAL,GAAa,IAAb;AACA,aAAK,IAAL,GAAY,IAAZ;AACA,aAAK,EAAL,GAAU,IAAV;AACA,aAAK,WAAL,GAAmB,EAAnB;AACH;;AAED,aAAS,aAAT,CAAuB,SAAvB,EAAkC;AAC9B,YAAI,UAAU,IAAI,OAAJ,EAAd;AACA,gBAAQ,SAAR,GAAoB,UAAU,eAA9B;AACA,gBAAQ,SAAR,GAAoB,UAAU,OAAV,CAAkB,SAAtC;AACA,gBAAQ,QAAR,GAAmB,UAAU,OAAV,CAAkB,QAArC;AACA,gBAAQ,WAAR,GAAsB,QAAQ,SAAR,GAAoB,GAApB,GAA0B,QAAQ,QAAxD;AACA,gBAAQ,KAAR,GAAgB,UAAU,OAAV,CAAkB,KAAlC;AACA,gBAAQ,IAAR,GAAe,IAAf;AACA,gBAAQ,EAAR,GAAc,UAAU,EAAxB;AACA,gBAAQ,YAAR,GAAuB,UAAU,YAAV,CAAuB,GAA9C;AACA,eAAO,OAAP;AACH;;AAED,aAAS,mBAAT,CAA6B,QAA7B,EAAuC;AACnC,YAAI,UAAU,SAAS,IAAT,GAAgB,OAAhB,CACV,MADU,CACH;AAAA,mBACH,UAAU,MAAV,KAAqB,SAArB,IACA,CAAC,aAAD,EAAgB,MAAhB,EAAwB,OAAxB,CAAgC,UAAU,IAA1C,KAAmD,CAFhD;AAAA,SADG,EAIV,GAJU,CAIN;AAAA,mBAAa,cAAc,SAAd,CAAb;AAAA,SAJM,CAAd;AAKA,wBAAgB,IAAhB,CAAqB,KAArB,CAA2B,eAA3B,EAA4C,OAA5C;AACH;;AAED,aAAS,yBAAT,CAAmC,IAAnC,EAAyC;AACrC,eAAO,IAAI,QAAJ,GAAe,GAAf,CAAmB,uBAAnB,EAA4C,EAAC,SAAS,GAAV,EAAe,MAAM,IAArB,EAA5C,CAAP;AACH;;AAED,aAAS,+BAAT,CAAyC,IAAzC,EAA+C;AAC3C,eAAO,IAAI,QAAJ,GAAe,GAAf,CAAmB,yBAAnB,EAA8C,EAAC,SAAS,GAAV,EAAe,MAAM,IAArB,EAA9C,CAAP;AACH;;AAED,aAAS,oBAAT,GAAgC;AAC5B,YAAI,OAAO,CAAX;AACA,kCAA0B,0BAA0B,IAA1B,EACrB,IADqB,CAChB,UAAS,QAAT,EAAmB;AACrB,gBAAI,UAAU,SAAS,IAAT,EAAd;AACA,gBAAI,QAAQ,MAAR,IAAkB,QAAQ,MAAR,CAAe,UAAf,GAA4B,IAAlD,EAAwD;AACpD,oBAAI,WAAW,EAAf;AACA,uBAAO,QAAQ,MAAR,CAAe,UAAf,GAA4B,IAAnC,EAAyC;AACrC;AACA,6BAAS,IAAT,CAAc,0BAA0B,IAA1B,CAAd;AACH;;AAED,uBAAO,QAAQ,GAAR,CAAY,QAAZ,EAAsB,IAAtB,CAA2B,qBAAY;AAC1C,8BAAU,OAAV,CAAkB,UAAS,QAAT,EAAmB;AACjC,4CAAoB,QAApB;AACH,qBAFD;AAGA,8CAA0B,IAA1B;AACA,2BAAO,eAAP;AACH,iBANM,CAAP;AAOH,aAdD,MAcM;AACF,oCAAoB,QAApB;AACA,uBAAO,eAAP;AACH;AACJ,SArBqB,EAqBnB,KArBmB,CAqBb,UAAS,CAAT,EAAY;AACjB,oBAAQ,KAAR,CAAc,CAAd;AACH,SAvBqB,CAA1B;AAwBA,eAAO,uBAAP;AACH;;AAED,aAAS,yBAAT,GAAqC;AACjC,YAAI,OAAO,CAAX;AACA,eAAO,gCAAgC,IAAhC,EACN,IADM,CACD,oBAAY;AACd,gBAAI,UAAU,SAAS,IAAT,EAAd;AACA,gBAAI,QAAQ,MAAR,IAAkB,QAAQ,MAAR,CAAe,UAAf,GAA4B,IAAlD,EAAwD;AACpD,oBAAI,WAAW,EAAf;AACA,uBAAO,QAAQ,MAAR,CAAe,UAAf,GAA4B,IAAnC,EAAyC;AACrC;AACA,6BAAS,IAAT,CAAc,gCAAgC,IAAhC,CAAd;AACH;;AAED,uBAAO,QAAQ,GAAR,CAAY,QAAZ,EAAsB,IAAtB,CAA2B,qBAAa;AAC3C,wBAAI,UAAU,EAAd;AACA,8BAAU,OAAV,CAAkB,oBAAY;AAC1B,4BAAI,OAAO,SAAS,IAAT,EAAX;AACA,6BAAK,OAAL,CAAa,OAAb,CAAqB,cAAM;AACvB,gCAAI,GAAG,SAAH,IAAgB,GAAG,SAAH,CAAa,eAAjC,EAAkD;AAC9C,oCAAI,CAAC,QAAQ,GAAG,SAAH,CAAa,eAArB,CAAL,EAA4C;AACxC,4CAAQ,GAAG,SAAH,CAAa,eAArB,IAAwC,EAAxC;AACH;;AAED,wCAAQ,GAAG,SAAH,CAAa,eAArB,EAAsC,IAAtC,CAA2C,EAA3C;AACH;AACJ,yBARD;AASH,qBAXD;AAYA,oCAAgB,OAAhB,CAAwB,mBAAW;AAC/B,4BAAI,SAAS,QAAQ,QAAQ,SAAhB,CAAb;AACA,4BAAI,MAAJ,EAAY;AACR,mCAAO,OAAP,CAAe,iBAAS;AACpB,wCAAQ,WAAR,CAAoB,IAApB,CAAyB,MAAM,WAA/B;AACH,6BAFD;AAGH;AACJ,qBAPD;AAQH,iBAtBM,CAAP;AAuBH;AACJ,SAlCM,CAAP;AAmCH;;AAED,WAAO;AACH,YAAI,eAAJ,GAAsB;AAClB,mBAAO,eAAP;AACH,SAHE;AAIH,gCAAwB,kCAAW;AAC/B,gBAAI,uBAAJ,EAA6B;AACzB,uBAAO,uBAAP;AACH,aAFD,MAEM;AACF,uBAAO,QAAQ,OAAR,CAAgB,eAAhB,CAAP;AACH;AACJ,SAVE;AAWH,4BAAoB,8BAAW;AAC3B,4BAAgB,MAAhB,GAAyB,CAAzB;AACA;AACA;AACH,SAfE;AAgBH,gCAAwB,kCAAW;AAC/B,gBAAI,uBAAJ,EACI,OAAO,QAAQ,OAAR,CAAgB,uBAAhB,CAAP;AACJ,gBAAI,+BAAJ,EACI,OAAO,+BAAP;AACJ,8CAAkC,uBAAuB,IAAvB,CAA4B,yBAA5B,CAAlC;AACA,mBAAO,gCAAgC,IAAhC,CAAqC,YAAM;AAC9C,0CAA0B,eAA1B;AACA,kDAAkC,IAAlC;AACA,uBAAO,eAAP;AACH,aAJM,CAAP;AAKH,SA3BE;AA4BH,uBAAgB,YAAW;AACvB,gBAAI,UAAU,IAAd;AACA,gBAAI,OAAO,aAAa,OAAb,CAAqB,aAArB,CAAX;AACA,gBAAI,KAAJ;;;AAGA,mBAAO,YAAW;AACd,oBAAI,KAAJ;;;;;;;;;;;;AAYA,oBAAI,OAAJ,EAAa;AACT,4BAAQ,IAAR,CAAa,iBAAS;AAClB,kDAA0B,kBAAkB,KAA5C;AACH,qBAFD;AAGA,2BAAO,OAAP;AACH;AACD,yBAAS,0BAA0B,kBAAkB,KAAK,KAAL,CAAW,SAAS,mBAAT,CAA6B,IAA7B,CAAX,CAArD;AACA,0BAAU,OAAM,QAAQ,OAAR,CAAgB,KAAK,KAAL,CAAW,SAAS,mBAAT,CAA6B,IAA7B,CAAX,CAAhB,CAAN,GAAuE,KAAjF;AACA,uBAAO,OAAP;AACH,aAtBD;AAuBH,SA7Be;AA5Bb,KAAP;AA2DH,CA/KsB,CA+KrB,GA/KqB,CAAvB;;ACHA,IAAI,uBAAwB,YAAW;AACnC,QAAI,kBAAkB,EAAtB;AACA,QAAI,yBAAyB,EAA7B;;AAEA,aAAS,YAAT,CAAsB,IAAtB,EAA4B;AACxB,eAAO;AACH,kBAAM,KAAK,IADR;AAEH,mBAAO,KAAK,KAFT;AAGH,kBAAM,KAAK,IAHR;AAIH,gBAAI,KAAK;AAJN,SAAP;AAMH;AACD,WAAO;AACH,eAAO,eAAS,eAAT,EAA0B,MAA1B,EAAkC;AACrC,mBAAO,QAAQ,GAAR,CAAY,eAAZ,EAA6B,IAA7B,CAAkC,mBAAW;AAChD,oBAAI,oBAAoB,EAAxB;AACA,oBAAI,gBAAgB,EAApB;AACA,wBAAQ,OAAR,CAAgB,kBAAU;AACtB,2BAAO,OAAP,CAAe,gBAAQ;AACnB,4BAAI,MAAJ,EAAY;AACR,gCAAI,OAAO,IAAP,CAAJ,EAAkB;AACd,oCAAI,MAAM,KAAK,IAAL,GAAY,KAAK,KAA3B;AACA,oCAAI,CAAC,kBAAkB,GAAlB,CAAL,EAA6B;AACzB,wCAAI,YAAY,aAAa,IAAb,CAAhB;AACA,sDAAkB,GAAlB,IAAyB,SAAzB;AACA,kDAAc,IAAd,CAAmB,SAAnB;AACH;AACJ;AACJ,yBATD,MASO;AACH,gCAAI,MAAM,KAAK,IAAL,GAAY,KAAK,KAA3B;AACA,gCAAI,CAAC,kBAAkB,GAAlB,CAAL,EAA6B;AACzB,oCAAI,YAAY,aAAa,IAAb,CAAhB;AACA,kDAAkB,GAAlB,IAAyB,SAAzB;AACA,8CAAc,IAAd,CAAmB,SAAnB;AACH;AACJ;AACJ,qBAlBD;AAmBH,iBApBD;AAqBA,uBAAO,aAAP;AACH,aAzBM,CAAP;AA0BH;AA5BE,KAAP;AA8BH,CA1C0B,EAA3B;;ACCA,IAAI,0BAA0B,YAAW;AACrC,WAAO;AACH,gBAAQ,gBAAS,IAAT,EAAe;AACnB,gBAAI,UAAU,EAAd;AACA,gBAAI,IAAJ,EAAU;AACN,uBAAO,KAAK,WAAL,EAAP;AACA,iCAAiB,eAAjB,CAAiC,GAAjC,CAAqC,mBAAW;AAC5C,wBAAI,QAAQ,WAAR,IAAuB,QAAQ,WAAR,CAAoB,WAApB,GAAkC,OAAlC,CAA0C,IAA1C,KAAmD,CAA9E,EAAiF;AAC7E,gCAAQ,IAAR,CAAa;AACT,kCAAM,QAAQ,WADL;AAET,mCAAO,QAAQ,SAFN;AAGT,kCAAM,IAHG;AAIT,gCAAI,QAAQ;AAJH,yBAAb;AAMA,gCAAQ,WAAR,CAAoB,OAApB,CAA4B,iBAAS;AACjC,oCAAQ,IAAR,CAAa;AACT,sCAAM,QAAQ,WADL;AAET,uCAAO,KAFE;AAGT,sCAAM,IAHG;AAIT,oCAAI,QAAQ;AAJH,6BAAb;AAMH,yBAPD;AAQH,qBAfD,MAeO;AACH,4BAAI,QAAQ,SAAR,IAAqB,QAAQ,SAAR,CAAkB,OAAlB,CAA0B,IAA1B,KAAmC,CAA5D,EAA+D;AAC3D,oCAAQ,IAAR,CAAa;AACT,sCAAM,QAAQ,WADL;AAET,uCAAO,QAAQ,SAFN;AAGT,sCAAM,IAHG;AAIT,oCAAI,QAAQ;AAJH,6BAAb;AAMH;;AAED,gCAAQ,WAAR,CAAoB,OAApB,CAA4B,iBAAS;AACjC,gCAAI,MAAM,OAAN,CAAc,IAAd,KAAuB,CAA3B,EAA8B;AAC1B,wCAAQ,IAAR,CAAa;AACT,0CAAM,QAAQ,WADL;AAET,2CAAO,KAFE;AAGT,0CAAM,IAHG;AAIT,wCAAI,QAAQ;AAJH,iCAAb;AAMH;AACJ,yBATD;AAUH;AACJ,iBArCD;AAsCH;;AAED,mBAAO,OAAP;AACH,SA9CE;AA+CH,mBAAW,qBAAW;AAClB,mBAAO,iBAAiB,sBAAjB,GAA0C,IAA1C,CAA+C,2BAAmB;AACrE,uBAAO,gBAAgB,GAAhB,CAAoB,mBAAW;AAClC,2BAAO;AACH,8BAAM,QAAQ,WADX;AAEH,8BAAM,IAFH;AAGH,4BAAI,QAAQ;AAHT,qBAAP;AAKH,iBANM,CAAP;AAOH,aARM,EAQJ,KARI,CAQE;AAAA,uBAAK,QAAQ,KAAR,CAAc,CAAd,CAAL;AAAA,aARF,CAAP;AASH;AAzDE,KAAP;AA2DH,CA5D6B,EAA9B;;ACEA,IAAI,mBAAmB,UAAS,GAAT,EAAc;AACjC,QAAI,WAAW,EAAf;AACA,QAAI,kBAAkB,IAAtB;AACA,QAAI,YAAY,IAAhB;AACA,QAAI,wBAAwB,EAA5B;;AAEA,aAAS,gBAAT,CAA0B,IAA1B,EAAgC;AAC5B,eAAO,IAAI,QAAJ,GAAe,GAAf,CAAmB,qCAAnB,EAA0D;AAC7D,sBAAU,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,OAAO,IAAP,GAAc,IAApC,EAA0C,WAA1C,EADmD;AAE7D,sBAAU;AAFmD,SAA1D,EAGJ,IAHI,CAGC,qBAAa;AACjB,gBAAI,eAAe,UAAU,IAAV,EAAnB;AACA,wBAAY,aAAa,QAAb,CAAsB,SAAlC;AACA,gBAAI,UAAU,aAAa,OAA3B;AACA,6BAAiB,OAAjB;AACA,8BAAkB,IAAlB;AACA,mBAAO,OAAP;AACH,SAVM,CAAP;AAWH;;AAED,aAAS,uBAAT,GAAmC;AAC/B,YAAI,SAAJ,EAAe;AACX,mBAAO,IAAI,QAAJ,GAAe,GAAf,CAAmB,qCAAnB,EAA0D;AAC7D,0BAAU,OADmD;AAE7D,2BAAW;AAFkD,aAA1D,EAGJ,IAHI,CAGC,qBAAa;AACjB,oBAAI,eAAe,UAAU,IAAV,EAAnB;AACA,oBAAI,UAAU,aAAa,OAA3B;AACA,4BAAY,aAAa,QAAb,CAAsB,SAAlC;AACA,kCAAkB,OAAlB;AACA,sCAAsB,OAAtB,CAA8B;AAAA,2BAAK,EAAE,OAAF,CAAL;AAAA,iBAA9B;AACH,aATM,CAAP;AAUH;AACJ;;AAED,aAAS,cAAT,GAA0B;AACtB,YAAI,UAAU,EAAd;AACA,aAAK,IAAI,GAAT,IAAgB,QAAhB,EAA0B;AACtB,gBAAI,SAAS,cAAT,CAAwB,GAAxB,CAAJ,EAAkC;AAC9B,0BAAU,QAAQ,MAAR,CAAe,SAAS,GAAT,CAAf,CAAV;AACH;AACJ;AACD,eAAO,OAAP;AACH;;AAED,aAAS,gBAAT,CAA0B,OAA1B,EAAmC;AAC/B,gBAAQ,OAAR,CAAgB,mBAAW;AACvB,gBAAI,CAAC,SAAS,QAAQ,IAAjB,CAAL,EAA6B;AACzB,yBAAS,QAAQ,IAAjB,IAAyB,EAAzB;AACH;AACD,qBAAS,QAAQ,IAAjB,EAAuB,IAAvB,CAA4B,OAA5B;AACH,SALD;AAMH;;AAED,aAAS,iBAAT,CAA2B,OAA3B,EAAoC;AAChC,gBAAQ,OAAR,CAAgB,mBAAW;AACvB,gBAAI,cAAc,SAAS,QAAQ,IAAjB,CAAlB;AACA,gBAAI,CAAC,WAAL,EAAkB;AACd,oBAAI,QAAQ,YAAR,KAAyB,OAA7B,EAAsC;AAClC,6BAAS,QAAQ,IAAjB,IAAyB,EAAzB;AACA,6BAAS,QAAQ,IAAjB,EAAuB,MAAvB,CAA8B,CAA9B,EAAiC,CAAjC,EAAoC,OAApC;AACH;AACJ,aALD,MAKM;AACF,oBAAI,QAAQ,CAAZ;AACA,uBAAO,QAAQ,YAAY,MAA3B,EAAmC,OAAnC,EAA4C;AACxC,wBAAI,YAAY,KAAZ,EAAmB,EAAnB,KAA0B,QAAQ,EAAtC,EAA0C;AACtC,4BAAI,QAAQ,YAAR,KAAyB,OAA7B,EAAsC;AAClC,wCAAY,KAAZ,IAAqB,OAArB;AACH,yBAFD,MAEO;AACH,wCAAY,MAAZ,CAAmB,KAAnB,EAA0B,CAA1B;AACH;AACD;AACH;AACJ;AACD,oBAAI,UAAU,YAAY,MAA1B,EAAkC;AAC9B,wBAAI,QAAQ,YAAR,KAAyB,OAA7B,EAAsC;AAClC,oCAAY,MAAZ,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,OAAzB;AACH;AACJ;AACJ;AACJ,SAzBD;AA0BH;;AAED,WAAO;AACH,sBAAc,sBAAS,IAAT,EAAe;AACzB,8BAAkB,iBAAiB,IAAjB,CAAlB;AACA,mBAAO,eAAP;AACH,SAJE;AAKH,2BAAmB,2BAAS,IAAT,EAAe;AAC9B,gBAAI,CAAC,eAAL,EAAsB;AAClB,oBAAI,SAAS,IAAT,CAAJ,EAAoB;AAChB,2BAAO,SAAS,IAAT,CAAP;AACH,iBAFD,MAEO;AACH,2BAAO,EAAP;AACH;AACJ,aAND,MAMO;AACH,uBAAO,gBAAgB,IAAhB,CAAqB,YAAM;AAC9B,2BAAO,SAAS,IAAT,CAAP;AACH,iBAFM,CAAP;AAGH;AACJ,SAjBE;AAkBH,wBAAgB,0BAAW;AACvB,mBAAO,CAAC,eAAD,GAAmB,gBAAnB,GAAsC,gBAAgB,IAAhB,CAAqB,cAArB,CAA7C;AACH,SApBE;AAqBH,kCAA0B,oCAAW;AACjC,2BAAe,SAAf,CACI,eADJ,EAEI,mDAFJ,EAGI,uBAHJ;AAKH,SA3BE;AA4BH,0BAAkB,0BAAS,OAAT,EAAkB;AAChC,gBAAI,OAAJ,EAAa;AACT,sCAAsB,IAAtB,CAA2B,OAA3B;AACH;AACJ,SAhCE;AAiCH,wBAAgB,wBAAS,IAAT,EAAe,UAAf,EAA2B,QAA3B,EAAqC;AACjD,mBAAO,IAAI,QAAJ,GACF,IADE,CACG,6BADH,EACkC;AACjC,sBAAM,EAAC,aAAa,UAAd,EAD2B;AAEjC,oBAAI,CACA,EAAC,aAAa,QAAd,EADA,CAF6B;AAKjC,sBAAM;AAL2B,aADlC,EAQF,IARE,CAQG;AAAA,uBAAY,SAAS,IAAT,EAAZ;AAAA,aARH,CAAP;AASH,SA3CE;AA4CH,0BAAkB,0BAAS,IAAT,EAAe,UAAf,EAA2B,QAA3B,EAAqC;AACnD,oBAAQ,GAAR,CAAY,UAAZ;AACA,mBAAO,IAAI,QAAJ,GACF,IADE,CACG,uCADH,EAC4C;AAC3C,sBAAM,EAAC,iBAAiB,UAAlB,EADqC;AAE3C,oBAAI,CACA,EAAC,iBAAiB,QAAlB,EADA,CAFuC;AAK3C,sBAAM;AALqC,aAD5C,EAQF,IARE,CAQG;AAAA,uBAAY,SAAS,IAAT,EAAZ;AAAA,aARH,CAAP;AASH,SAvDE;AAwDH,yBAAiB,yBAAS,cAAT,EAAyB,QAAzB,EAAmC,MAAnC,EAA2C;AACxD,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,sCADF,EAC0C;AACzC,0BAAU,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,WAAW,IAAX,GAAkB,IAAxC,EAA8C,WAA9C,EAD+B;AAEzC,wBAAQ,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,CAAC,UAAU,CAAX,IAAgB,IAAhB,GAAuB,IAA7C,EAAmD,WAAnD,EAFiC;AAGzC;AAHyC,aAD1C,EAMF,IANE,CAMG;AAAA,uBAAY,SAAS,IAAT,EAAZ;AAAA,aANH,EAOF,IAPE,CAOG;AAAA,uBAAQ,KAAK,OAAb;AAAA,aAPH,EAQF,IARE,CAQG;AAAA,uBAAW,QAAQ,OAAR,EAAX;AAAA,aARH,CAAP;AASH,SAlEE;AAmEH,6BAAqB,6BAAS,WAAT,EAAsB,QAAtB,EAAgC,MAAhC,EAAwC;AACzD,mBAAO,IAAI,QAAJ,GACF,GADE,CACE,sCADF,EAC0C;AACzC,0BAAU,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,WAAW,IAAX,GAAkB,IAAxC,EAA8C,WAA9C,EAD+B;AAEzC,wBAAQ,IAAI,IAAJ,CAAS,KAAK,GAAL,KAAa,CAAC,UAAU,CAAX,IAAgB,IAAhB,GAAuB,IAA7C,EAAmD,WAAnD,EAFiC;AAGzC;AAHyC,aAD1C,EAMF,IANE,CAMG;AAAA,uBAAY,SAAS,IAAT,EAAZ;AAAA,aANH,EAOF,IAPE,CAOG;AAAA,uBAAQ,KAAK,OAAb;AAAA,aAPH,EAQF,IARE,CAQG;AAAA,uBAAW,QAAQ,OAAR,EAAX;AAAA,aARH,CAAP;AASH;AA7EE,KAAP;AA+EH,CAlKsB,CAkKrB,GAlKqB,CAAvB;;ACFA,IAAI,oBAAoB,YAAW;AAC/B,QAAI,yBAAyB,EAA7B;AACA,QAAI,gBAAgB,EAApB;AACA,QAAI,aAAa,CAAjB;;AAEA,qBAAiB,gBAAjB,CAAkC,mBAAW;AACzC,+BAAuB,OAAvB,CAA+B,aAAK;AAChC,gBAAI;AACA,kBAAE,QAAQ,KAAR,EAAF;AACH,aAFD,CAEE,OAAO,CAAP,EAAU;AACR,wBAAQ,KAAR,CAAc,CAAd;AACH;AACJ,SAND;AAOH,KARD;;AAUA,aAAS,YAAT,CAAsB,OAAtB,EAA+B;AAC3B,eAAO;AACH,gBAAI,QAAQ,EADT;AAEH,kBAAM,QAAQ,gBAFX;AAGH,wBAAY,QAAQ,UAHjB;AAIH,kBAAM,QAAQ,OAAR,CAJH;AAKH,qBAAS,UAAU,QAAQ,IAAlB,EAAwB,aAAa,OAAb,EAAsB,UAAtB,CAAxB,CALN;AAMH,qBAAS,QAAQ,OAAR,IAAmB,IANzB;AAOH,oBAAQ,QAAQ,YAAR,GAAsB,QAAQ,YAAR,CAAqB,EAA3C,GAA+C,IAPpD;AAQH,oBAAQ,UAAU,OAAV,EAAmB,aAAa,OAAb,EAAsB,SAAtB,CAAnB;AARL,SAAP;;AAWA,iBAAS,YAAT,CAAsB,OAAtB,EAA+B,GAA/B,EAAoC;AAChC,mBAAO,QAAQ,SAAR,KAAsB,GAAtB,GAA4B,QAAQ,EAAR,CAAW,CAAX,CAA5B,GAA4C,QAAQ,IAA3D;AACH;;AAED,iBAAS,SAAT,CAAmB,OAAnB,EAA4B,IAA5B,EAAkC;AAC9B,mBAAO,QAAQ,IAAR,KAAiB,OAAjB,GAA2B,KAAK,eAAhC,GAAkD,KAAK,WAA9D;AACH;;AAED,iBAAS,OAAT,CAAiB,OAAjB,EAA0B;AACtB,mBAAQ,QAAQ,IAAR,KAAiB,KAAjB,IAA0B,QAAQ,IAAR,KAAiB,WAA5C,GAA2D,MAA3D,GAAoE,QAAQ,IAAnF;AACH;AACJ;;AAED,WAAO;AACH,yBAAiB,2BAAW;AACxB,mBAAO,QAAQ,OAAR,CAAgB,iBAAiB,iBAAjB,CAAmC,KAAnC,CAAhB,EAA2D,IAA3D,CAAgE,oBAAY;AAC/E,oBAAI,UAAU,EAAd;AACA,yBAAS,OAAT,CAAiB,mBAAW;AACxB,4BAAQ,IAAR,CAAa,aAAa,OAAb,CAAb;AACH,iBAFD;AAGA,uBAAO,OAAP;AACH,aANM,CAAP;AAOH,SATE;;AAWH,kCAA0B,oCAAW;AACjC,gBAAI,UAAU,EAAd;AACA,mBAAO,KAAK,oBAAL,GACM,IADN,CACW,gBAAQ;AACV,qBAAK,IAAI,GAAT,IAAgB,IAAhB,EAAsB;AAClB,wBAAI,KAAK,cAAL,CAAoB,GAApB,CAAJ,EAA8B;AAC1B,4BAAI,QAAQ,WAAZ,EACI,UAAU,QAAQ,MAAR,CAAe,KAAK,SAAL,CAAe,CAAf,CAAf,CAAV,CADJ,KAGI,QAAQ,IAAR,CAAa,KAAK,GAAL,EAAU,CAAV,CAAb;AACP;AACJ;AACD,uBAAO,OAAP;AACH,aAXN,CAAP;AAYH,SAzBE;;;AA4BH,8BAAsB,gCAAW;AAC7B,mBAAO,QAAQ,OAAR,CAAgB,iBAAiB,cAAjB,EAAhB,EAAmD,IAAnD,CAAwD,oBAAY;AACvE,oBAAI,UAAU,EAAd;AACA,oBAAI,SAAS,EAAb;AACA,yBAAS,OAAT,CAAiB,mBAAW;AACxB,wBAAI,SAAS,aAAa,OAAb,CAAb;;AAEA,wBAAI,QAAQ,YAAR,IAAwB,QAAQ,YAAR,CAAqB,EAAjD,EAAqD;AACjD,+BAAO,QAAQ,YAAR,CAAqB,EAA5B,IAAkC,OAAO,QAAQ,YAAR,CAAqB,EAA5B,KAAmC,EAArE;AACA,+BAAO,QAAQ,YAAR,CAAqB,EAA5B,EAAgC,IAAhC,CAAqC,MAArC;AACA,sCAAc,QAAQ,YAAR,CAAqB,EAAnC,IAAyC,cAAc,QAAQ,YAAR,CAAqB,EAAnC,KAA0C,EAAnF;AACA,sCAAc,QAAQ,YAAR,CAAqB,EAAnC,EAAuC,IAAvC,CAA4C,OAA5C;AACH,qBALD,MAKO;AACH,+BAAO,WAAP,IAAsB,OAAO,WAAP,KAAuB,EAA7C;AACA,+BAAO,WAAP,EAAoB,IAApB,CAAyB,MAAzB;AACH;AACJ,iBAZD;AAaA,uBAAO,MAAP;AACH,aAjBM,CAAP;AAkBH,SA/CE;;AAiDH,yBAAiB,yBAAS,MAAT,EAAiB,QAAjB,EAA2B;AACxC,gBAAI,cAAc,MAAd,MAA0B,CAAC,QAAD,IAAa,WAAW,UAAlD,CAAJ,EAAmE;AAC/D,uBAAO,QAAQ,OAAR,CAAgB,cAAc,MAAd,EAAsB,OAAtB,EAAhB,CAAP;AACH,aAFD,MAGK;AACD,uBAAO,iBAAiB,eAAjB,CACH,MADG,EAEH,QAFG,EAGH,UAHG,EAIN,IAJM,CAID,kBAAU;AACZ,iCAAa,QAAb;AACA,2BAAO,MAAP;AACH,iBAPM,CAAP;AAQH;AACJ,SA/DE;;AAiEH,0BAAkB,0BAAS,OAAT,EAAkB;AAChC,mCAAuB,IAAvB,CAA4B,OAA5B;AACH;AAnEE,KAAP;AAqEH,CA7GuB,EAAxB;;ACCA,IAAI,sBAAsB,YAAW;AACjC,QAAI,yBAAyB,IAA7B;;AAEA,aAAS,mBAAT,GAA+B;AAC3B,iCAAyB,IAAI,QAAJ,GAAe,GAAf,CAAmB,qCAAnB,EACpB,IADoB,CACf,qBAAa;AACf,gBAAI,eAAe,UAAU,IAAV,EAAnB;AACA,gBAAI,iBAAiB,EAArB;AACA,2BAAe,QAAf,GAA0B,aAAa,QAAvC;AACA,2BAAe,WAAf,GAA6B,aAAa,WAA1C;AACA,2BAAe,eAAf,GAAiC,aAAa,eAA9C;AACA,qCAAyB,IAAzB;AACA,mBAAO,cAAP;AACH,SAToB,CAAzB;AAUA,eAAO,sBAAP;AACH;;AAED,WAAO;AACH,2BAAmB,6BAAW;AAC1B,gBAAG,sBAAH,EAA0B;AACtB,uBAAO,sBAAP;AACH,aAFD,MAEK;AACD,uBAAO,qBAAP;AACH;AACJ;AAPE,KAAP;AASH,CA1ByB,EAA1B;;ACCA,IAAI,sBAAuB,UAAS,GAAT,EAAc;AACrC,QAAI,aAAa,KAAK,CAAtB;AACA,aAAS,qBAAT,CAA+B,IAA/B,EAAqC,QAArC,EAA+C;AAC3C,YAAI,kBAAkB,SAAS,MAAT,CAAgB,mBAAW;AAC7C,gBAAI,qBAAqB,EAAzB;AACA,gBAAI,cAAc,QAAQ,WAAR,CAAoB,MAApB,CAA2B,QAAQ,SAAnC,CAAlB;AACA,gBAAI,cAAc,KAAK,MAAL,CAAY,UAAC,GAAD,EAAM,KAAN,EAAgB;AAC1C,oBAAI,YAAY,IAAI,SAAJ,KAAkB,SAAlB,GAA8B,IAAI,IAAlC,GAAyC,IAAI,EAA7D;AACA,oBAAI,UAAU,YAAY,OAAZ,CAAoB,SAApB,IAAiC,CAAC,CAAhD;AACA,wBAAQ,GAAR,GAAc,QAAQ,GAAR,IAAe,EAA7B;AACA,oBAAI,eAAe,QAAQ,GAAR,CAAY,IAAZ,CAAiB;AAAA,2BAAc,WAAW,EAAX,IAAiB,IAAI,EAAnC;AAAA,iBAAjB,CAAnB;AACA,oBAAI,WAAW,CAAC,YAAhB,EAA8B;;AAE1B,4BAAQ,GAAR,CAAY,IAAZ,CAAiB,GAAjB;AACA,uCAAmB,IAAnB,CAAwB,KAAxB;AACH;AACD,uBAAO,OAAP;AACH,aAXiB,CAAlB;AAYA,+BAAmB,OAAnB,GAA6B,OAA7B,CAAqC;AAAA,uBAAS,KAAK,MAAL,CAAY,KAAZ,EAAmB,CAAnB,CAAT;AAAA,aAArC;AACA,mBAAO,YAAY,MAAZ,GAAqB,CAA5B;AACH,SAjBqB,CAAtB;AAkBA,aAAK,OAAL,CAAa,eAAO;AAChB,gBAAI,YAAY,IAAI,SAAJ,KAAkB,SAAlB,GAA8B,IAAI,IAAlC,GAAyC,IAAI,EAA7D;AACA,gBAAI,UAAU,gBAAgB,MAAhB,CAAuB;AAAA,uBAAW,QAAQ,EAAR,KAAe,SAA1B;AAAA,aAAvB,EAA4D,CAA5D,CAAd;AACA,gBAAI,OAAJ,EAAa;AACT,wBAAQ,GAAR,CAAY,IAAZ,CAAiB,GAAjB;AACH,aAFD,MAEO;AACH,gCAAgB,IAAhB,CAAqB,YAAY,GAAZ,CAArB;AACH;AACJ,SARD;AASA,eAAO,eAAP;AACH;;AAED,aAAS,qBAAT,CAA+B,IAA/B,EAAqC,QAArC,EAA+C;AAC3C,eAAO,KAAK,GAAL,CAAS,eAAO;AACnB,gBAAI,iBAAiB,IAArB;AACA,qBAAS,OAAT,CAAiB,mBAAW;AACxB,oBAAI,cAAc,QAAQ,WAAR,CAAoB,MAApB,CAA2B,QAAQ,SAAnC,CAAlB;AACA,oBAAI,YAAY,IAAI,SAAJ,KAAkB,SAAlB,GAA8B,IAAI,IAAlC,GAAyC,IAAI,EAA7D;AACA,oBAAI,UAAU,YAAY,OAAZ,CAAoB,SAApB,IAAiC,CAAC,CAAhD;AACA,oBAAI,OAAJ,EAAa;AACT,wBAAI,OAAJ,GAAc,OAAd;AACA,qCAAiB,KAAjB;AACH;AACJ,aARD;;;;;;;AAeA,mBAAO,GAAP;AACH,SAlBM,CAAP;AAmBH;;AAED,aAAS,sBAAT,CAAgC,QAAhC,EAA0C;;AAEtC,YAAI,YAAJ;AACA,YAAI,SAAS,EAAb;AACA,aAAK,IAAI,IAAI,SAAS,MAAT,GAAkB,CAA/B,EAAkC,IAAI,CAAtC,EAAyC,EAAE,CAA3C,EAA8C;AAC1C,gBAAI,UAAU,SAAS,CAAT,CAAd;;;;;;;;;AASA,gBAAI,gBACA,aAAa,IAAb,KAAsB,QAAQ,IAD9B,IAEA,aAAa,OAAb,CAAqB,EAArB,KAA4B,QAAQ,OAAR,CAAgB,EAFhD,EAEoD;AAChD,6BAAa,MAAb,CAAoB,IAApB,CAAyB,OAAzB;AACH,aAJD,MAIO;AACH,gCAAgB,OAAO,IAAP,CAAY,YAAZ,CAAhB;AACA,wBAAQ,MAAR,GAAiB,EAAjB;AACA,+BAAe,OAAf;AACH;AACJ;AACD,wBAAgB,OAAO,IAAP,CAAY,YAAZ,CAAhB;AACA,eAAO,MAAP;AACH;;AAED,aAAS,OAAT,GAA6B;AAAA,0CAAT,OAAS;AAAT,mBAAS;AAAA;;AACzB,eAAO,QAAQ,MAAR,CAAe,UAAC,MAAD,EAAS,MAAT;AAAA,mBAAoB,OAAO,MAAP,CAAc,MAAd,CAApB;AAAA,SAAf,EAA0D,EAA1D,CAAP;AACH;;AAED,aAAS,QAAT,CAAkB,MAAlB,EAA0B;AACtB,eAAO,OAAO,KAAP,GAAe,IAAf,CAAoB,UAAC,CAAD,EAAI,CAAJ;AAAA,mBACvB,KAAK,KAAL,CAAW,EAAE,IAAb,IACA,KAAK,KAAL,CAAW,EAAE,IAAb,CAFuB;AAAA,SAApB,CAAP;AAIH;AACD,aAAS,cAAT,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AACpC,eAAO,OAAO,MAAP,CAAc,UAAS,CAAT,EAAY;AAC7B,mBAAO,OAAO,OAAP,CAAe,CAAf,KAAqB,CAAC,CAA7B;AACH,SAFM,EAEJ,MAFI,GAEK,CAFZ;AAGH;AACD,aAAS,WAAT,CAAqB,MAArB,EAA6B;AACzB,YAAI,OAAO,EAAX;AACA,eAAO,OAAO,MAAP,CAAc,UAAS,IAAT,EAAe;AAChC,mBAAO,KAAK,cAAL,CAAoB,IAApB,IAA4B,KAA5B,GAAqC,KAAK,IAAL,IAAa,IAAzD;AACH,SAFM,CAAP;AAGH;;AAED,aAAS,WAAT,CAAqB,GAArB,EAA0B;AACtB,YAAI,cAAc,IAAI,SAAJ,KAAkB,SAAlB,GAA8B,IAAI,IAAlC,GAAyC,IAAI,EAA/D;AACA,eAAO;AACH,yBAAa,WADV;AAEH,gBAAI,WAFD;AAGH,yBAAa,CAAC,WAAD,CAHV;AAIH,uBAAW,IAJR;AAKH,iBAAK,CAAC,GAAD;AALF,SAAP;AAOH;;AAED,aAAS,YAAT,CAAsB,GAAtB,EAA2B;AACvB,eAAO;AACH,gBAAoB,IAAI,EADrB;AAEH,kBAAoB,IAAI,IAAJ,CAAS,eAAT,IACA,IAAI,IAAJ,CAAS,WAH1B;AAIH,gBAAoB,IAAI,EAAJ,CAAO,WAAP,IACA,IAAI,EAAJ,CAAO,eADP,IAEA,IAAI,EAAJ,CAAO,CAAP,EAAU,eAFV,IAGA,IAAI,EAAJ,CAAO,CAAP,EAAU,WAP3B;AAQH,uBAAoB,IAAI,SARrB;AASH,kBAAoB,IAAI,IATrB;AAUH,kBAAoB,IAAI,YAAJ,IACA,IAAI,SAXrB;AAYH,8BAAoB,IAAI,gBAAJ,IACA,IAAI,SAbrB;AAcH,qBAAoB,IAAI,SAAJ,IACA,IAAI,OADJ,IAEA,IAAI,MAFJ,IAGA,IAAI,WAAJ,CAAgB,CAAhB,CAjBjB;AAkBH,oBAAQ;AACJ,+BAAe,KADX;AAEJ,kCAAkB;AAFd;AAlBL,SAAP;AAuBH;AACD,aAAS,mBAAT,CAA6B,OAA7B,EAAsC,MAAtC,EAA8C;AAC1C,eAAO,QAAQ,GAAR,CAAY,QAAQ,WAAR,CAAoB,GAApB,CACP;AAAA,mBAAU,iBAAiB,mBAAjB;;AAEN,kBAFM,EAGN,aAAa,MAHP,EAIN,UAJM,CAAV;AAAA,SADO,CAAZ,EASN,IATM,CASD;AAAA,mBAAU,4CAAW,MAAX,EAAV;AAAA,SATC,CAAP;AAUH;AACD,aAAS,mBAAT,CAA6B,OAA7B,EAAsC,MAAtC,EAA8C;AAC1C,eAAO,QAAQ,GAAR,CAAY,QAAQ,WAAR,CAAoB,GAApB,CACP;AAAA,mBAAUA,eAAe,mBAAfA,CACN,MADMA,EAEN,aAAa,MAFPA,EAGN,UAHMA,CAAV;AAAA,SADO,CAAZ,EAQN,IARM,CAQD;AAAA,mBAAU,4CAAW,MAAX,EAAV;AAAA,SARC,CAAP;AASH;AACD,aAAS,MAAT,CAAgB,MAAhB,EAAwB;AACpB,YAAI,OAAO,EAAX;AACA,eAAO,OAAO,MAAP,CAAc,UAAS,IAAT,EAAe;AAChC,mBAAO,KAAK,cAAL,CAAoB,KAAK,EAAzB,IAA+B,KAA/B,GAAwC,KAAK,KAAK,EAAV,IAAgB,IAA/D;AACH,SAFM,CAAP;AAGH;AACD,aAAS,cAAT,GAAoC;AAAA,2CAAT,OAAS;AAAT,mBAAS;AAAA;;AAChC,eAAO,SAAS,4CAAW,QAAQ,GAAR,CAAY;AAAA,mBAAU,OAAO,GAAP,CAAW,YAAX,CAAV;AAAA,SAAZ,CAAX,EAAT,CAAP;AACH;AACD,WAAO;AACH,YAAI,UAAJ,GAAiB;AACb,mBAAO,UAAP;AACH,SAHE;AAIH,qBAAa,qBAAS,QAAT,EAA+B;AAAA,+CAAT,OAAS;AAAT,uBAAS;AAAA;;AACxC,gBAAI,WAAW,gCAAkB,OAAlB,CAAf;AACA,gBAAI,kBAAkB,sBAAsB,SAAS,KAAT,EAAtB,EAAwC,QAAxC,CAAtB;AACA,uBAAW,sBAAsB,QAAtB,EAAgC,eAAhC,CAAX;AACA,mBAAO,QAAP;AACH,SATE;AAUH,yBAAiB,yBAAS,QAAT,EAA+B;AAAA,+CAAT,OAAS;AAAT,uBAAS;AAAA;;AAC5C,gBAAI,WAAW,gCAAkB,OAAlB,CAAf;AACA,gBAAI,kBAAkB,sBAAsB,SAAS,KAAT,EAAtB,EAAwC,QAAxC,CAAtB;AACA,uBAAW,sBAAsB,QAAtB,EAAgC,eAAhC,CAAX;AACA,uBAAW,uBAAuB,QAAvB,CAAX;AACA,mBAAO,QAAP;AACH,SAhBE;AAiBH,0BAAkB,0BAAS,QAAT,EAA+B;AAAA,+CAAT,OAAS;AAAT,uBAAS;AAAA;;AAC7C,gBAAI,WAAW,gCAAkB,OAAlB,CAAf;AACA,gBAAI,kBAAkB,sBAAsB,QAAtB,EAAgC,QAAhC,EACD,GADC,CACG,mBAAW;AACZ,wBAAQ,QAAR,GAAmB,UAAnB;AACA,uBAAO,OAAP;AACH,aAJC,EAKD,GALC,CAKG,mBAAW;AACZ,wBAAQ,WAAR,GACA,YAAY,QAAQ,WAAR,CAAoB,MAApB,CAA2B,QAAQ,SAAnC,CAAZ,CADA;AAEA,uBAAO,OAAP;AACH,aATC,EAUD,MAVC,CAUM,UAAC,GAAD,EAAM,OAAN,EAAkB;AACtB,oBAAI,QAAQ,EAAZ,IAAkB,OAAlB;AACA,uBAAO,GAAP;AACH,aAbC,EAaC,EAbD,CAAtB;AAcA,mBAAO,eAAP;AACH,SAlCE;AAmCH,qBAAa,qBAAS,OAAT,EAAkB,MAAlB,EAA0B;AACnC,mBAAO,QAAQ,GAAR,CAAY,CACP,oBAAoB,OAApB,EAA6B,MAA7B,CADO,EAEP,oBAAoB,OAApB,EAA6B,MAA7B,CAFO,CAAZ,EAIE,IAJF,CAIO;AAAA,uBAAU,mDAAkB,MAAlB,EAAV;AAAA,aAJP,EAKE,IALF,CAKO,oBAAY;AACd,wBAAQ,GAAR,GAAc,SAAS,MAAT,CAAgB,QAAQ,GAAxB,CAAd;AACA,8BAAc,MAAd;AACA,uBAAO,QAAP;AACH,aATF,CAAP;AAUH,SA9CE;AA+CH,8BAAsB,8BAAS,OAAT,EAAkB;AACpC,6BAAiB,gBAAjB,CAAkC,gBAAQ;AACtC,oBAAI;AACA,wBAAI,OAAO,SAAS,KAAK,GAAL,CAAS,YAAT,CAAT,CAAX;AACA,4BAAQ,IAAR;AACH,iBAHD,CAGE,OAAO,CAAP,EAAU;AACR,4BAAQ,KAAR,CAAc,CAAd;AACA,0BAAM,CAAN;AACH;AACJ,aARD;AASH,SAzDE;AA0DH;AA1DG,KAAP;AA4DH,CAzOyB,CAyOvB,GAzOuB,CAA1B;;ACQA,IAAI,yBAAyB,CAAC,uBAAD,CAA7B;;AAEA,IAAI,WAAW,EAAf;AACA,SAAS,OAAT,GAAmB;AACf,cAAU;AACN,gBAAQ,kBAAW;AACf,6BAAiB,wBAAjB;AACA,6BAAiB,YAAjB,CAA8B,KAAK,KAAL,CAAW,kBAAzC;AACA,2BAAe,cAAf;AACA,2BAAe,cAAf;AACA,6BAAiB,kBAAjB;AACAC,yBAAa,WAAbA;AACAD,2BAAe,WAAfA;AACAC,yBAAa,MAAbA;AACH;AAVK;AADK,CAAnB;AAcA,SAAS,YAAT,IAAyB;AACrB,WAAO;AACH,gBAAQ,kBAAW;AACf,oBAAQ,GAAR,CAAY,OAAZ;AACA,mBAAOC,aAAa,KAAbA,CACH,YAAY,UAAZ,CAAuB,IAAvB,EAA6B,KAAK,KAAL,CAAW,QAAxC,CADGA,EAEH,KAAK,KAAL,CAAW,SAFRA,EAGH,KAAK,KAAL,CAAW,QAHRA,CAAP;AAKH;AARE;AADc,CAAzB;AAYA,SAAS,UAAT,IAAuB;AACnB,WAAO;AACH,eAAO,iBAAW;AACd,gBAAI,CAAC,eAAe,iBAAf,CAAiC,aAAjC,CAAL,EACI,KAAK,OAAL;AACP;AAJE,KADY;AAOnB,aAAS;AACL,gBAAQ,kBAAW;AACf,mBAAOD,aAAa,OAAbA,CAAqB,KAAK,KAAL,CAAW,UAAhCA,EAA4C,KAAK,KAAL,CAAW,QAAvDA,CAAP;AACH;AAHI,KAPU;AAYnB,mBAAe;AACX,gBAAQ,kBAAW;AAAA;;AACf,gBAAI,yBAAyB,uBAAuB,GAAvB,CAA2B,oBAAY;AAChE,uBAAO,SAAS,MAAT,CAAgB,MAAK,KAAL,CAAW,QAA3B,CAAP;AACH,aAF4B,CAA7B;AAGA,mBAAO,qBAAqB,KAArB,CAA2B,sBAA3B,CAAP;AACH;AANU,KAZI;AAoBnB,yBAAqB;AACjB,gBAAQ,kBAAW;AACf,oBAAQ,GAAR,CAAY,cAAZ;AACA,mBAAO,eAAe,cAAf,GAAgC,IAAhC,CAAqC,YAAM;AAC9C,uBAAO,eAAe,UAAf,CAA0B,UAA1B,EAAsC,UAAtC,CAAP;AACH,aAFM,CAAP;AAGH;AANgB;AApBF,CAAvB;;AA8BA,SAAS,YAAT,IAAyB;AACrB,uBAAmB;AACf,gBAAQ,kBAAW;AACf,mBAAO,oBAAoB,iBAApB,EAAP;AACH;AAHc;AADE,CAAzB;AAOA,SAAS,UAAT,IAAuB;AACnB,UAAM;AACF,gBAAQ,kBAAW;AACf,mBAAOD,eAAe,WAAfA,EAAP;AACH;AAHC;AADa,CAAvB;;AAQA,SAAS,WAAT,IAAwB;AACpB,WAAO;AACH,eAAO,iBAAW;AAAA;;AACd,6BAAiB,wBAAjB;AACA,8BAAkB,gBAAlB,CAAmC,eAAO;AACtC,uBAAK,cAAL,CAAoB,oBAAoB,WAApB,CAAgC,OAAK,KAAL,CAAW,QAA3C,EAAqD,GAArD,CAApB;AACA,oBAAI,OAAK,KAAL,CAAW,WAAf,EAA4B;AACxB,2BAAK,KAAL,CAAW,WAAX,CAAuB,eAAvB;AACA,2BAAK,KAAL,CAAW,WAAX,CAAuB,mBAAvB;AACH;AACJ,aAND;AAOA,mBAAO,iBAAiB,aAAjB,GAAiC,IAAjC,CAAsC;AAAA,uBAAY,OAAK,KAAL,CAAW,QAAX,GAAsB,QAAlC;AAAA,aAAtC,CAAP;AACH;AAXE,KADa;AAcpB,eAAW;AACP,gBAAQ,kBAAW;AACf,mBAAO,QAAQ,GAAR,CAAY,CACf,iBAAiB,aAAjB,EADe,E;AAEf,6BAAiB,YAAjB,CAA8B,oBAAoB,UAAlD,CAFe,EAGfA,eAAe,WAAfA,EAHe,CAAZ,EAIJ,IAJI,CAIC;AAAA,uBAAU,oBAAoB,eAApB,+CAAuC,MAAvC,EAAV;AAAA,aAJD,CAAP;AAKH;AAPM;AAdS,CAAxB;;AAyBA,SAAS,UAAT,IAAuB;AACnB,WAAO;AACH,eAAO,iBAAW;AACd,iBAAK,aAAL;AACH;AAHE,KADY;AAMnB,yBAAqB;AACjB,gBAAQ,kBAAW;AAAA;;AACf,mBAAO,QAAQ,GAAR,CAAY,CACf,iBAAiB,YAAjB,CAA8B,oBAAoB,UAAlD,CADe,EAEfA,eAAe,WAAfA,EAFe,EAGf,iBAAiB,aAAjB,EAHe,CAAZ,EAIJ,IAJI,CAIC,kBAAU;AAAA,6CACe,MADf;;AAAA,oBACT,IADS;AAAA,oBACH,IADG;AAAA,oBACG,QADH;;AAEd,uBAAK,KAAL,CAAW,QAAX,GAAsB,SAAS,MAAT,CAAgB,UAAC,MAAD,EAAS,OAAT,EAAqB;AACvD,2BAAO,QAAQ,EAAf,IAAqB,OAArB;AACA,2BAAO,MAAP;AACH,iBAHqB,EAGnB,EAHmB,CAAtB;AAIA,uBAAO,oBAAoB,gBAApB,CAAqC,QAArC,EAA+C,IAA/C,EAAqD,IAArD,CAAP;AACH,aAXM,EAWJ,IAXI,CAWC,0BAAkB;AACtB,uBAAK,KAAL,CAAW,cAAX,GAA4B,cAA5B;AACA,uBAAO,cAAP;AACH,aAdM,EAcJ,IAdI,CAcC;AAAA,uBACJ,OAAO,IAAP,CAAY,cAAZ,EAA4B,GAA5B,CAAgC,iBAAS;;AAErC,mCAAe,KAAf,EAAsB,GAAtB,CAA0B,CAA1B,EAA6B,OAA7B,GAAuC,eAAe,KAAf,EAAsB,WAA7D;;AAEA,mCAAe,KAAf,EAAsB,GAAtB,CAA0B,CAA1B,EAA6B,SAA7B,GAAyC,KAAzC;AACA,2BAAO,eAAe,KAAf,EAAsB,GAAtB,CAA0B,CAA1B,CAAP;AACH,iBAND,CADI;AAAA,aAdD,CAAP;AAuBH;AAzBgB,KANF;AAiCnB,mBAAe;AACX,gBAAQ,kBAAW;AAAA;;;;;;AAKf,mBAAO,iBAAiB,aAAjB,GAAiC,IAAjC,CAAsC,oBAAY;AACrD,uBAAK,KAAL,CAAW,QAAX,GAAsB,SAAS,MAAT,CAAgB,UAAC,MAAD,EAAS,OAAT,EAAqB;AACvD,2BAAO,QAAQ,EAAf,IAAqB,OAArB;AACA,2BAAO,MAAP;AACH,iBAHqB,EAGnB,EAHmB,CAAtB;AAIA,uBAAO,SAAS,GAAT,CAAa,mBAAW;AAC3B,2BAAO;AACH,8BAAM,QAAQ,WADX;AAEH,8BAAM,IAFH;AAGH,4BAAI,QAAQ;AAHT,qBAAP;AAKH,iBANM,CAAP;AAOH,aAZM,EAYJ,KAZI,CAYE;AAAA,uBAAK,QAAQ,KAAR,CAAc,CAAd,CAAL;AAAA,aAZF,CAAP;AAaH;AAnBU,KAjCI;AAsDnB,mBAAe;AACX,gBAAQ,kBAAW;AACf,gBAAI,UACC,KAAK,KAAL,CAAW,cAAX,IACD,KAAK,KAAL,CAAW,cAAX,CAA0B,KAAK,KAAL,CAAW,eAAX,CAA2B,EAArD,CADA,IAEA,KAAK,KAAL,CAAW,QAAX,CAAoB,KAAK,KAAL,CAAW,eAAX,CAA2B,EAA/C,CAHJ;AAIA,gBAAI,eAAe,MAAM,KAAN,CAAY,QAAZ,CAAqB,KAArB,CAA2B,WAA3B,GAAyC,KAAK,OAAL,EAAc,YAAM;AAC5E,sBAAM,KAAN,CAAY,QAAZ,CAAqB,KAArB,CAA2B,iBAA3B;AACH,aAF2D,CAA5D;AAGH;AATU;AAtDI,CAAvB;;AAmEA,SAAS,uBAAT,IAAoC;AAChC,UAAM;AACF,eAAO,iBAAW;AACd,iBAAK,KAAL,CAAW,UAAX,GAAwB,IAAI,EAA5B;AAEH;AAJC,KAD0B;AAOhC,WAAO;AACH,eAAO,iBAAW;AAAA;;AACd,mBAAO,eAAe,cAAf,GACE,IADF,CACO;AAAA,uBAAQ,OAAK,KAAL,CAAW,aAAX,GAA2B,KAAK,eAAxC;AAAA,aADP,EAEE,IAFF,CAEO,KAAK,mBAFZ,CAAP;AAGH;AALE,KAPyB;AAchC,UAAM;AACF,gBAAQ,kBAAW;AACf,gBAAI,KAAK,KAAL,CAAW,QAAX,KAAwB,KAAK,KAAL,CAAW,WAAvC,EAAoD;AAChD,uBAAO,iBAAiB,gBAAjB,CACH,KAAK,KAAL,CAAW,OADR,EAEH,KAAK,KAAL,CAAW,aAFR,EAGH,KAAK,KAAL,CAAW,WAHR,CAAP;AAKH,aAND,MAOK;AACD,uBAAO,iBAAiB,cAAjB,CACH,KAAK,KAAL,CAAW,OADR,EAEH,KAAK,KAAL,CAAW,UAFR,EAGH,KAAK,KAAL,CAAW,QAHR,CAAP;AAKH;AACJ;AAhBC,KAd0B;AAgChC,mBAAe;AACX,gBAAQ,kBAAW;AAAA;;AACf,gBAAI,yBAAyB,uBAAuB,GAAvB,CAA2B,oBAAY;AAChE,uBAAO,SAAS,MAAT,CAAgB,OAAK,KAAL,CAAW,EAA3B,CAAP;AACH,aAF4B,CAA7B;AAGA,mBAAO,qBAAqB,KAArB,CAA2B,sBAA3B,CAAP;AACH;AANU,KAhCiB;AAwChC,yBAAqB;AACjB,gBAAQ,kBAAW;AACf,mBAAO,eAAe,cAAf,GAAgC,IAAhC,CAAqC;AAAA,uBACxC,eAAe,UAAf,CAA0B,UAA1B,EAAsC,WAAtC,CADwC;AAAA,aAArC,CAAP;AAEH;AAJgB,KAxCW;AA8ChC,cAAU;AACN,gBAAQ,kBAAW;AACf,mBAAO,oBAAoB,WAApB,CAAgC,KAAK,KAAL,CAAW,OAA3C,EAAoD,KAAK,KAAL,CAAW,UAA/D,CAAP;AACH;AAHK;AA9CsB,CAApC;;AC9KA,SAAS,MAAT,CAAgB,IAAhB,EAAsB,KAAtB,EAA6B;AACzB,SAAK,IAAI,MAAT,IAAmB,KAAnB,EAA0B;AACtB,YAAI,KAAK,MAAL,CAAJ,EAAkB;AACd,iBAAK,IAAI,IAAT,IAAiB,MAAM,MAAN,CAAjB,EAAgC;AAC5B,oBAAI,SAAS,KAAK,MAAL,EAAa,IAAb,CAAb;AACA,qBAAK,MAAL,EAAa,IAAb,IAAqB,YAAkB;AACnC,4BAAQ,GAAR,CAAY,IAAZ;AACA,wBAAI,MAAJ;AACA,wBAAI,MAAJ,EAAY;AAAA,2DAHiB,IAGjB;AAHiB,gCAGjB;AAAA;;AACR,iCAAS,OAAO,IAAP,gBAAY,IAAZ,SAAqB,IAArB,EAAT;AACH;AACD,0BAAM,MAAN,EAAc,IAAd,EAAoB,IAApB,CAAyB,IAAzB;AACA,2BAAO,MAAP;AACH,iBARD;AASH;AACJ,SAbD,MAaO;AACH,iBAAK,MAAL,IAAe,MAAM,MAAN,CAAf;AACH;AACJ;AACD,WAAO,IAAP;AACH;;AAED,IAAI,UAAU,SAAV,OAAU,GAAY,CAEzB,CAFD;;AAIA,QAAQ,SAAR,CAAkB,MAAlB,GAA2B,UAAS,IAAT,EAA2B;AAAA,QAAZ,KAAY,yDAAJ,EAAI;;AAClD,WAAO,OAAO,SAAS,IAAT,CAAP,EAAuB,KAAvB,CAAP;AACH,CAFD;;AjB5BA,OAAO,OAAP,GAAiB,OAAjB","file":"factory.js","sourcesContent":["import Factory from './factory.js'\nwindow.Factory = Factory\n","var sdk = new RingCentral.SDK({\n    appKey: '8mOtYiilT5OUPwwdeGgvpw',\n    appSecret: 'cqNn89RmR2SR76Kpp8xJaAdNzNOqR8Qfmjb0B-gDOHTw',\n    server: RingCentral.SDK.server.production\n})\n\nexport default sdk\n","var webPhone = new RingCentral.WebPhone({\n    audioHelper: {}\n})\n\nexport default webPhone\n","import sdk from './rc-sdk'\nimport webPhone from './rc-webphone'\n\nvar PhoneService = function() {\n    var line\n    var handlers = {\n        called: [],\n        callStarted: [],\n        callRejected: [],\n        callEnded: [],\n        callFailed: []\n    }\n    return {\n        registerSIP: function() {\n            return sdk.platform()\n                .post('/client-info/sip-provision', {\n                    sipInfo: [{\n                        transport: 'WSS'\n                    }]\n                })\n                .then(res => {\n                    return webPhone.register(res.json(), false)\n                        .catch(function(e) {\n                            return Promise.reject(err)\n                        })\n                })\n        },\n        callout: function(fromNumber, toNumber) {\n            // TODO: validate toNumber and fromNumber\n            if (!sdk || !webPhone) {\n                throw Error('Need to set up SDK and webPhone first.')\n                return\n            }\n            return sdk.platform()\n                .get('/restapi/v1.0/account/~/extension/~')\n                .then(res => {\n                    var info = res.json()\n                    if (info && info.regionalSettings && info.regionalSettings.homeCountry) {\n                        return info.regionalSettings.homeCountry.id\n                    }\n                    return null\n                })\n                .then(countryId => {\n                    webPhone.call(toNumber, fromNumber, countryId)\n                })\n        },\n        answer: function() {\n            return webPhone\n                .answer(line)\n        },\n        ignore: function() {},\n        cancel: function() {\n            return line\n                .cancel()\n        },\n        hangup: function() {\n            return webPhone\n                .hangup(line)\n        },\n        on: function(name, handler) {\n            handlers[name].push(handler)\n        },\n        listen: function() {\n            webPhone.ua.on('incomingCall', e => {\n                line = e\n                handlers.called.forEach(h => h(e))\n            })\n            webPhone.ua.on('callStarted', e => {\n                handlers.callStarted.forEach(h => h(e))\n            })\n            webPhone.ua.on('callRejected', e => {\n                handlers.callRejected.forEach(h => h(e))\n            })\n            webPhone.ua.on('callEnded', e => {\n                handlers.callEnded.forEach(h => h(e))\n            })\n            webPhone.ua.on('callFailed', e => {\n                handlers.callFailed.forEach(h => h(e))\n            })\n        },\n    }\n}()\nexport default PhoneService\n","import sdk from './rc-sdk'\nvar LoginService = function(sdk) {\n    var onLoginHandler = []\n    return {\n        login: function(username, extension, password) {\n            return sdk.platform()\n                .login({\n                    'username': username,\n                    'extension': extension,\n                    'password': password\n                })\n        },\n        logout: function() {\n            return sdk.platform().logout()\n        },\n        checkLoginStatus: function() {\n            return sdk.platform().loggedIn().then(function(isLoggedIn) {\n                if (isLoggedIn) {\n                    onLoginHandler.forEach(handler => handler())\n                }\n                return isLoggedIn\n            })\n        },\n\n    }\n}(sdk)\nexport default LoginService\n","import sdk from './rc-sdk'\n\nvar rcSubscription = function() {\n\n    var cacheKey = 'ringcentral-subscription'\n    var subscription = sdk.createCachedSubscription(cacheKey).restore()\n    var handlers = {}\n    subscription.on(subscription.events.notification, function(msg) {\n        console.log('update from pubnub');\n        for (var key in handlers) {\n            if (handlers.hasOwnProperty(key)) {\n                if (msg.event.indexOf(key) > -1) {\n                    handlers[key].forEach(h => {\n                        try {\n                            h(msg)\n                        } catch (e) {\n                            console.error('Error occurs when invoking subscription notification handler for \"' +\n                        msg.event + '\": ' + e)\n                        }\n                    })\n                }\n            }\n        }\n    })\n\n    return {\n        subscribe: function(suffix, event, handler) {\n            if (event && suffix) {\n                if (!handlers[suffix]) {\n                    handlers[suffix] = []\n                }\n                handlers[suffix].push(handler)\n                subscription.addEventFilters(event).register()\n            }\n        }\n    }\n}()\n\nexport default rcSubscription\n","import sdk from './rc-sdk'\nimport rcSubscription from './rc-subscription-service'\n\nvar CallLogService = (function(sdk) {\n    var period = 7 * 24 * 3600 * 1000\n    var dateFrom = new Date(Date.now() - (period))\n    return {\n        getCallLogs: function() {\n            return sdk.platform()\n                .get('/account/~/extension/~/call-log', {dateFrom: dateFrom.toISOString()})\n                .then(response => {\n                    return response.json().records\n                })\n        },\n        getCallLogsByNumber: function(phoneNumber, hourFrom, hourTo) {\n            return sdk.platform()\n                .get('/account/~/extension/~/call-log', {\n                    dateFrom: new Date(Date.now() - hourFrom * 3600 * 1000).toISOString(),\n                    dateTo: new Date(Date.now() - (hourTo || 0) * 3600 * 1000).toISOString(),\n                    phoneNumber\n                })\n                .then(response => response.json())\n                .then(data => data.records)\n                .then(records => records.reverse())\n        }\n    }\n})(sdk)\n\nexport default CallLogService\n","import sdk from './rc-sdk'\nvar accountService = (function(sdk) {\n    var info\n    var numbers\n    var fetchNumbers = null\n\n    function getNumbersByType(numbers, type) {\n        if (!numbers)\n                return Error('Need to fetch numbers first using accountService.getPhoneNumber')\n        return numbers\n            .filter(number => number.type === type)\n    }\n\n    function getNumbersByFeatures(numbers, features) {\n        if (!Array.isArray(features))\n            features = [features]\n        // if has duplicate features\n        return numbers\n            .filter(number => features.filter(f => number.features.indexOf(f) > -1).length > 0)\n    }\n\n    return {\n        getAccountInfo: function() {\n            return sdk.platform()\n                .get('/account/~/extension/~')\n                .then(response => {\n                    info = response.json()\n                    return info\n                })\n                .catch(e => console.error('Recent Calls Error: ' + e.message))\n        },\n\n        getPhoneNumber: function() {\n            fetchNumbers = sdk.platform()\n                .get('/account/~/extension/~/phone-number')\n                .then(response => {\n                    var data = response.json()\n                    numbers = data.records\n                    fetchNumbers = null\n                    return data.records\n                })\n                .catch(e => console.error('Recent Calls Error: ' + e.message))\n            return fetchNumbers\n        },\n\n        hasServiceFeature: function(name) {\n            if (!info)\n                return Error('Need to fetch account info by accountService.getAccountInfo')\n            return info.serviceFeatures\n                .filter(feature => feature.featureName.toLowerCase() === name.toLowerCase())\n                .length > 0\n        },\n\n        listNumber: function(type, features = []) {\n            if (fetchNumbers) {\n                return fetchNumbers.then(() => {\n                    return getNumbersByFeatures(getNumbersByType(numbers, type), features)\n                        .map(number => number.phoneNumber)\n                })\n            }else {\n                return getNumbersByFeatures(getNumbersByType(numbers, type), features)\n                    .map(number => number.phoneNumber)\n            }\n        },\n    }\n})(sdk)\n\nexport default accountService\n","// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n// This work is free. You can redistribute it and/or modify it\n// under the terms of the WTFPL, Version 2\n// For more information see LICENSE.txt or http://www.wtfpl.net/\n//\n// For more information, the home page:\n// http://pieroxy.net/blog/pages/lz-string/testing.html\n//\n// LZ-based compression algorithm, version 1.4.4\nvar LZString = (function() {\n\n// private property\nvar f = String.fromCharCode;\nvar keyStrBase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nvar keyStrUriSafe = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$\";\nvar baseReverseDic = {};\n\nfunction getBaseValue(alphabet, character) {\n  if (!baseReverseDic[alphabet]) {\n    baseReverseDic[alphabet] = {};\n    for (var i=0 ; i<alphabet.length ; i++) {\n      baseReverseDic[alphabet][alphabet.charAt(i)] = i;\n    }\n  }\n  return baseReverseDic[alphabet][character];\n}\n\nvar LZString = {\n  compressToBase64 : function (input) {\n    if (input == null) return \"\";\n    var res = LZString._compress(input, 6, function(a){return keyStrBase64.charAt(a);});\n    switch (res.length % 4) { // To produce valid Base64\n    default: // When could this happen ?\n    case 0 : return res;\n    case 1 : return res+\"===\";\n    case 2 : return res+\"==\";\n    case 3 : return res+\"=\";\n    }\n  },\n\n  decompressFromBase64 : function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrBase64, input.charAt(index)); });\n  },\n\n  compressToUTF16 : function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 15, function(a){return f(a+32);}) + \" \";\n  },\n\n  decompressFromUTF16: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 16384, function(index) { return compressed.charCodeAt(index) - 32; });\n  },\n\n  //compress into uint8array (UCS-2 big endian format)\n  compressToUint8Array: function (uncompressed) {\n    var compressed = LZString.compress(uncompressed);\n    var buf=new Uint8Array(compressed.length*2); // 2 bytes per character\n\n    for (var i=0, TotalLen=compressed.length; i<TotalLen; i++) {\n      var current_value = compressed.charCodeAt(i);\n      buf[i*2] = current_value >>> 8;\n      buf[i*2+1] = current_value % 256;\n    }\n    return buf;\n  },\n\n  //decompress from uint8array (UCS-2 big endian format)\n  decompressFromUint8Array:function (compressed) {\n    if (compressed===null || compressed===undefined){\n        return LZString.decompress(compressed);\n    } else {\n        var buf=new Array(compressed.length/2); // 2 bytes per character\n        for (var i=0, TotalLen=buf.length; i<TotalLen; i++) {\n          buf[i]=compressed[i*2]*256+compressed[i*2+1];\n        }\n\n        var result = [];\n        buf.forEach(function (c) {\n          result.push(f(c));\n        });\n        return LZString.decompress(result.join(''));\n\n    }\n\n  },\n\n\n  //compress into a string that is already URI encoded\n  compressToEncodedURIComponent: function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 6, function(a){return keyStrUriSafe.charAt(a);});\n  },\n\n  //decompress from an output of compressToEncodedURIComponent\n  decompressFromEncodedURIComponent:function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    input = input.replace(/ /g, \"+\");\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrUriSafe, input.charAt(index)); });\n  },\n\n  compress: function (uncompressed) {\n    return LZString._compress(uncompressed, 16, function(a){return f(a);});\n  },\n  _compress: function (uncompressed, bitsPerChar, getCharFromInt) {\n    if (uncompressed == null) return \"\";\n    var i, value,\n        context_dictionary= {},\n        context_dictionaryToCreate= {},\n        context_c=\"\",\n        context_wc=\"\",\n        context_w=\"\",\n        context_enlargeIn= 2, // Compensate for the first entry which should not count\n        context_dictSize= 3,\n        context_numBits= 2,\n        context_data=[],\n        context_data_val=0,\n        context_data_position=0,\n        ii;\n\n    for (ii = 0; ii < uncompressed.length; ii += 1) {\n      context_c = uncompressed.charAt(ii);\n      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {\n        context_dictionary[context_c] = context_dictSize++;\n        context_dictionaryToCreate[context_c] = true;\n      }\n\n      context_wc = context_w + context_c;\n      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {\n        context_w = context_wc;\n      } else {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n          if (context_w.charCodeAt(0)<256) {\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<8 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1) | value;\n              if (context_data_position ==bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = 0;\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<16 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          }\n          context_enlargeIn--;\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n\n\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        // Add wc to the dictionary.\n        context_dictionary[context_wc] = context_dictSize++;\n        context_w = String(context_c);\n      }\n    }\n\n    // Output the code for w.\n    if (context_w !== \"\") {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n        if (context_w.charCodeAt(0)<256) {\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<8 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        } else {\n          value = 1;\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | value;\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = 0;\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<16 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        delete context_dictionaryToCreate[context_w];\n      } else {\n        value = context_dictionary[context_w];\n        for (i=0 ; i<context_numBits ; i++) {\n          context_data_val = (context_data_val << 1) | (value&1);\n          if (context_data_position == bitsPerChar-1) {\n            context_data_position = 0;\n            context_data.push(getCharFromInt(context_data_val));\n            context_data_val = 0;\n          } else {\n            context_data_position++;\n          }\n          value = value >> 1;\n        }\n\n\n      }\n      context_enlargeIn--;\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits);\n        context_numBits++;\n      }\n    }\n\n    // Mark the end of the stream\n    value = 2;\n    for (i=0 ; i<context_numBits ; i++) {\n      context_data_val = (context_data_val << 1) | (value&1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data_position = 0;\n        context_data.push(getCharFromInt(context_data_val));\n        context_data_val = 0;\n      } else {\n        context_data_position++;\n      }\n      value = value >> 1;\n    }\n\n    // Flush the last char\n    while (true) {\n      context_data_val = (context_data_val << 1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data.push(getCharFromInt(context_data_val));\n        break;\n      }\n      else context_data_position++;\n    }\n    return context_data.join('');\n  },\n\n  decompress: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 32768, function(index) { return compressed.charCodeAt(index); });\n  },\n\n  _decompress: function (length, resetValue, getNextValue) {\n    var dictionary = [],\n        next,\n        enlargeIn = 4,\n        dictSize = 4,\n        numBits = 3,\n        entry = \"\",\n        result = [],\n        i,\n        w,\n        bits, resb, maxpower, power,\n        c,\n        data = {val:getNextValue(0), position:resetValue, index:1};\n\n    for (i = 0; i < 3; i += 1) {\n      dictionary[i] = i;\n    }\n\n    bits = 0;\n    maxpower = Math.pow(2,2);\n    power=1;\n    while (power!=maxpower) {\n      resb = data.val & data.position;\n      data.position >>= 1;\n      if (data.position == 0) {\n        data.position = resetValue;\n        data.val = getNextValue(data.index++);\n      }\n      bits |= (resb>0 ? 1 : 0) * power;\n      power <<= 1;\n    }\n\n    switch (next = bits) {\n      case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 2:\n        return \"\";\n    }\n    dictionary[3] = c;\n    w = c;\n    result.push(c);\n    while (true) {\n      if (data.index > length) {\n        return \"\";\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2,numBits);\n      power=1;\n      while (power!=maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position == 0) {\n          data.position = resetValue;\n          data.val = getNextValue(data.index++);\n        }\n        bits |= (resb>0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (c = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 2:\n          return result.join('');\n      }\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n      if (dictionary[c]) {\n        entry = dictionary[c];\n      } else {\n        if (c === dictSize) {\n          entry = w + w.charAt(0);\n        } else {\n          return null;\n        }\n      }\n      result.push(entry);\n\n      // Add w+entry[0] to the dictionary.\n      dictionary[dictSize++] = w + entry.charAt(0);\n      enlargeIn--;\n\n      w = entry;\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n    }\n  }\n};\n  return LZString;\n})();\n\nif (typeof define === 'function' && define.amd) {\n  define(function () { return LZString; });\n} else if( typeof module !== 'undefined' && module != null ) {\n  module.exports = LZString\n}\n","import sdk from './rc-sdk'\nimport LZString from 'lz-string'\n\nvar rcContactService = function(sdk) {\n    var companyContacts = []\n    var completeCompanyContacts = null\n    \n    var fetchingCompanyContacts = null\n    var fetchingCompleteCompanyContacts = null\n\n    function Contact() {\n        this.firstName = null\n        this.lastName = null\n        this.displayName = null\n        this.extension = null\n        this.email = null\n        this.type = null\n        this.id = null\n        this.phoneNumber = []\n    }\n\n    function createContact(extension) {\n        var contact = new Contact()\n        contact.extension = extension.extensionNumber\n        contact.firstName = extension.contact.firstName\n        contact.lastName = extension.contact.lastName\n        contact.displayName = contact.firstName + ' ' + contact.lastName\n        contact.email = extension.contact.email\n        contact.type = 'rc'\n        contact.id  = extension.id\n        contact.profileImage = extension.profileImage.uri\n        return contact\n    }\n\n    function addToCompanyContact(response) {\n        var records = response.json().records\n           .filter(extension =>\n                extension.status === 'Enabled' &&\n                ['DigitalUser', 'User'].indexOf(extension.type) >= 0)\n           .map(extension => createContact(extension))\n        companyContacts.push.apply(companyContacts, records)\n    }\n\n    function fetchCompanyContactByPage(page) {\n        return sdk.platform().get('/account/~/extension/', {perPage: 250, page: page})\n    }\n\n    function fetchCompanyDirectNumbersByPage(page) {\n        return sdk.platform().get('/account/~/phone-number', {perPage: 250, page: page})\n    }\n\n    function fetchCompanyContacts() {\n        var page = 1\n        fetchingCompanyContacts = fetchCompanyContactByPage(page)\n            .then(function(response) {\n                var respObj = response.json()\n                if (respObj.paging && respObj.paging.totalPages > page) {\n                    var promises = []\n                    while (respObj.paging.totalPages > page) {\n                        page++\n                        promises.push(fetchCompanyContactByPage(page))\n                    }\n\n                    return Promise.all(promises).then(responses=> {\n                        responses.forEach(function(response) {\n                            addToCompanyContact(response)\n                        })\n                        fetchingCompanyContacts = null\n                        return companyContacts\n                    })\n                }else {\n                    addToCompanyContact(response)\n                    return companyContacts\n                }\n            }).catch(function(e) {\n                console.error(e)\n            })\n        return fetchingCompanyContacts\n    }\n\n    function fetchCompanyDirectNumbers() {\n        var page = 1\n        return fetchCompanyDirectNumbersByPage(page)\n        .then(response => {\n            var respObj = response.json()\n            if (respObj.paging && respObj.paging.totalPages > page) {\n                var promises = []\n                while (respObj.paging.totalPages > page) {\n                    page++\n                    promises.push(fetchCompanyDirectNumbersByPage(page))\n                }\n\n                return Promise.all(promises).then(responses => {\n                    var numbers = {}\n                    responses.forEach(response => {\n                        var resp = response.json()\n                        resp.records.forEach(el => {\n                            if (el.extension && el.extension.extensionNumber) {\n                                if (!numbers[el.extension.extensionNumber]) {\n                                    numbers[el.extension.extensionNumber] = []\n                                }\n\n                                numbers[el.extension.extensionNumber].push(el)\n                            }\n                        })\n                    })\n                    companyContacts.forEach(contact => {\n                        var phones = numbers[contact.extension]\n                        if (phones) {\n                            phones.forEach(phone => {\n                                contact.phoneNumber.push(phone.phoneNumber)\n                            })\n                        }\n                    })\n                })\n            }\n        })\n    }\n\n    return {\n        get companyContacts() {\n            return companyContacts\n        },\n        asyncGetCompanyContact: function() {\n            if (fetchingCompanyContacts) {\n                return fetchingCompanyContacts\n            }else {\n                return Promise.resolve(companyContacts)\n            }\n        },\n        syncCompanyContact: function() {\n            companyContacts.length = 0\n            fetchCompanyContacts()\n            fetchCompanyDirectNumbers()\n        },\n        completeCompanyContact: function() {\n            if (completeCompanyContacts) \n                return Promise.resolve(completeCompanyContacts)\n            if (fetchingCompleteCompanyContacts)\n                return fetchingCompleteCompanyContacts\n            fetchingCompleteCompanyContacts = fetchCompanyContacts().then(fetchCompanyDirectNumbers)\n            return fetchingCompleteCompanyContacts.then(() => {\n                completeCompanyContacts = companyContacts\n                fetchingCompleteCompanyContacts = null\n                return companyContacts\n            })\n        },\n        cacheContacts: (function() {\n            var contact = null\n            var data = localStorage.getItem('rc-contacts')\n            var fetch\n            // FIXME: temp disable it\n           \n            return function() {\n                var fetch\n                // var fetch = new Promise((resolve, reject) => {\n                // // Hack for delay the refreshing request\n                //   setTimeout(() => {\n                //     rcContactService.completeCompanyContact()\n                //     .then(data => {\n                //         if (data)\n                //             localStorage.setItem('rc-contacts', LZString.compressToUTF16(JSON.stringify(data)))\n                //         return resolve(data)\n                //     })\n                //   }, 100)\n                // })\n                if (contact) {\n                    contact.then(value => {\n                        completeCompanyContacts = companyContacts = value\n                    })\n                    return contact\n                }\n                data && (completeCompanyContacts = companyContacts = JSON.parse(LZString.decompressFromUTF16(data)))\n                contact = data? Promise.resolve(JSON.parse(LZString.decompressFromUTF16(data))): fetch\n                return contact\n            }\n        }())\n    }\n}(sdk)\n\nexport default rcContactService\n","var contactSearchService = (function() {\n    var searchProviders = []\n    var queryCompletedHandlers = []\n\n    function createResult(item) {\n        return {\n            name: item.name,\n            value: item.value,\n            type: item.type,\n            id: item.id\n        }\n    }\n    return {\n        query: function(searchFunctions, filter) {\n            return Promise.all(searchFunctions).then(results => {\n                var searchResultsKeys = {}\n                var searchResults = []\n                results.forEach(result => {\n                    result.forEach(item => {\n                        if (filter) {\n                            if (filter(item)) {\n                                var key = item.name + item.value\n                                if (!searchResultsKeys[key]) {\n                                    var toAddItem = createResult(item)\n                                    searchResultsKeys[key] = toAddItem\n                                    searchResults.push(toAddItem)\n                                }\n                            }\n                        } else {\n                            var key = item.name + item.value\n                            if (!searchResultsKeys[key]) {\n                                var toAddItem = createResult(item)\n                                searchResultsKeys[key] = toAddItem\n                                searchResults.push(toAddItem)\n                            }\n                        }\n                    })\n                })\n                return searchResults\n            })\n        },\n    }\n})()\nexport default contactSearchService\n","import rcContactService from './rc-contact-service'\nvar rcContactSearchProvider = function() {\n    return {\n        search: function(text) {\n            var results = []\n            if (text) {\n                text = text.toLowerCase()\n                rcContactService.companyContacts.map(contact => {\n                    if (contact.displayName && contact.displayName.toLowerCase().indexOf(text) >= 0) {\n                        results.push({\n                            name: contact.displayName,\n                            value: contact.extension,\n                            type: 'rc',\n                            id: contact.id,\n                        })\n                        contact.phoneNumber.forEach(phone => {\n                            results.push({\n                                name: contact.displayName,\n                                value: phone,\n                                type: 'rc',\n                                id: contact.id,\n                            })\n                        })\n                    } else {\n                        if (contact.extension && contact.extension.indexOf(text) >= 0) {\n                            results.push({\n                                name: contact.displayName,\n                                value: contact.extension,\n                                type: 'rc',\n                                id: contact.id,\n                            })\n                        }\n\n                        contact.phoneNumber.forEach(phone => {\n                            if (phone.indexOf(text) >= 0) {\n                                results.push({\n                                    name: contact.displayName,\n                                    value: phone,\n                                    type: 'rc',\n                                    id: contact.id,\n                                })\n                            }\n                        })\n                    }\n                })\n            }\n\n            return results\n        },\n        searchAll: function() {\n            return rcContactService.completeCompanyContact().then(companyContacts => {\n                return companyContacts.map(contact => {\n                    return {\n                        name: contact.displayName,\n                        type: 'rc',\n                        id: contact.id,\n                    }\n                });\n            }).catch(e => console.error(e))\n        }\n    }\n}()\n\nexport default rcContactSearchProvider\n","import sdk from './rc-sdk'\nimport rcSubscription from './rc-subscription-service'\n\nvar rcMessageService = function(sdk) {\n    var messages = {}\n    var fetchingPromise = null\n    var syncToken = null\n    var messageUpdateHandlers = []\n\n    function fullSyncMessages(hour) {\n        return sdk.platform().get('/account/~/extension/~/message-sync', {\n            dateFrom: new Date(Date.now() - hour * 3600 * 1000).toISOString(),\n            syncType: 'FSync'\n        }).then(responses => {\n            var jsonResponse = responses.json()\n            syncToken = jsonResponse.syncInfo.syncToken\n            var results = jsonResponse.records\n            addMessageToList(results)\n            fetchingPromise = null\n            return results\n        })\n    }\n\n    function incrementalSyncMessages() {\n        if (syncToken) {\n            return sdk.platform().get('/account/~/extension/~/message-sync', {\n                syncType: 'ISync',\n                syncToken: syncToken\n            }).then(responses => {\n                var jsonResponse = responses.json()\n                var results = jsonResponse.records\n                syncToken = jsonResponse.syncInfo.syncToken\n                updateMessageList(results)\n                messageUpdateHandlers.forEach(h => h(results))\n            })\n        }\n    }\n\n    function concatMessages() {\n        var results = []\n        for (var key in messages) {\n            if (messages.hasOwnProperty(key)) {\n                results = results.concat(messages[key])\n            }\n        }\n        return results\n    }\n\n    function addMessageToList(results) {\n        results.forEach(message => {\n            if (!messages[message.type]) {\n                messages[message.type] = []\n            }\n            messages[message.type].push(message)\n        })\n    }\n\n    function updateMessageList(results) {\n        results.forEach(message => {\n            var messageList = messages[message.type]\n            if (!messageList) {\n                if (message.availability === 'Alive') {\n                    messages[message.type] = []\n                    messages[message.type].splice(0, 0, message)\n                }\n            }else {\n                var index = 0\n                for (; index < messageList.length; index++) {\n                    if (messageList[index].id === message.id) {\n                        if (message.availability === 'Alive') {\n                            messageList[index] = message\n                        } else {\n                            messageList.splice(index, 1)\n                        }\n                        break\n                    }\n                }\n                if (index === messageList.length) {\n                    if (message.availability === 'Alive') {\n                        messageList.splice(0, 0, message)\n                    }\n                }\n            }\n        })\n    }\n\n    return {\n        syncMessages: function(hour) {\n            fetchingPromise = fullSyncMessages(hour)\n            return fetchingPromise\n        },\n        getMessagesByType: function(type) {\n            if (!fetchingPromise) {\n                if (messages[type]) {\n                    return messages[type]\n                } else {\n                    return []\n                }\n            } else {\n                return fetchingPromise.then(() => {\n                    return messages[type]\n                })\n            }\n        },\n        getAllMessages: function() {\n            return !fetchingPromise ? concatMessages() : fetchingPromise.then(concatMessages)\n        },\n        subscribeToMessageUpdate: function() {\n            rcSubscription.subscribe(\n                'message-store',\n                '/restapi/v1.0/account/~/extension/~/message-store',\n                incrementalSyncMessages\n            )\n        },\n        onMessageUpdated: function(handler) {\n            if (handler) {\n                messageUpdateHandlers.push(handler)\n            }\n        },\n        sendSMSMessage: function(text, fromNumber, toNumber) {\n            return sdk.platform()\n                .post('/account/~/extension/~/sms/', {\n                    from: {phoneNumber: fromNumber},\n                    to: [\n                        {phoneNumber: toNumber}\n                    ],\n                    text: text\n                })\n                .then(response => response.json())\n        },\n        sendPagerMessage: function(text, fromNumber, toNumber) {\n            console.log(fromNumber);\n            return sdk.platform()\n                .post('/account/~/extension/~/company-pager/', {\n                    from: {extensionNumber: fromNumber},\n                    to: [\n                        {extensionNumber: toNumber}\n                    ],\n                    text: text\n                })\n                .then(response => response.json())\n        },\n        getConversation: function(conversationId, hourFrom, hourTo) {\n            return sdk.platform()\n                .get('/account/~/extension/~/message-store', {\n                    dateFrom: new Date(Date.now() - hourFrom * 3600 * 1000).toISOString(),\n                    dateTo: new Date(Date.now() - (hourTo || 0) * 3600 * 1000).toISOString(),\n                    conversationId\n                })\n                .then(response => response.json())\n                .then(data => data.records)\n                .then(records => records.reverse())\n        },\n        getMessagesByNumber: function(phoneNumber, hourFrom, hourTo) {\n            return sdk.platform()\n                .get('/account/~/extension/~/message-store', {\n                    dateFrom: new Date(Date.now() - hourFrom * 3600 * 1000).toISOString(),\n                    dateTo: new Date(Date.now() - (hourTo || 0) * 3600 * 1000).toISOString(),\n                    phoneNumber\n                })\n                .then(response => response.json())\n                .then(data => data.records)\n                .then(records => records.reverse())\n        }\n    }\n}(sdk)\n\nexport default rcMessageService\n","import rcMessageService from './rc-message-service'\nvar rcMessageProvider = function() {\n    var messageUpdatedHandlers = []\n    var conversations = {}\n    var cachedHour = 0\n\n    rcMessageService.onMessageUpdated(results => {\n        messageUpdatedHandlers.forEach(h => {\n            try {\n                h(results.slice())\n            } catch (e) {\n                console.error(e)\n            }\n        })\n    })\n\n    function createResult(message) {\n        return {\n            id: message.id,\n            time: message.lastModifiedTime,\n            readStatus: message.readStatus,\n            type: getType(message),\n            contact: getNumber(message.type, getDirection(message, 'Outbound')),\n            subject: message.subject || null,\n            convId: message.conversation? message.conversation.id: null,\n            author: getNumber(message, getDirection(message, 'Inbound'))\n        }\n\n        function getDirection(message, dir) {\n            return message.direction === dir ? message.to[0] : message.from\n        }\n\n        function getNumber(message, info) {\n            return message.type === 'Pager' ? info.extensionNumber : info.phoneNumber\n        }\n\n        function getType(message) {\n            return (message.type === 'Fax' || message.type === 'VoiceMail') ? 'Text' : message.type\n        }\n    }\n\n    return {\n        getTextMessages: function() {\n            return Promise.resolve(rcMessageService.getMessagesByType('SMS')).then(messages => {\n                var results = []\n                messages.forEach(message => {\n                    results.push(createResult(message))\n                })\n                return results\n            })\n        },\n\n        getLastMessagesOfAllType: function() {\n            var results = []\n            return this.getMessagesOfAllType()\n                        .then(msgs => {\n                            for (var key in msgs) {\n                                if (msgs.hasOwnProperty(key)) {\n                                    if (key === 'anonymous')\n                                        results = results.concat(msgs.anonymous[0])\n                                    else\n                                        results.push(msgs[key][0])\n                                }\n                            }\n                            return results\n                        })\n        },\n        // Return all messages of type 'VoiceMail' and 'Fax'. For SMS and Pager, only last message in a conversation\n        // will be returned.\n        getMessagesOfAllType: function() {\n            return Promise.resolve(rcMessageService.getAllMessages()).then(messages => {\n                var results = []\n                var target = {}\n                messages.forEach(message => {\n                    var result = createResult(message)\n                    //Combine SMS/Pager messages in conversation\n                    if (message.conversation && message.conversation.id) {\n                        target[message.conversation.id] = target[message.conversation.id] || []\n                        target[message.conversation.id].push(result)\n                        conversations[message.conversation.id] = conversations[message.conversation.id] || []\n                        conversations[message.conversation.id].push(message)\n                    } else {\n                        target['anonymous'] = target['anonymous'] || []\n                        target['anonymous'].push(result)\n                    }\n                })\n                return target\n            })\n        },\n\n        getConversation: function(convId, hourFrom) {\n            if (conversations[convId] && (!hourFrom || hourFrom < cachedHour)) {\n                return Promise.resolve(conversations[convId].reverse())\n            }\n            else {\n                return rcMessageService.getConversation(\n                    convId,\n                    hourFrom,\n                    cachedHour)\n                .then(result => {\n                    cachedHour = hourFrom\n                    return result\n                })\n            }\n        },\n\n        onMessageUpdated: function(handler) {\n            messageUpdatedHandlers.push(handler)\n        }\n    }\n}()\nexport default rcMessageProvider\n\n","import sdk from './rc-sdk';\n\nvar rcConferenceSerivce = function() {\n    var fetchingConferenceInfo = null;\n    \n    function fetchConferenceInfo() {\n        fetchingConferenceInfo = sdk.platform().get('/account/~/extension/~/conferencing')\n            .then(responses => {\n                var jsonResponse = responses.json();\n                var conferenceInfo = {};\n                conferenceInfo.hostCode = jsonResponse.hostCode;\n                conferenceInfo.phoneNumber = jsonResponse.phoneNumber;\n                conferenceInfo.participantCode = jsonResponse.participantCode;\n                fetchingConferenceInfo = null;\n                return conferenceInfo;\n            });\n        return fetchingConferenceInfo;\n    }\n    \n    return {\n        getConferenceInfo: function() {\n            if(fetchingConferenceInfo){\n                return fetchingConferenceInfo;\n            }else{\n                return fetchConferenceInfo();\n            }\n        }\n    };\n}();\n\nexport default rcConferenceSerivce;\n","import sdk from './rc-sdk'\nimport callLogService from './call-log-service'\nimport rcMessageService from './rc-message-service'\nvar conversationService = (function(sdk) {\n    var cachedHour = 24 * 7\n    function groupMessageToContact(msgs, contacts) {\n        var relatedContacts = contacts.filter(contact => {\n            var knownContactsIndex = []\n            var contactNums = contact.phoneNumber.concat(contact.extension)\n            var contactMsgs = msgs.filter((msg, index) => {\n                var msgNumber = msg.direction === 'Inbound' ? msg.from : msg.to\n                var contain = contactNums.indexOf(msgNumber) > -1\n                contact.msg = contact.msg || []\n                var alreadyExist = contact.msg.find(contactMsg => contactMsg.id == msg.id)\n                if (contain && !alreadyExist) {\n                    \n                    contact.msg.push(msg)\n                    knownContactsIndex.push(index)\n                }\n                return contain\n            })\n            knownContactsIndex.reverse().forEach(index => msgs.splice(index, 1))\n            return contactMsgs.length > 0\n        })\n        msgs.forEach(msg => {\n            var msgNumber = msg.direction === 'Inbound' ? msg.from : msg.to\n            var contact = relatedContacts.filter(contact => contact.id === msgNumber)[0]\n            if (contact) {\n                contact.msg.push(msg)\n            } else {\n                relatedContacts.push(fakeContact(msg))\n            }\n        })\n        return relatedContacts\n    }\n\n    function groupContactToMessage(msgs, contacts) {\n        return msgs.map(msg => {\n            var unknownContact = true\n            contacts.forEach(contact => {\n                var contactNums = contact.phoneNumber.concat(contact.extension)\n                var msgNumber = msg.direction === 'Inbound' ? msg.from : msg.to\n                var contain = contactNums.indexOf(msgNumber) > -1\n                if (contain) {\n                    msg.contact = contact\n                    unknownContact = false\n                }\n            })\n            // if (unknownContact) {\n            //     console.log(msg);\n            //     var fake = fakeContact(msg)\n            //     msg.contact = fake\n            //     contacts.push(fake)\n            // }\n            return msg\n        })\n    }\n\n    function combineAdjacentMessage(contents) {\n        // group related SMS message\n        var savedContent\n        var result = []\n        for (let i = contents.length - 1; i > 0; --i) {\n            let content = contents[i]\n            // if (content.type !== 'SMS') {\n            //     if (savedContent) {\n            //         result.push(savedContent)\n            //         savedContent = null\n            //     }\n            //     result.push(content)\n            //     continue\n            // }\n            if (savedContent &&\n                savedContent.type === content.type &&\n                savedContent.contact.id === content.contact.id) {\n                savedContent.others.push(content)\n            } else {\n                savedContent && result.push(savedContent)\n                content.others = []\n                savedContent = content\n            }\n        }\n        savedContent && result.push(savedContent)\n        return result\n    }\n\n    function combine(...targets) {\n        return targets.reduce((result, target) => result.concat(target), [])\n    }\n\n    function sortTime(target) {\n        return target.slice().sort((a, b) =>\n            Date.parse(a.time) -\n            Date.parse(b.time)\n        )\n    }\n    function containSameVal(array1, array2) {\n        return array1.filter(function(n) {\n            return array2.indexOf(n) != -1\n        }).length > 0\n    }\n    function uniqueArray(target) {\n        var seen = {}\n        return target.filter(function(item) {\n            return seen.hasOwnProperty(item) ? false : (seen[item] = true)\n        })\n    }\n\n    function fakeContact(msg) {\n        var phoneNumber = msg.direction === 'Inbound' ? msg.from : msg.to\n        return {\n            displayName: phoneNumber,\n            id: phoneNumber,\n            phoneNumber: [phoneNumber],\n            extension: null,\n            msg: [msg]\n        }\n    }\n\n    function adaptMessage(msg) {\n        return {\n            id:                 msg.id,\n            from:               msg.from.extensionNumber ||\n                                msg.from.phoneNumber,\n            to:                 msg.to.phoneNumber ||\n                                msg.to.extensionNumber ||\n                                msg.to[0].extensionNumber ||\n                                msg.to[0].phoneNumber,\n            direction:          msg.direction,\n            type:               msg.type,\n            time:               msg.creationTime ||\n                                msg.startTime,\n            lastModifiedTime:   msg.lastModifiedTime ||\n                                msg.startTime,\n            subject:            msg.recording ||\n                                msg.subject ||\n                                msg.action ||\n                                msg.attachments[0],\n            status: {\n                sendConfirmed: false,\n                receiveConfirmed: false\n            }\n        }\n    }\n    function getMessagesByNumber(contact, offset) {\n        return Promise.all(contact.phoneNumber.map(\n                    number => rcMessageService.getMessagesByNumber(\n                        // FIXME\n                        number,\n                        cachedHour + offset,\n                        cachedHour\n                    )\n                )\n        )\n        .then(result => combine(...result))\n    }\n    function getCallLogsByNumber(contact, offset) {\n        return Promise.all(contact.phoneNumber.map(\n                    number => callLogService.getCallLogsByNumber(\n                        number,\n                        cachedHour + offset,\n                        cachedHour\n                    )\n                )\n        )\n        .then(result => combine(...result))\n    }\n    function uniqId(target) {\n        var seen = {}\n        return target.filter(function(item) {\n            return seen.hasOwnProperty(item.id) ? false : (seen[item.id] = true)\n        })\n    }\n    function combineContent(...sources) {\n        return sortTime(combine(...sources.map(source => source.map(adaptMessage))))\n    }\n    return {\n        get cachedHour() {\n            return cachedHour\n        },\n        syncContent: function(contacts, ...sources) {\n            var contents = combineContent(...sources)\n            var relatedContacts = groupMessageToContact(contents.slice(), contacts)\n            contents = groupContactToMessage(contents, relatedContacts)\n            return contents\n        },\n        organizeContent: function(contacts, ...sources) {\n            var contents = combineContent(...sources)\n            var relatedContacts = groupMessageToContact(contents.slice(), contacts)\n            contents = groupContactToMessage(contents, relatedContacts)\n            contents = combineAdjacentMessage(contents)\n            return contents\n        },\n        getConversations: function(contacts, ...sources) {\n            var contents = combineContent(...sources)\n            var relatedContacts = groupMessageToContact(contents, contacts)\n                                .map(contact => {\n                                    contact.syncHour = cachedHour\n                                    return contact\n                                })\n                                .map(contact => {\n                                    contact.phoneNumber =\n                                    uniqueArray(contact.phoneNumber.concat(contact.extension))\n                                    return contact\n                                })\n                                .reduce((map, contact) => {\n                                    map[contact.id] = contact\n                                    return map\n                                }, {})\n            return relatedContacts\n        },\n        loadContent: function(contact, offset) {\n            return Promise.all([\n                        getCallLogsByNumber(contact, offset),\n                        getMessagesByNumber(contact, offset)\n                    ])\n                    .then(result => combineContent(...result))\n                    .then(contents => {\n                        contact.msg = contents.concat(contact.msg)\n                        cachedHour += offset\n                        return contents\n                    })\n        },\n        onConversationUpdate: function(handler) {\n            rcMessageService.onMessageUpdated(msgs => {\n                try {\n                    var msgs = sortTime(msgs.map(adaptMessage))\n                    handler(msgs)\n                } catch (e) {\n                    console.error(e)\n                    throw e\n                }\n            })\n        },\n        adaptMessage\n    }\n})(sdk)\n\nexport default conversationService\n","import phoneService from '../services/phone-service'\nimport loginService from '../services/login-service'\nimport callLogService from '../services/call-log-service'\nimport accountService from '../services/account-service'\nimport rcContactService from '../services/rc-contact-service'\nimport contactSearchService from '../services/contact-search-service'\nimport rcContactSearchProvider from '../services/rc-contact-search-provider'\nimport rcMessageService from '../services/rc-message-service'\nimport rcMessageProvider from '../services/rc-message-provider'\nimport rcConferenceSerivce from '../services/rc-conference-service'\nimport conversationService from '../services/rc-conversation-service'\nvar dialPadSearchProviders = [rcContactSearchProvider]\n\nvar services = {}\nservices.rcPhone = {\n    loadData: {\n        method: function() {\n            rcMessageService.subscribeToMessageUpdate();\n            rcMessageService.syncMessages(this.props.cachedMessageHours);\n            accountService.getAccountInfo();\n            accountService.getPhoneNumber();\n            rcContactService.syncCompanyContact();\n            phoneService.registerSIP();\n            callLogService.getCallLogs();\n            phoneService.listen();\n        }\n    }\n}\nservices['auth-panel'] = {\n    login: {\n        method: function() {\n            console.log('login');\n            return loginService.login(\n                PhoneFormat.formatE164('US', this.props.username),\n                this.props.extension,\n                this.props.password\n            )\n        }\n    }\n}\nservices['dial-pad'] = {\n    mount: {\n        after: function() {\n            if (!accountService.hasServiceFeature(\"VoipCalling\"))\n                this.disable();\n        }\n    },\n    callout: {\n        method: function() {\n            return phoneService.callout(this.props.fromNumber, this.props.toNumber);\n        }\n    },\n    queryContacts: {\n        method: function() {\n            var dialPadSearchFunctions = dialPadSearchProviders.map(provider => {\n                return provider.search(this.props.toNumber);\n            });\n            return contactSearchService.query(dialPadSearchFunctions);\n        }\n    },\n    getOutboundCallerID: {\n        method: function() {\n            console.log('get outbound');\n            return accountService.getPhoneNumber().then(() => {\n                return accountService.listNumber(\"VoiceFax\", 'CallerId')\n            })\n        }\n    }\n}\n\nservices['conference'] = {\n    getConferenceInfo: {\n        method: function() {\n            return rcConferenceSerivce.getConferenceInfo();\n        }\n    }\n}\nservices['call-log'] = {\n    init: {\n        method: function() {\n            return callLogService.getCallLogs();\n        }\n    }\n}\n\nservices['time-line'] = {\n    mount: {\n        after: function() {\n            rcMessageService.subscribeToMessageUpdate()\n            rcMessageProvider.onMessageUpdated(msg => {\n                this.updateTimeline(conversationService.syncContent(this.props.contacts, msg))\n                if (this.props.currentConv) {\n                    this.props.currentConv.confirmMessages()\n                    this.props.currentConv.addIncomingMessages()\n                }\n            })\n            return rcContactService.cacheContacts().then(contacts => this.props.contacts = contacts)\n        }\n    },\n    fetchData: {\n        method: function() {\n            return Promise.all([\n                rcContactService.cacheContacts(), // first one must be the contacts\n                rcMessageService.syncMessages(conversationService.cachedHour),\n                callLogService.getCallLogs(),\n            ]).then(result => conversationService.organizeContent(...result))\n        }\n    }\n}\n\nservices['contacts'] = {\n    mount: {\n        after: function() {\n            this.fetchContacts()\n        }\n    },\n    fetchRelatedContact: {\n        method: function() {\n            return Promise.all([\n                rcMessageService.syncMessages(conversationService.cachedHour),\n                callLogService.getCallLogs(),\n                rcContactService.cacheContacts()\n            ]).then(result => {\n                var [msgs, logs, contacts] = result\n                this.props.contacts = contacts.reduce((result, contact) => {\n                    result[contact.id] = contact\n                    return result\n                }, {})\n                return conversationService.getConversations(contacts, msgs, logs)\n            }).then(relateContacts => {\n                this.props.relateContacts = relateContacts\n                return relateContacts\n            }).then(relateContacts => \n                Object.keys(relateContacts).map(index => {\n                    // adapt to messages template format\n                    relateContacts[index].msg[0].contact = relateContacts[index].displayName\n                    // for conversation-advance temaplate\n                    relateContacts[index].msg[0].contactId = index\n                    return relateContacts[index].msg[0]\n                })\n            )\n        }\n    },\n    fetchContacts: {\n        method: function() {\n            // var dialPadSearchFunctions = dialPadSearchProviders.map(provider => {\n            //     return provider.searchAll();\n            // });\n            // return contactSearchService.query(dialPadSearchFunctions);\n            return rcContactService.cacheContacts().then(contacts => {\n                this.props.contacts = contacts.reduce((result, contact) => {\n                    result[contact.id] = contact\n                    return result\n                }, {})\n                return contacts.map(contact => {\n                    return {\n                        name: contact.displayName,\n                        type: 'rc',\n                        id: contact.id,\n                    }\n                });\n            }).catch(e => console.error(e))\n        }\n    },\n    selectContact: {\n        method: function() {\n            var contact = \n                (this.props.relateContacts && \n                this.props.relateContacts[this.props.selectedContact.id]) ||\n                this.props.contacts[this.props.selectedContact.id]\n            var conversation = phone.props.timeline.props.currentConv = conv(contact, () => {\n                phone.props.timeline.mount('#contact-detail')\n            })\n        }\n    }\n}\n\nservices['conversation-advanced'] = {\n    init: {\n        after: function() {\n            this.props.hourOffset = 3 * 24\n            \n        }\n    },\n    mount: {\n        after: function() {\n            return accountService.getAccountInfo()\n                    .then(info => this.props.fromExtension = info.extensionNumber)\n                    .then(this.getOutboundCallerID)\n        }\n    },\n    send: {\n        method: function() {\n            if (this.props.toNumber === this.props.toExtension) {\n                return rcMessageService.sendPagerMessage(\n                    this.props.message,\n                    this.props.fromExtension,\n                    this.props.toExtension\n                );\n            }\n            else {\n                return rcMessageService.sendSMSMessage(\n                    this.props.message,\n                    this.props.fromNumber,\n                    this.props.toNumber\n                );\n            }\n        }\n    },\n    queryContacts: {\n        method: function() {\n            var dialPadSearchFunctions = dialPadSearchProviders.map(provider => {\n                return provider.search(this.props.to);\n            });\n            return contactSearchService.query(dialPadSearchFunctions);\n        }\n    },\n    getOutboundCallerID: {\n        method: function() {\n            return accountService.getPhoneNumber().then(() => \n                accountService.listNumber(\"VoiceFax\", 'SmsSender'));\n        }\n    },\n    reachTop: {\n        method: function() {\n            return conversationService.loadContent(this.props.contact, this.props.hourOffset)\n        }\n    },\n}\nexport default services\n","// TODO: use dependency injection\nimport services from './rc-services'\n\nfunction extend(base, mixin) {\n    for (var action in mixin) {\n        if (base[action]) {\n            for (var hook in mixin[action]) {\n                var origin = base[action][hook]\n                base[action][hook] = function(...args) {\n                    console.log(this);\n                    var result\n                    if (origin) {\n                        result = origin.call(this, ...args)\n                    }\n                    mixin[action][hook].call(this)\n                    return result\n                }\n            }\n        } else {\n            base[action] = mixin[action]\n        }\n    }\n    return base\n}\n\nvar Factory = function () {\n    \n}\n\nFactory.prototype.create = function(type, mixin = {}) {\n    return extend(services[type], mixin)\n}\n\nexport default Factory\n"],"sourceRoot":"/source/"}